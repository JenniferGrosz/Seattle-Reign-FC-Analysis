---
title: 'Technical Appendix'
subtitle: 'Seattle Reign FC Analysis'
author: "Jennifer Grosz"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    toc: true
    toc_depth: 6
    toc_float: true
    number_sections: true
---


```{r echo = FALSE}
# Course: 5210 Data Visualization
# Purpose: Data Translation Project
# Date: August 28, 2021
# Author: Jennifer Grosz
```

```{r echo = FALSE, warning = FALSE, message = FALSE}
# Clear environment of variables and functions
rm(list = ls(all = TRUE)) 

# Clear environment of packages
if(is.null(sessionInfo()$otherPkgs) == FALSE)lapply(paste("package:", names(sessionInfo()$otherPkgs), sep=""), detach, character.only = TRUE, unload = TRUE)
```

```{r setup, include=FALSE} 
# set environment to not show warnings or messages
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

# Purposes of this analysis:

  - Determine the primary factors that impact attendance intentions, media consumption intentions, and merchandise consumption intention.

  - Determine the factors that impact satisfaction (Performance, Outcome, Matchday Satisfaction).
  
  - Determine ways to increase brand attitude.
  
  - Investigate purchasing habits of corporate partner products.
  
  - Investigate ways to improve Matchday experience.
  
  - Identify viable market segments.
  
# Load Packages

```{r warning = FALSE, message = FALSE}
# Load packages
library(tidyverse) # contains ggplot2, dplyr, and several other packages used
library(vtable) # contains vtable function for summary table of data
library(janitor) # contains tidyverse functions for cross-tables
library(gridExtra) # contains grid.arrange function used to combine plots in the same window
library(patchwork) # use to put graphs together in the same frame
library(knitr) # contains some table formatting functions
library(kableExtra) # also contains functions used for table outputs
library(GGally) # contains a custom correlation plot 
library(moments) # to calculate skewness
library(scales) # use for rounding numbers
library(corrplot) # for correlation plot
library(tidylog) # provides comments
options(scipen = 999) # remove scientific notation
library(corrplot) #correlation matrix
library(SmartEDA) # used for creating interaction tables among categorical variables
library(inspectdf) # plots correlations
library(arsenal) # used for interaction tables
library(autoEDA) # package for making interaction bar plots
library(DataExplorer)
library(htmlTable)
library(pastecs)
library(htmlTable)
```

+ Load theme for plotting data

```{r}
# create customized theme function starting with theme_classic()
clean_theme <- theme_classic() +
  theme(legend.direction = "horizontal", # create horizontal legend
        legend.position = "bottom", # put legend at bottom of graph
        legend.justification='left', # align legend to the left
        legend.title = element_blank(), # remove legend title
        axis.line.y = element_blank(), # remove y-axis line
        axis.ticks.y = element_blank(), # remove y-axis ticks
        axis.ticks.x = element_blank(), # remove x-axis ticks
        plot.title = element_text(face = "bold", size = 15)) # make graph title bold and a larger font
```

+ Load function to check for duplicates in the data

```{r}
# Function to check for duplicates 
check_dupes <- function(data, vars) {
  data %>% 
    select(vars) %>%
    duplicated() %>%
    max()
}
```

# Load Seattle Reign FC data

```{r}
# Load data
sea_reign_data <- read.csv("../data/Seattle_Reign.csv")

#look at data
#vtable(sea_reign_data)

# create a copy of the data
ref_set <- sea_reign_data

# check for duplicate ResponseID's in data set
check_dupes(sea_reign_data, 'ResponseId') # 0 = no duplicates
```

# Tidy Data

## Attendance variables 

```{r}
# select variables related to attendance
Attendance_data <- sea_reign_data %>%
  select(ResponseId, Interest, Attend1, Attend2, gamelast, lasttype, Gamewit1, Gamewit2, 
         Gamewit3, Gamewit4, Travel5, Travel6, Gamepln1, Gampln2a, Gampln2b, Gampln2c, 
         Gampln2d, Gampln2e, Gampln2f, Media1, Media3, Media4, Media5, Media6, Media12,
         Media7a, Media7b, Promo1, Promo3, Promo4, Promo5, Promo6, WOM1, WOM2, WOM3, 
         Travel1, Travel2, Travel3, Attend17, Attend3, Seat1) %>%
  mutate(ResponseId = factor(ResponseId)) %>%
# changing values for Interest
  mutate(across(Interest, ~ str_replace(.,"I live and die with this team", "die-hard fan"))) %>%
  mutate(across(Interest, ~ str_replace(.,"I consider myself to be a loyal fan of this team", "loyal fan"))) %>%
  mutate(across(Interest, ~ str_replace(.,"I consider myself to be a moderate fan of this team", "moderate fan"))) %>%
  mutate(across(Interest, ~ str_replace(.,"I consider myself to be a low-level fan of this team", "low level fan"))) %>%
  mutate(across(Interest, ~ str_replace(., "I have a small amount of interest", "hardly interested"))) %>%
  # replace variables with clearer names
  mutate(ever_attend_match = case_when(
    # change to binary scale
    Attend1 == "Yes" ~ 1,
    Attend1 == "No" ~ 0),
    first_attend_match = Attend2,
    num_matches_attend_2016 = gamelast,
    ticket_type_used_2016 = lasttype,
    att_game_with_family = Gamewit1,
    att_game_with_friends = Gamewit2,
    att_game_with_assoc = Gamewit3,
    att_game_with_self = Gamewit4,
    distance_traveled = Travel5,
    transportation_method = Travel6,
    intended_num_matches_attend_2017 = Gamepln1,
    intend_season_ticket = Gampln2a,
    intend_5_match_pack = Gampln2b,
    intend_3_match_pack = Gampln2c,
    intend_single_match = Gampln2d,
    intend_pitchside_table = Gampln2e,
    intend_undecided_ticket = Gampln2f,
    # create single variable for intended ticket type 
    intended_ticket_type_2017 = case_when(
           Gampln2a == 1 ~ "Season Ticket",
           Gampln2b == 1 ~ "5 Match Pack",
           Gampln2c == 1 ~ "3 Match Pack",
           Gampln2d == 1 ~ "Single Match",
           Gampln2e == 1 ~ "Pitchside Table",
           Gampln2f == 1 ~ "Undecided")) %>%
   # change values for word of mouth influence variables
    mutate(across(c("WOM1", "WOM2", "WOM3", 
                    # change values for media influence variables
                  "Media1", "Media3", "Media4", "Media5", "Media6", "Media12", "Media7a", "Media7b", 
                  # change values for promotion influence variables
                  "Promo1", "Promo3", "Promo4", "Promo5", "Promo6",
                  # change values for travel influence variables
                 "Travel1", "Travel2", "Travel3"),  ~ str_replace(., "Has a positive influence on my attendance 3", "3"))) %>%
  mutate(across(c("WOM1", "WOM2", "WOM3", 
                 # change values for media influence variables
                 "Media1", "Media3", "Media4", "Media5", "Media6", "Media12", "Media7a", "Media7b",
                 # change values for promotion influence variables
                 "Promo1", "Promo3", "Promo4", "Promo5", "Promo6",
                 # change values for travel influence variables
                 "Travel1", "Travel2", "Travel3"),  ~ str_replace(., "Has no influence on my attendance  0", "0"))) %>%
    # change values for word of mouth influence variables
  mutate(across(c("WOM1", "WOM2", "WOM3",
                 # change values for media influence variables
                 "Media1", "Media3", "Media4", "Media5", "Media6", "Media12", "Media7a", "Media7b", 
                 # change values for promotion influence variables
                 "Promo1", "Promo3", "Promo4", "Promo5", "Promo6",
                 # change values for travel influence variables
                 "Travel1", "Travel2", "Travel3"),  ~ str_replace(., "Had a negative influence on my attendance -3", "-3"))) %>%
  mutate(across(c("WOM1", "WOM2", "WOM3",
                 # change values for media influence variables
                 "Media1", "Media3", "Media4", "Media5", "Media6", "Media12", "Media7a", "Media7b", 
                 # change values for promotion influence variables
                 "Promo1", "Promo3", "Promo4", "Promo5", "Promo6",
                 # change values for travel influence variables
                 "Travel1", "Travel2", "Travel3"), as.numeric)) %>%
  mutate(wom_friends_influence = WOM1,
    wom_family_influence = WOM2,
    wom_acquaintances_influence = WOM3,
    newspaper_ads_influence = Media1,
    billboard_ads_influence = Media3,
    radio_ads_influence = Media4,
    media_publicity_influence = Media5,
    internet_ads_influence = Media6,
    email_influence = Media12,
    facebook_post_influence = Media7a,
    twitter_post_influence = Media7b,
    theme_night_influence = Promo3,
    halftime_events_influence = Promo4,
    pre_match_events_influence = Promo5,
    post_match_events_influence = Promo6,
    ticket_promo_discount_influence = Promo1,
    travel_distance_influence = Travel1,
    traffic_to_stadium_influence = Travel2,
    parking_at_stadium_influence = Travel3,
    reserved_seating = case_when(
      Seat1 == "Strongly agree" ~ 3,
      Seat1 == "Agree" ~ 2,
      Seat1 == "Somewhat agree" ~ 1,
      Seat1 == "Strongly Disagree" ~ -3,
      Seat1 == "Disagree" ~ -2,
      Seat1 == "Somewhat disagree" ~ -1,
      Seat1 == "Neutral" ~ 0),
    attend_2017 = case_when(
      Attend17 == "Strongly agree" ~ 3,
      Attend17 == "Agree" ~ 2,
      Attend17 == "Somewhat agree" ~ 1,
      Attend17 == "Strongly Disagree" ~ -3,
      Attend17 == "Disagree" ~ -2,
      Attend17 == "Somewhat disagree" ~ -1,
      Attend17 == "Neutral" ~ 0),
    attend_match_2016 = case_when(
      Attend3 == "Yes" ~ 1,
      Attend3 == "No" ~ 0)) %>%
  select(ResponseId, Interest, ever_attend_match, first_attend_match, num_matches_attend_2016, 
         ticket_type_used_2016, att_game_with_family, att_game_with_friends, att_game_with_assoc,
         att_game_with_self, distance_traveled, transportation_method, intended_num_matches_attend_2017, wom_friends_influence, wom_family_influence, wom_acquaintances_influence,
         newspaper_ads_influence,billboard_ads_influence, radio_ads_influence, media_publicity_influence,
         internet_ads_influence, email_influence, facebook_post_influence, twitter_post_influence, 
         theme_night_influence, halftime_events_influence, pre_match_events_influence, post_match_events_influence,
         ticket_promo_discount_influence, travel_distance_influence, traffic_to_stadium_influence,
         parking_at_stadium_influence, attend_2017, attend_match_2016, reserved_seating, intend_season_ticket, intend_5_match_pack, intend_3_match_pack, intend_single_match, intend_pitchside_table,intend_undecided_ticket)

```

## Media variables 

```{r}
# select variables related to media consumption
Media_data <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  select(ResponseId, Media8_1, Media8_2, Media8_3, Media8_4, Media8_5, Media9, Media10, Media11, Email1)  %>%
  rename(website_visits = Media8_1,
         facebook_visits = Media8_2,
         twitter_visits = Media8_3,
         instagram_visits = Media8_4,
         youtube_visits = Media8_5,
         num_read_about_team_newspaper_digital_media = Media9,
         num_watch_team_tv = Media10) %>%
  mutate(want_more_emails = case_when(
        Email1 == "Strongly agree" ~ 3,
        Email1 == "Agree" ~ 2,
        Email1 == "Somewhat agree" ~ 1,
        Email1 == "Strongly Disagree" ~ -3,
        Email1 == "Disagree" ~ -2,
        Email1 == "Somewhat disagree" ~ -1,
        Email1 == "Neutral" ~ 0),
      want_watch_more_televised_matches = case_when(
        Media11 == "Strongly agree" ~ 3,
        Media11 == "Agree" ~ 2,
        Media11 == "Somewhat agree" ~ 1,
        Media11 == "Strongly Disagree" ~ -3,
        Media11 == "Disagree" ~ -2,
        Media11 == "Somewhat disagree" ~ -1,
        Media11 == "Neutral" ~ 0)) %>%
  select(-Email1, -Media11)
```

## Merchandise variables 

```{r}
# select variables related to merchandise consumption

Merchandise_data <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  rename(merch_price_importance = Merimp20,
         merch_variety_importance = Merimp21,
         merch_quality_importance = Merimp22,
         merch_wait_time_importance = Merimp23,
         merch_retail_convenience_importance = Merimp24,
         merch_staff_importance = Merimp25,
         prefer_short_sleeve_shirts = Shirt1,
         prefer_long_sleeve_shirts = Shirt2,
         prefer_jackets = Shirt3,
         prefer_accessories = Shirt4,
         merch_price_satisfaction = Mersat20,
         merch_variety_satisfaction = Mersat21,
         merch_quality_satisfaction = Mersat22,
         merch_wait_time_satisfaction = Mersat23,
         merch_retail_convenience_satisfaction = Mersat24,
         merch_staff_satisfaction = Mersat25) %>%
   mutate(intend_buy_merch = case_when(
        Buymer1 == "Strongly agree" ~ 3,
        Buymer1 == "Agree" ~ 2,
        Buymer1 == "Somewhat agree" ~ 1,
        Buymer1 == "Strongly Disagree" ~ -3,
        Buymer1 == "Disagree" ~ -2,
        Buymer1 == "Somewhat disagree" ~ -1,
        Buymer1 == "Neutral" ~ 0),
      prefer_buy_online = case_when(
        Buyonl1 == "Strongly agree" ~ 3,
        Buyonl1 == "Agree" ~ 2,
        Buyonl1 == "Somewhat agree" ~ 1,
        Buyonl1 == "Strongly Disagree" ~ -3,
        Buyonl1 == "Disagree" ~ -2,
        Buyonl1 == "Somewhat disagree" ~ -1,
        Buyonl1 == "Neutral" ~ 0),
      prefer_buy_at_match = case_when(
        BuyMat1 == "Strongly agree" ~ 3,
        BuyMat1 == "Agree" ~ 2,
        BuyMat1 == "Somewhat agree" ~ 1,
        BuyMat1 == "Strongly Disagree" ~ -3,
        BuyMat1 == "Disagree" ~ -2,
        BuyMat1 == "Somewhat disagree" ~ -1,
        BuyMat1 == "Neutral" ~ 0),
      prefer_buy_at_store = case_when(
        BuyStor1 == "Strongly agree" ~ 3,
        BuyStor1 == "Agree" ~ 2,
        BuyStor1 == "Somewhat agree" ~ 1,
        BuyStor1 == "Strongly Disagree" ~ -3,
        BuyStor1 == "Disagree" ~ -2,
        BuyStor1 == "Somewhat disagree" ~ -1,
        BuyStor1 == "Neutral" ~ 0)) %>%
  select(-Buymer1, -Buyonl1, -BuyMat1, -BuyStor1) %>%
  mutate(across(c("merch_price_importance", "merch_variety_importance", "merch_quality_importance", 
                  "merch_wait_time_importance", "merch_retail_convenience_importance", "merch_staff_importance"),
                  ~ str_replace(., "Very Important", "7"))) %>%
  mutate(across(c("merch_price_importance", "merch_variety_importance", "merch_quality_importance", 
                   "merch_wait_time_importance", "merch_retail_convenience_importance" ,"merch_staff_importance"),
                  ~ str_replace(., "Very Unimportant", "1"))) %>%
  mutate(across(c("merch_price_importance", "merch_variety_importance", "merch_quality_importance", 
                  "merch_wait_time_importance", "merch_retail_convenience_importance", "merch_staff_importance"),
                  ~ str_replace(., "Neutral", "4"))) %>%
  mutate(across(c("merch_price_satisfaction", "merch_variety_satisfaction", "merch_quality_satisfaction", 
                  "merch_wait_time_satisfaction", "merch_retail_convenience_satisfaction", "merch_staff_satisfaction"),
                  ~ str_replace(., "Very Satisfied", "7"))) %>%
  mutate(across(c("merch_price_satisfaction", "merch_variety_satisfaction", "merch_quality_satisfaction", 
                  "merch_wait_time_satisfaction", "merch_retail_convenience_satisfaction", "merch_staff_satisfaction"),
                  ~ str_replace(., "Very Dissatisfied", "1"))) %>%
  mutate(across(c("merch_price_satisfaction", "merch_variety_satisfaction", "merch_quality_satisfaction", 
                  "merch_wait_time_satisfaction", "merch_retail_convenience_satisfaction", "merch_staff_satisfaction"),
                  ~ str_replace(., "Neutral", "4"))) %>%
  mutate(across(c("merch_price_importance", "merch_variety_importance", "merch_quality_importance", 
                  "merch_wait_time_importance", "merch_retail_convenience_importance", "merch_staff_importance", 
                  "merch_price_satisfaction", "merch_variety_satisfaction", "merch_quality_satisfaction", 
                  "merch_wait_time_satisfaction", "merch_retail_convenience_satisfaction", "merch_staff_satisfaction"), as.numeric)) %>%
  mutate(spend_2016 = case_when(
    is.na(SpndlstS) == FALSE & is.na(SpndlstO) == FALSE ~ SpndlstS + SpndlstO,
    is.na(SpndlstS) == FALSE & is.na(SpndlstO) == TRUE ~ SpndlstS,
    is.na(SpndlstS) == TRUE & is.na(SpndlstO) == FALSE ~ SpndlstO)) %>%
  select(ResponseId, merch_price_satisfaction, merch_variety_satisfaction, merch_quality_satisfaction, merch_wait_time_satisfaction,
         merch_retail_convenience_satisfaction, merch_staff_satisfaction, merch_price_importance, merch_variety_importance,
         merch_quality_importance, merch_wait_time_importance, merch_retail_convenience_importance, merch_staff_importance,
         prefer_short_sleeve_shirts, prefer_long_sleeve_shirts, prefer_jackets, prefer_accessories, prefer_buy_online, prefer_buy_at_match, prefer_buy_at_store, spend_2016, intend_buy_merch)
```

## Satisfaction variables 

```{r}
# select variables related to merchandise consumption
Satisfaction_data <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  select(ResponseId, Matchsat, Expsat1, Prsnsat1, Autgsat1, Prsnsat2, Prsnsat3, Satout2, Satperf3) %>%
  mutate(season_outcome = case_when(
        Satout2 == "Strongly agree" ~ 3,
        Satout2 == "Agree" ~ 2,
        Satout2 == "Somewhat agree" ~ 1,
        Satout2 == "Strongly Disagree" ~ -3,
        Satout2 == "Disagree" ~ -2,
        Satout2 == "Somewhat disagree" ~ -1,
        Satout2 == "Neutral" ~ 0),
    season_performance = case_when(
        Satperf3 == "Strongly agree" ~ 3,
        Satperf3 == "Agree" ~ 2,
        Satperf3 == "Somewhat agree" ~ 1,
        Satperf3 == "Strongly Disagree" ~ -3,
        Satperf3 == "Disagree" ~ -2,
        Satperf3 == "Somewhat disagree" ~ -1,
        Satperf3 == "Neutral" ~ 0)) %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(where(is.character),  ~ str_replace(., "Very Satisfied", "7"))) %>%
  mutate(across(where(is.character),  ~ str_replace(., "Very Dissatisfied", "1"))) %>%
  mutate(across(where(is.character),  ~ str_replace(., "Neutral", "4"))) %>%
  mutate(across(c("Matchsat", "Expsat1", "Prsnsat1", "Autgsat1", "Prsnsat2", "Prsnsat3"), as.numeric)) %>%
  mutate(overall_match_day_experience = Matchsat,
    overall_memorial_stadium_experience = Expsat1,
    arena_staff_friendliness = Prsnsat1,
    autograph_opportunities = Autgsat1,
    arena_security = Prsnsat2,
    entering_stadium = Prsnsat3) %>%
  select(-Matchsat, -Expsat1, -Prsnsat1, -Autgsat1, -Prsnsat2, -Prsnsat3, -Satout2, -Satperf3)
```

## Brand attitude

```{r}
Brand_attitude_data <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  select(ResponseId, Follow1, Posaff1, Negaff1,  BIRG1, CORF1, Support1) %>%
  mutate(likely_follow_2017 = case_when(
          Follow1 == "Yes" ~ 1,
          Follow1 == "No" ~ 0),
        happy_about_2016_season = case_when(
          Posaff1 == "Strongly agree" ~ 3,
          Posaff1 == "Agree" ~ 2,
          Posaff1 == "Somewhat agree" ~ 1,
          Posaff1 == "Strongly Disagree" ~ -3,
          Posaff1 == "Disagree" ~ -2,
          Posaff1 == "Somewhat disagree" ~ -1,
          Posaff1 == "Neutral" ~ 0),
        disappointed_with_2016_season = case_when(
          Negaff1 == "Strongly agree" ~ 3,
          Negaff1 == "Agree" ~ 2,
          Negaff1 == "Somewhat agree" ~ 1,
          Negaff1 == "Strongly Disagree" ~ -3,
          Negaff1 == "Disagree" ~ -2,
          Negaff1 == "Somewhat disagree" ~ -1,
          Negaff1 == "Neutral" ~ 0),
        share_affiliation_others = case_when(
          BIRG1 == "Strongly agree" ~ 3,
          BIRG1 == "Agree" ~ 2,
          BIRG1 == "Somewhat agree" ~ 1,
          BIRG1 == "Strongly Disagree" ~ -3,
          BIRG1 == "Disagree" ~ -2,
          BIRG1 == "Somewhat disagree" ~ -1,
          BIRG1 == "Neutral" ~ 0),
         wish_werent_fan = case_when(
          CORF1 == "Strongly agree" ~ 3,
          CORF1 == "Agree" ~ 2,
          CORF1 == "Somewhat agree" ~ 1,
          CORF1 == "Strongly Disagree" ~ -3,
          CORF1 == "Disagree" ~ -2,
          CORF1 == "Somewhat disagree" ~ -1,
          CORF1 == "Neutral" ~ 0),
         likely_support_2017 = case_when(
          Support1 == "Strongly agree" ~ 3,
          Support1 == "Agree" ~ 2,
          Support1 == "Somewhat agree" ~ 1,
          Support1 == "Strongly Disagree" ~ -3,
          Support1 == "Disagree" ~ -2,
          Support1 == "Somewhat disagree" ~ -1,
          Support1 == "Neutral" ~ 0)) %>%
  select(ResponseId, likely_follow_2017,happy_about_2016_season, disappointed_with_2016_season, share_affiliation_others, wish_werent_fan, likely_support_2017)

```

## Corporate partners 

```{r}
Corporate_partners <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  select(ResponseId, BuySpon1, Purchs1, Purchs2, Purchs3, Purchs4, Purchs5, 
         Purchs6, Purchs7, Purchs8, Purchs9, Purchs10, Spnbuy1, Spnbuy2, Spnbuy3, 
         Spnbuy4, Spnbuy5, Spnbuy6, Spnbuy7, Spnbuy8, Spnbuy9, Spnbuy10) %>%
  mutate(likely_buy_sponsor = case_when(
    BuySpon1 %in% c("Agree",	"Strongly agree","Somewhat agree") ~ "agree",
    BuySpon1 %in% c("Disagree", "Somewhat disagree", "Strongly Disagree") ~ "disagree",
    BuySpon1 == "Neutral" ~ "neutral")) %>%
  mutate(likely_buy_sponsor2 = case_when(
          BuySpon1 == "Strongly agree" ~ 3,
          BuySpon1 == "Agree" ~ 2,
          BuySpon1 == "Somewhat agree" ~ 1,
          BuySpon1 == "Strongly Disagree" ~ -3,
          BuySpon1 == "Disagree" ~ -2,
          BuySpon1 == "Somewhat disagree" ~ -1,
          BuySpon1 == "Neutral" ~ 0)) %>%
  mutate(across(c("Purchs1", "Purchs2", "Purchs3", "Purchs4", "Purchs5", "Purchs6", "Purchs7", "Purchs8", "Purchs9", "Purchs10"), ~str_replace(., "Yes", "1"))) %>%
  mutate(across(c("Purchs1", "Purchs2", "Purchs3", "Purchs4", "Purchs5", "Purchs6", "Purchs7", "Purchs8", "Purchs9", "Purchs10"), ~str_replace(., "No", "0"))) %>%
  mutate(across(c("Purchs1", "Purchs2", "Purchs3", "Purchs4", "Purchs5", "Purchs6", "Purchs7", "Purchs8", "Purchs9", "Purchs10"), ~str_replace(., "I don't know", "NA"))) %>%
  mutate(across(c("Purchs1", "Purchs2", "Purchs3", "Purchs4", "Purchs5", "Purchs6", "Purchs7", "Purchs8", "Purchs9", "Purchs10"), as.numeric)) %>%
  mutate(across(where(is.character), ~str_replace(., "Not at all likely to consider them when making a purchase decision 1", "1")))  %>%
  mutate(across(where(is.character), ~str_replace(., "Extremely likely to consider them when making a purchase decision 7", "7")))  %>%
  mutate(across(c("Spnbuy1", "Spnbuy2", "Spnbuy3", "Spnbuy4", "Spnbuy5", "Spnbuy6", "Spnbuy7", "Spnbuy8", "Spnbuy9", "Spnbuy10"), as.numeric)) %>%
  rename(bought_carter_sub = Purchs1,
         bought_msft = Purchs2,
         bought_pepsi = Purchs3,
         bought_becu = Purchs4,
         bought_chihuly_studio = Purchs5,
         bought_hardrock_cafe = Purchs6,
         bought_health_warrior = Purchs7,
         bought_hyatt_house = Purchs8,
         bought_kraken_congee = Purchs9,
         bought_ruffneck_scarves = Purchs10,
         consider_carter_sub = Spnbuy1,
         consider_msft = Spnbuy2,
         consider_pepsi = Spnbuy3,
         consider_becu = Spnbuy4,
         consider_chihuly_studio = Spnbuy5,
         consider_hardrock_cafe = Spnbuy6,
         consider_health_warrior = Spnbuy7,
         consider_hyatt_house = Spnbuy8,
         consider_kraken_congee = Spnbuy9,
         consider_ruffneck_scarves = Spnbuy10) %>%
  select(-BuySpon1)


```

## Demographic data

```{r}
Demographic_and_other_data <- sea_reign_data %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  select(ResponseId, Gender, SexOrient, Race, Age, Educat, Income, House1, House2,Marital,
         GameTim1, GameTim2, 
         GameTim3, GameTim4, GameTim5, GameTim6, GameTim7)%>%
  mutate(most_ideal_time = case_when(
          GameTim1==1 ~ "Wed Evenings",
          GameTim1==2 ~ "Friday Evenings",
          GameTim1==3 ~ "Saturday Afternoons 1pm",
          GameTim1==4 ~ "Saturday Afternoons 4pm",
          GameTim1==5 ~ "Saturday Evenings",
          GameTim1==6 ~ "Sunday Afternoons 4pm",
          GameTim1==7 ~ "Sunday Evenings")) %>%
  select(-GameTim1, -GameTim2, -GameTim3, -GameTim4, -GameTim5, -GameTim6, -GameTim7)%>%
  rename(gender = Gender,
         sex_orient = SexOrient,
         race = Race,
         age = Age,
         education = Educat,
         marriage_status = Marital,
         hh_occupants = House1,
         children = House2,
         income = Income)

```

## Market insight data

```{r}
market_insight_data <- sea_reign_data %>%
  select(ResponseId, IDteam1, IDplay1, IDcoach1, HopeS1, IDsport1, Escape1,Skill2, Success2, Drama4, Aggress3, Socint1, RoleMod2, Clink1, Starfir1, Ticket1, Rapinoe1, Cost3, Cause1, NoInt1, NoInt2, NoInt3, IDnattm1, IDcomm2, Knowledg3) %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(real_fan = case_when(
            IDteam1 == "Strongly agree" ~ 3,
            IDteam1 == "Agree" ~ 2,
            IDteam1 == "Somewhat agree" ~ 1,
            IDteam1 == "Strongly Disagree" ~ -3,
            IDteam1 == "Disagree" ~ -2,
            IDteam1 == "Somewhat disagree" ~ -1,
            IDteam1 == "Neutral" ~ 0),
         player_fan = case_when(
            IDplay1 == "Strongly agree" ~ 3,
            IDplay1 == "Agree" ~ 2,
            IDplay1 == "Somewhat agree" ~ 1,
            IDplay1 == "Strongly Disagree" ~ -3,
            IDplay1 == "Disagree" ~ -2,
            IDplay1 == "Somewhat disagree" ~ -1,
            IDplay1 == "Neutral" ~ 0),
         coach_fan = case_when(
            IDcoach1 == "Strongly agree" ~ 3,
            IDcoach1 == "Agree" ~ 2,
            IDcoach1 == "Somewhat agree" ~ 1,
            IDcoach1 == "Strongly Disagree" ~ -3,
            IDcoach1 == "Disagree" ~ -2,
            IDcoach1 == "Somewhat disagree" ~ -1,
            IDcoach1 == "Neutral" ~ 0),
         hope_solo_fan = case_when(
            HopeS1 == "Strongly agree" ~ 3,
            HopeS1 == "Agree" ~ 2,
            HopeS1 == "Somewhat agree" ~ 1,
            HopeS1 == "Strongly Disagree" ~ -3,
            HopeS1 == "Disagree" ~ -2,
            HopeS1 == "Somewhat disagree" ~ -1,
            HopeS1 == "Neutral" ~ 0),
         pro_women_soccer_fan = case_when(
            IDsport1 == "Strongly agree" ~ 3,
            IDsport1 == "Agree" ~ 2,
            IDsport1 == "Somewhat agree" ~ 1,
            IDsport1 == "Strongly Disagree" ~ -3,
            IDsport1 == "Disagree" ~ -2,
            IDsport1 == "Somewhat disagree" ~ -1,
            IDsport1 == "Neutral" ~ 0),
         provide_escape = case_when(
            Escape1 == "Strongly agree" ~ 3,
            Escape1 == "Agree" ~ 2,
            Escape1 == "Somewhat agree" ~ 1,
            Escape1 == "Strongly Disagree" ~ -3,
            Escape1 == "Disagree" ~ -2,
            Escape1 == "Somewhat disagree" ~ -1,
            Escape1 == "Neutral" ~ 0),
         players_are_skilled = case_when(
            Skill2 == "Strongly agree" ~ 3,
            Skill2 == "Agree" ~ 2,
            Skill2 == "Somewhat agree" ~ 1,
            Skill2 == "Strongly Disagree" ~ -3,
            Skill2 == "Disagree" ~ -2,
            Skill2 == "Somewhat disagree" ~ -1,
            Skill2 == "Neutral" ~ 0),
         team_wins_more = case_when(
            Success2 == "Strongly agree" ~ 3,
            Success2 == "Agree" ~ 2,
            Success2 == "Somewhat agree" ~ 1,
            Success2 == "Strongly Disagree" ~ -3,
            Success2 == "Disagree" ~ -2,
            Success2 == "Somewhat disagree" ~ -1,
            Success2 == "Neutral" ~ 0),
         provides_excitement = case_when(
            Drama4 == "Strongly agree" ~ 3,
            Drama4 == "Agree" ~ 2,
            Drama4 == "Somewhat agree" ~ 1,
            Drama4 == "Strongly Disagree" ~ -3,
            Drama4 == "Disagree" ~ -2,
            Drama4 == "Somewhat disagree" ~ -1,
            Drama4 == "Neutral" ~ 0),
         team_plays_aggress = case_when(
            Aggress3 == "Strongly agree" ~ 3,
            Aggress3 == "Agree" ~ 2,
            Aggress3 == "Somewhat agree" ~ 1,
            Aggress3 == "Strongly Disagree" ~ -3,
            Aggress3 == "Disagree" ~ -2,
            Aggress3 == "Somewhat disagree" ~ -1,
            Aggress3 == "Neutral" ~ 0),
         provides_social_interaction = case_when(
            Socint1 == "Strongly agree" ~ 3,
            Socint1 == "Agree" ~ 2,
            Socint1 == "Somewhat agree" ~ 1,
            Socint1 == "Strongly Disagree" ~ -3,
            Socint1 == "Disagree" ~ -2,
            Socint1 == "Somewhat disagree" ~ -1,
            Socint1 == "Neutral" ~ 0),
         provides_role_models = case_when(
            RoleMod2 == "Strongly agree" ~ 3,
            RoleMod2 == "Agree" ~ 2,
            RoleMod2 == "Somewhat agree" ~ 1,
            RoleMod2 == "Strongly Disagree" ~ -3,
            RoleMod2 == "Disagree" ~ -2,
            RoleMod2 == "Somewhat disagree" ~ -1,
            RoleMod2 == "Neutral" ~ 0),
         prefer_lumen_staidum = case_when(
            Clink1 == "Strongly agree" ~ 3,
            Clink1 == "Agree" ~ 2,
            Clink1 == "Somewhat agree" ~ 1,
            Clink1 == "Strongly Disagree" ~ -3,
            Clink1 == "Disagree" ~ -2,
            Clink1 == "Somewhat disagree" ~ -1,
            Clink1 == "Neutral" ~ 0),
         prefer_starfire_staidum = case_when(
            Starfir1 == "Strongly agree" ~ 3,
            Starfir1 == "Agree" ~ 2,
            Starfir1 == "Somewhat agree" ~ 1,
            Starfir1 == "Strongly Disagree" ~ -3,
            Starfir1 == "Disagree" ~ -2,
            Starfir1 == "Somewhat disagree" ~ -1,
            Starfir1 == "Neutral" ~ 0),
         tickets_easy_get = case_when(
            Ticket1 == "Strongly agree" ~ 3,
            Ticket1 == "Agree" ~ 2,
            Ticket1 == "Somewhat agree" ~ 1,
            Ticket1 == "Strongly Disagree" ~ -3,
            Ticket1 == "Disagree" ~ -2,
            Ticket1 == "Somewhat disagree" ~ -1,
            Ticket1 == "Neutral" ~ 0),
         support_kneeling = case_when(
            Rapinoe1 == "Strongly agree" ~ 3,
            Rapinoe1 == "Agree" ~ 2,
            Rapinoe1 == "Somewhat agree" ~ 1,
            Rapinoe1 == "Strongly Disagree" ~ -3,
            Rapinoe1 == "Disagree" ~ -2,
            Rapinoe1 == "Somewhat disagree" ~ -1,
            Rapinoe1 == "Neutral" ~ 0),
         match_cost_inexpensive = case_when(
            Cost3 == "Strongly agree" ~ 3,
            Cost3 == "Agree" ~ 2,
            Cost3 == "Somewhat agree" ~ 1,
            Cost3 == "Strongly Disagree" ~ -3,
            Cost3 == "Disagree" ~ -2,
            Cost3 == "Somewhat disagree" ~ -1,
            Cost3 == "Neutral" ~ 0),
         family_not_interested = case_when(
            NoInt1 == "Strongly agree" ~ 3,
            NoInt1 == "Agree" ~ 2,
            NoInt1 == "Somewhat agree" ~ 1,
            NoInt1 == "Strongly Disagree" ~ -3,
            NoInt1 == "Disagree" ~ -2,
            NoInt1 == "Somewhat disagree" ~ -1,
            NoInt1 == "Neutral" ~ 0),
         sig_other_not_interested = case_when(
            NoInt2 == "Strongly agree" ~ 3,
            NoInt2 == "Agree" ~ 2,
            NoInt2 == "Somewhat agree" ~ 1,
            NoInt2 == "Strongly Disagree" ~ -3,
            NoInt2 == "Disagree" ~ -2,
            NoInt2 == "Somewhat disagree" ~ -1,
            NoInt2 == "Neutral" ~ 0),
         friends_not_interested = case_when(
            NoInt3 == "Strongly agree" ~ 3,
            NoInt3 == "Agree" ~ 2,
            NoInt3 == "Somewhat agree" ~ 1,
            NoInt3 == "Strongly Disagree" ~ -3,
            NoInt3 == "Disagree" ~ -2,
            NoInt3 == "Somewhat disagree" ~ -1,
            NoInt3 == "Neutral" ~ 0),
         womans_national_team_fan = case_when(
            IDnattm1 == "Strongly agree" ~ 3,
            IDnattm1 == "Agree" ~ 2,
            IDnattm1 == "Somewhat agree" ~ 1,
            IDnattm1 == "Strongly Disagree" ~ -3,
            IDnattm1 == "Disagree" ~ -2,
            IDnattm1 == "Somewhat disagree" ~ -1,
            IDnattm1 == "Neutral" ~ 0),
         feel_part_of_community_fan = case_when(
            IDcomm2 == "Strongly agree" ~ 3,
            IDcomm2 == "Agree" ~ 2,
            IDcomm2 == "Somewhat agree" ~ 1,
            IDcomm2 == "Strongly Disagree" ~ -3,
            IDcomm2 == "Disagree" ~ -2,
            IDcomm2 == "Somewhat disagree" ~ -1,
            IDcomm2 == "Neutral" ~ 0),
         provides_learning_opp = case_when(
            Knowledg3 == "Strongly agree" ~ 3,
            Knowledg3 == "Agree" ~ 2,
            Knowledg3 == "Somewhat agree" ~ 1,
            Knowledg3 == "Strongly Disagree" ~ -3,
            Knowledg3 == "Disagree" ~ -2,
            Knowledg3 == "Somewhat disagree" ~ -1,
            Knowledg3 == "Neutral" ~ 0),
         support_woman_sport = case_when(
            Cause1 == "Strongly agree" ~ 3,
            Cause1 == "Agree" ~ 2,
            Cause1 == "Somewhat agree" ~ 1,
            Cause1 == "Strongly Disagree" ~ -3,
            Cause1 == "Disagree" ~ -2,
            Cause1 == "Somewhat disagree" ~ -1,
            Cause1 == "Neutral" ~ 0)) %>%
  select(-c( IDteam1, IDplay1, IDcoach1, HopeS1, IDsport1, Escape1,Skill2, Success2, Drama4, Aggress3, Socint1, RoleMod2, Clink1, Starfir1, Ticket1, Rapinoe1, Cost3, Cause1, NoInt1, NoInt2, NoInt3, IDnattm1, IDcomm2, Knowledg3))
```

## Matchday Exeprience data

```{r}
matchday_satisfaction_data <- sea_reign_data%>%
  select(ResponseId, Consat3, Consat4, Consat1, Consat9, Consat6, Consat8, Beersat1, Consat2, Prsnsat4, Consat5, Consat7, Beersat2, Fdtrsat1, Fdtrsat2, Rstrsat1) %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(where(is.character), ~ str_replace(., "Neutral", "0"))) %>%
  mutate(across(where(is.character), ~ str_replace(., "Very Dissatisfied", "1"))) %>%
  mutate(across(where(is.character), ~ str_replace(., "Very Satisfied", "7"))) %>%
  mutate(across(where(is.character), as.numeric)) %>%
  rename(concession_offering = Consat3,
         concession_food_price = Consat4,
         concession_food_quality = Consat1,
         concession_food_wait_time = Consat9,
         concession_drink_wait_time = Consat6,
         concession_location = Consat8,
         beergarden_locations = Beersat1,
         concession_food_variety = Consat2,
         consession_staff = Prsnsat4,
         concession_drink_price = Consat5,
         concession_drink_variety = Consat7,
         beer_garden = Beersat2,
         food_truck_service_quality = Fdtrsat1,
         food_truck_food_drink_quality = Fdtrsat2,
         cleanliness = Rstrsat1)

```

# Prepare data

```{r}
sea_reign <- left_join(Attendance_data, Media_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, Merchandise_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, Satisfaction_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, Brand_attitude_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, Corporate_partners, by = "ResponseId")
sea_reign <- left_join(sea_reign, Demographic_and_other_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, market_insight_data, by = "ResponseId")
sea_reign <- left_join(sea_reign, matchday_satisfaction_data, by = "ResponseId")

#vtable(sea_reign)

copy_of_data <- sea_reign

sea_reign <- sea_reign %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId, -ticket_type_used_2016) %>%
  mutate(across(c(ever_attend_match, att_game_with_family, att_game_with_friends, att_game_with_assoc, att_game_with_self,
    attend_match_2016, intend_season_ticket, intend_5_match_pack, intend_3_match_pack, intend_single_match, 
    intend_pitchside_table, intend_undecided_ticket, prefer_short_sleeve_shirts, prefer_long_sleeve_shirts, 
    prefer_jackets, prefer_accessories, likely_follow_2017, bought_carter_sub, bought_msft, bought_pepsi, 
    bought_becu, bought_chihuly_studio, bought_hardrock_cafe, bought_health_warrior, bought_hyatt_house,
    bought_kraken_congee, bought_ruffneck_scarves), as.factor))

```


```{r}
# create number coded df
numeric_data_set <- copy_of_data %>%
  mutate(likely_buy_sponsor = likely_buy_sponsor2) %>%
  select(-likely_buy_sponsor2)

# convert categorical variables to number coded
numeric_data_set <- numeric_data_set %>%
  mutate(across(Interest, ~ str_replace(.,"die-hard fan", "5"))) %>%
  mutate(across(Interest, ~ str_replace(.,"loyal fan", "4"))) %>%
  mutate(across(Interest, ~ str_replace(.,"moderate fan", "3"))) %>%
  mutate(across(Interest, ~ str_replace(.,"low level fan", "2"))) %>%
  mutate(across(Interest, ~ str_replace(., "hardly interested", "1"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "Season Ticket", "5"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "Pitchside Table", "4"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "5 Match Pack", "3"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "3 Match Pack", "2"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "Single Match", "1"))) %>%
  mutate(across(ticket_type_used_2016, ~ str_replace(., "I don't know", "0"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Personal Car", "5"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Ride Share \\(i.e. Uber\\/Lyft\\)", "4"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Public Transportation", "3"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Bike", "2"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Walk", "1"))) %>%
  mutate(across(transportation_method, ~ str_replace(., "Other", "0"))) %>%
  mutate(across(gender, ~ str_replace(., "Female", "1"))) %>%
  mutate(across(gender, ~ str_replace(., "Male", "2"))) %>%
  mutate(across(gender, ~ str_replace(., "Prefer not to answer", "0"))) %>%
  mutate(across(sex_orient, ~ str_replace(., "Heterosexual", "4"))) %>%
  mutate(across(sex_orient, ~ str_replace(., "Gay\\/Lesbian", "3"))) %>%
  mutate(across(sex_orient, ~ str_replace(., "Bisexual", "2"))) %>%
  mutate(across(sex_orient, ~ str_replace(., "Other", "1"))) %>%
  mutate(across(sex_orient, ~ str_replace(., "Prefer not to answer", "0"))) %>%
  mutate(across(race, ~ str_replace(., "White", "6"))) %>%
  mutate(across(race, ~ str_replace(., "Asian", "5"))) %>%
  mutate(across(race, ~ str_replace(., "American Indian\\/Alaska Native", "4"))) %>%
  mutate(across(race, ~ str_replace(., "Native Hawaiian\\/Pacific Islander", "3"))) %>%
  mutate(across(race, ~ str_replace(., "Black\\/African American", "2"))) %>%
  mutate(across(race, ~ str_replace(., "Other", "1"))) %>%
  mutate(across(race, ~ str_replace(., "Prefer not to answer", "0"))) %>%
  mutate(across(education, ~ str_replace(., "Graduate Degree", "4"))) %>%
  mutate(across(education, ~ str_replace(., "College Graduate", "3"))) %>%
  mutate(across(education, ~ str_replace(., "Some College", "2"))) %>%
  mutate(across(education, ~ str_replace(., "High School Graduate", "1"))) %>%
  mutate(across(education, ~ str_replace(., "Other", "0"))) %>%
  mutate(across(income, ~ str_replace(., "\\$300,000 or Above", "9"))) %>%
  mutate(across(income, ~ str_replace(., "\\$200,000 -\\$299,999", "8"))) %>%
  mutate(across(income, ~ str_replace(., "\\$150,000 - \\$199,999", "7"))) %>%
  mutate(across(income, ~ str_replace(., "\\$100,000 - \\$149,999", "6"))) %>%
  mutate(across(income, ~ str_replace(., "\\$80,000 - \\$99,999", "5"))) %>%
  mutate(across(income, ~ str_replace(., "\\$60,000 - \\$79,999", "4"))) %>%
  mutate(across(income, ~ str_replace(., "\\$40,000 - \\$59,999", "3"))) %>%
  mutate(across(income, ~ str_replace(., "\\$20,000 - \\$39,999", "2"))) %>%
  mutate(across(income, ~ str_replace(., "Below \\$20,000", "1"))) %>%
  mutate(across(marriage_status, ~ str_replace(., "Married\\/Partnered", "2"))) %>%
  mutate(across(marriage_status, ~ str_replace(., "Single", "1"))) %>%
  mutate(across(marriage_status, ~ str_replace(., "Other", "0"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Sunday Evenings", "7"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Saturday Afternoons 1pm", "6"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Sunday Afternoons 4pm", "5"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Wed Evenings", "4"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Saturday Afternoons 4pm", "3"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Friday Evenings", "2"))) %>%
  mutate(across(most_ideal_time, ~ str_replace(., "Saturday Evenings", "1"))) %>%
  mutate(across(c("Interest", "ticket_type_used_2016", "transportation_method", "gender", "sex_orient", "race", "education", "income", "marriage_status", "most_ideal_time"), as.numeric))

```

# Look at data set

```{r}
# look at beginning of data set
head(sea_reign)
```

```{r}
# look at types of variables in data
str(sea_reign)
```

```{r}
# summary statistics
summary(sea_reign)
```

```{r}
# look at data
vtable(sea_reign, lush = TRUE)
```


# Base EDA Step 1: Univariate Non-Graphical Analysis

## Overview

+ Look at Variable Types

```{r}
sea_reign %>%
	inspect_types() %>%
	show_plot()
```

+ Look at Data set

```{r}
sea_reign %>%
	plot_intro()
```

## Categorical Variables

#### Interest

```{r}
sea_reign %>%
  group_by(Interest) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**comments:**

  - most observations for loyal fans
  - likely not enough observations for hardly interested observations

#### ever_attend_match

```{r}
sea_reign %>%
  group_by(ever_attend_match) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - low count of observations for respondents who have never attended a match, but need to see if there are enough


#### att_game_with_family

```{r}
sea_reign %>%
  group_by(att_game_with_family) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - distribution between categories is uneven, but there appears to be a good number of observations per category

#### att_game_with_friends

```{r}
sea_reign %>%
  group_by(att_game_with_friends) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - distribution between categories is uneven, but there appears to be a good number of observations per category

#### att_game_with_assoc

```{r}
sea_reign %>%
  group_by(att_game_with_assoc) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - very low observation count for observations where the respondent has attended a match with business associates
  - drop this variable from analysis moving forward

#### att_game_with_self

```{r}
sea_reign %>%
  group_by(att_game_with_self) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - distribution between categories is uneven and there might be too few if split up further over other variables

#### transportation_method

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(transportation_method) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

- highest number of observations for personal car
- small observation count for walk, bike, rideshare and other
- potentially small observation count for public transportation if split up further

#### intend_season_ticket

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_season_ticket) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - 11% of observations indicated that they intend to buy season tickets

#### intend_5_match_pack

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_5_match_pack) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - only 3% of observations indicated that they intend to buy 5 match pack tickets
  
#### intend_3_match_pack

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_3_match_pack) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - only 2% of observations indicated that they intend to buy 3 mathc pack tickets
  
#### intend_single_match

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_single_match) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - 16% of observations indicated that they intend to buy single match tickets
  
#### intend_pitchside_table

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_pitchside_table) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - only 1% of observations indicated that they intend to buy season tickets
  
#### intend_undecided_ticket

```{r}
sea_reign %>%
  drop_na() %>%
  group_by(intend_undecided_ticket) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - only 3% of observations indicated that they intend to buy season tickets


#### prefer_short_sleeve_shirts

```{r}
sea_reign %>%
  group_by(prefer_short_sleeve_shirts) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - nice distribution and good sample sizes

#### prefer_long_sleeve_shirts

```{r}
sea_reign %>%
  group_by(prefer_long_sleeve_shirts) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - nice distribution and good sample sizes

#### prefer_jackets

```{r}
sea_reign %>%
  group_by(prefer_jackets) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - nice distribution and good sample sizes

#### prefer_accessories

```{r}
sea_reign %>%
  group_by(prefer_accessories) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - nice distribution and good sample sizes
  
#### likely_follow_2017


```{r}
sea_reign %>%
  group_by(likely_follow_2017) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - disproportionate distribution of observations and likely small count for No's when split up 


#### bought_carter_sub

```{r}
sea_reign %>%
  group_by(bought_carter_sub) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - potentially too small of a sample size for observations where respondents bought carter sub in last 6 months

#### bought_msft

```{r}
sea_reign %>%
  group_by(bought_msft) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  -  good number of observations per category

#### bought_pepsi

```{r}
sea_reign %>%
  group_by(bought_pepsi) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  -  good number of observations per category
  
  
#### bought_becu

```{r}
sea_reign %>%
  group_by(bought_becu) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - decent number of observations per category, but distribution is uneven
  - highest count for 0

#### bought_chihuly_studio

```{r}
sea_reign %>%
  group_by(bought_chihuly_studio) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - potentially too small of a sample size for observations where respondent purchased chihuly studio in past 6 mo

#### bought_hardrock_cafe

```{r}
sea_reign %>%
  group_by(bought_hardrock_cafe) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - might have too small of a sample size for observations of 1 when split up

#### bought_health_warrior

```{r}
sea_reign %>%
  group_by(bought_health_warrior) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - Sample size is potentially too small for respondents who bought health warrior products in the past 6 months

#### bought_hyatt_house

```{r}
sea_reign %>%
  group_by(bought_hyatt_house) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - Sample size is potentially too small for respondents who bought hyatt house products in the past 6 months
  
#### bought_kraken_congee

```{r}
sea_reign %>%
  group_by(bought_kraken_congee) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - decent sample size across categories

#### bought_ruffneck_scarves

```{r}
sea_reign %>%
  group_by(bought_ruffneck_scarves) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - good sample size across categories
  
#### likely_buy_sponsor

```{r}
sea_reign %>%
  group_by(likely_buy_sponsor) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - good sample size across categories
  
#### gender

```{r}
sea_reign %>%
  group_by(gender) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - good sample size across categories, but prefer not to answer has small sample size
  - most observations for female
  
#### sex_orient

```{r}
sea_reign %>%
  group_by(sex_orient) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

 - potentially small sample size for bisexual, prefer not to answer, and other cateogires
  
#### race

```{r}
sea_reign %>%
  group_by(race) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - very uneven distribution of observations over races
  - white has the most observations
  
#### education

```{r}
sea_reign %>%
  group_by(education) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - potentially low observation count for High School Graduate
  - low observation count for other
  
#### income

```{r}
sea_reign %>%
  group_by(income) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - distribution on observations over income levels looks good, 
  - number of observations for $300,000 or above might be low
  - and number of observations for below $20,000 might be low
  
#### marriage_status

```{r}
sea_reign %>%
  group_by(marriage_status) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - good sample size across categories
  - most observations for married/partnered
  
#### most_ideal_time

```{r}
sea_reign %>%
  group_by(most_ideal_time) %>%
  summarize(count = n(),  # make calculations to summarize variable and create counting function
          proportion = round(sum(count) / nrow(sea_reign),2),# Calculate proportion
          percent = sum(count) / nrow(sea_reign)) %>%# create percent variable 
  arrange(-percent) %>% # display table results by percent in descending order
  mutate(percent = percent(percent)) 
```

**Comments:**

  - distribution of observations per category looks very uneven
  - sunday evenings has highest number of observations
  

## Quantatitive variables

```{r}
sea_reign %>%
  select(is.numeric) %>%
  stat.desc() %>%
  round(digits = 2) %>%
  kable()
```

**Comments:**

  - all variables are skewed, skew is very small for some variables, but we'll use median rather than mean for analysis of these variables
  

# Base EDA Step 1: Questions/Comments 


**Concluding Questions/Comments on Attendance Variables**

+ focus on travel_distance_influence, traffic_to_stadium_influence, parking_at_stadium_influence and reserved_seating variables as they had a good number of observations per category

+ attend_2017 and att_game_with_assoc likely won't be too revealing because there is an uneven distribution of observations among categories. Most observations for attend_2017 say the respondent intends on attending and only observations for att_game_with_assoc were yes.


**Concluding Questions/Comments on Media Variables**

+ focus on want_more_emails as it had a good number of observations per category

+ want_watch_more_televised_matches had a very uneven distribution of observations among categories (most respondents said yes they do want to watch more matches on national tv) and this variable might not be too revealing

**Concluding Questions/Comments on Merchandise Variables**

+ Focus on product preference variables (prefer_short_sleeve_shirts, prefer_long_sleeve_shirts, prefer_jackets, prefer_accessories) these variables have good sample sizes and a fairly even distribution of observations over the categories

+ price and variety satisfaction variables appeared to have a good distribution of observations over the categories (price_satisfaction, variety_satisfaction)

+ merchandise preference location variables all looked like they had good sample sizes for each category (prefer_buy_online, prefer_buy_at_match, prefer_buy_at_store)

+ Merch importance variables from analysis have lots of na’s and likely to have small sample sizes for neutral and unimportant categories if split up.

**Concluding Questions/Comments on Satisfaction  Variables**

+ season_outcome, happy_about_2016_season, disappointed_with_2016_season all had good observation counts for each category

+ overall_memorial_stadium_experience, arena_staff_friendliness, autograph_opportunities, arena_security, entering_stadium, likely_follow_2017 all had okay counts, but distribution of responses was very uneven

+ overall_match_day_experience, share_affiliation_others, wish_werent_fan, likely_support_2017 had uneven distributions and likely to have small sample sizes for certain categories if split up

**Concluding Questions/Comments on Corporate Partner Variables**

+ small sample size for purchases of these products in last six months for:

  - bought_carter_sub
  - bought_becu
  - bought_chihuly_studio
  - bought_hardrock_cafe
  - bought_health_warrior
  - bought_hyatt_house
  - bought_kraken_congee

+ all consideration variables looked to have good sample sizes

+ likely_buy_sponsor variable has good sample sizes for each category

+ bought_msft, bought_pepsi had good sample sizes for each category

**Concluding Questions/Comments on Demographic Variables**

+ Player_fan, hope_solo_fan had good distribution of observation counts for each category

+ sexorient, education, income, real_fan, coach_fan, provide_escape, team_wins_more, provides_excitement, team_plays_aggress, provides_social_interaction, provides_role_models may all have small sample sizes if observations are split up 

+ race, pro_women_soccer_fan, and players_are_skilled  had very uneven distributions of observations likely to have categories with small sample sizes when split up  

**Concluding Questions/Comments on Quantitative Variables**

+ use median rather than mean for all quantitative variables
  

# Base EDA Step 2: Univariate Graphical Analysis

## Categorical Variables

```{r}
sea_reign %>%
	plot_bar(nrow = 2L,
  ncol = 1L)
```

**Comments:**

  - Interest: confirms low number of observations for die-hard, low level, and hardly interested
  - ever_attend_match: confirms low number of observations for 0
  - att_game_with_family: confirms good number of observations for both categories
  - att_game_with_friends: confirms good number of observations for both categories
  - att_game_with_assoc: confirms low number of observations for 1
  - att_game_with_self: confirms good number of observations for both categories
  - transportation_method: confirms low number of observations for walk, bike, rideshare, other
  - attend_match_2016: confirms potentially low number of observations for 0
  - intend_season_ticket: confirms good number of observations for both categories
  - intend_5_match_pack: confirms low number of observations for 1
  - intend_3_match_pack: confirms low number of observations for 1
  - intend_single_ticket: confirms good number of observations for both categories
  - intend_pitchside_table: confirms low number of observations for 1
  - intend_undecided_ticekt: confirms potentially low number of observations for 1
  - prefer_short_sleeve_shirts: confirms good number of observations for both categories
  - prefer_long_sleeve_shirts: confirms good number of observations for both categories
  - prefer_jackets: confirms good number of observations for both categories
  - prefer_accessories: confirms good number of observations for both categories
  - likely_follow_2017: confirms low number of observations for 0
  - bought_carter_sub: confirms low number of observations for 1
  - bought_msft: confirms good number of observations for both categories
  - bought_pepsi: confirms good number of observations for both caregories
  - bought_becu: confirms good number of observatiosn for both categories
  - bought_chihuly_studio: confirms low number of observations for 1
  - bought_hardrock_cafe: confirms low number of observations for 1
  - bought_health_warrior: confirms low number of observations for 1
  - bought_hyatt_house: confirms low number of observations for 1
  - bought_kraken_congee: confirms low number of observations for 1
  - bought_ruffneck_scarves: confirms good number of observations for both categories
  - likely_buy_sponsor: confirms good number of observations for all categories (might have too few for disagree when split up)
  - gender: confirms good distribution of observations for both categories
  - sex_orient: confirms low number of observations for bisexual, prefer not to answer, and other 
  - race: confirms low number of observations for any race other than white
  - education: confirms low number of observations for high school graduate and other
  - income: confirms low number of observations for 300,000 or above and below 20,000 income groups. potentially low number of observations for 200,000 to 299,999 as well
  - marriage_status: good number of observations for married and single groups, other has too few observations
  - most_ideal_time: highest number of observations for Sunday Evenings low number of observations for other categories (expected due to how this variable was created)
  
## Quantative Variables

```{r}
sea_reign %>%
	plot_histogram(nrow = 3L,
  ncol = 1L)
```

   - first_attend_match: confirms slightly skewed distribution.
   - num_matches_attend_2016: confirms skewed distribution. low number of observations for 7,8,9, and 12 matches
   - intended_num_matches_attend_2017: confirms skewed distribution. low number of observations for 7, 9, 11, and more than 12 matches
   - website_visits: confirms skewed distribution. low number of observations for 4 visits
   - facebook_visits: confirms skewed distribution. low number of observations for 4 and 6 visits
   - twitter_visits: confirms skewed distribution. low number of observations for 3,4, 8 and 9 visits
   - instagram_visits: confirms skewed distribution. low number of observations for 2,3, and 4 visits
   - youtube_visits: confirms skewed distribution. low number of observations for 4 and 5 bisits
   - num_read_about_team_newspaper_digital_media: confirms skewed distribution. low number of observations for 4
   - num_watch_team_tv: confirms skewed distribution. low number of observations for anythign greater than 5
   - spend_2016: confirms skewed distribution
   - age: confirms skewed distribution.  low number of observations for less than 20 and greater than 60
   - hh_occupants: confirms skewed distribution. 
   - children: confirms skewed distribution. low number of observations for greater than 3
   - distance_traveled: confirms skewed distribution. Anything greater than 40 appears to be an outlier
   - wom_friends_influence: confirms skewed distribution. low number of observations for -1 and -2
   - wom_family_influence: confirms skewed distribution. low number of observations for -1
   - wom_acquaintances_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - newspaper_ads_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - billboard_ads_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - radio_ads_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - media_publicity_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - internet_ads_influence: confirm skewed distribution. low number of observations for -1, and -2 
   - email_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - facebook_post_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - twitter_post_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - theme_night_influence: confirm skewed distribution. low number of observations for -1, -2, -3, and 2, 3
   - halftime_events_influence: confirm skewed distribution. low number of observations for -1, -2 -3, 2, and 3
   - pre_match_events_influence: confirm skewed distribution. low number of observations for -1, -2, -3 and 3
   - post_match_events_influence: confirm skewed distribution. low number of observations for -1, -2, -3 and 3
   - ticket_promo_discount_influence: confirm skewed distribution. low number of observations for -1, -2 and -3
   - travel_distance_influence: confirm skewed distribution. low number of observations for -1, -2 and -3 as well as 1, and 2
   - traffic_to_stadium_influence: confirms skewed distribution, low number of observations for anything other than 0
   - parking_at_stadium_influence: confirms skewed distribution, low number of observations for anything other than 0
   - attend_2017: confirms skewed distribution, low number of observations for anything less than 2
   - reserved_seating: confirms skewed distribution, appears to have good number of observations for group
   - want_more_emails: confirms skewed distribution. low number of observations for -3 and 3
   - want_watch_more_televised_matches: confirms skewed distribution. low number of observations for less than 3
   - merch_price_satisfaction: confirms skewed distribution. low number of observations for less than 3
   - merch_variety_satisfaction: confirms skewed distribution. low number of observations for less than 3
   - merch_quality_satisfaction: confirms skewed distribution. low number of observations for less than 4
   - merch_wait_time_satisfaction: confirms skewed distribution. low number of observations for less than 3
   - merch_retail_convenience_satisfaction: confirms skewed distribution. low number of observations for less than 4
   - merch_staff_satisfaction: confirms skewed distribution. low number of observations for less than 4
   - merch_price_importance: confirms skewed distribution. low number of observations for less than 4
   - merch_variety_importance: confirms skewed distribution. low number of observations for less than 4
   - merch_quality_importance: confirms skewed distribution. low number of observations for less than 4
   - merch_wait_time_importance: confirms skewed distribution. low number of observations for less than 4
   - merch_retail_convenience_importance: confirms skewed distribution. low number of observations for less than 4
   - merch_staff_importance: confirms skewed distribution. low number of observations for less than 4
   - season_outcome: confirms skewed distribution. low number of observations for -3 and 3
   - season_performance: confirms skewed distribution. low number of observations for -1, and -2
   - overall_match_day_experience: confirms skewed distribution. low number of observations for less than 5
   - overall_memorial_stadium_experience: confirms skewed distribution. low number of observations for  1
   - arena_staff_friendliness: confirms skewed distribution. low number of observations for less than 5
   - autograph_opportunities: confirms skewed distribution. low number of observations for less than 4
   - arena_security: confirms skewed distribution. low number of observations for less than 4
   - entering_stadium: confirms skewed distribution. low number of observations for less than 5
   - happy_about_2016_season: confirms skewed distribution. low number of observations for -1 and -2
   - disappointed_with_2016_season: confirms skewed distribution. low number of observations for 3
   - share_affiliation_others: confirms skewed distribution. low number of observations for less than 0
   - wish_werent_fan: confirms skewed distribution. low number of observations for greater than -2
   - likely_support_2017: confirms skewed distribution. low number of observations for less than 2
   - consider_carter_sub: confirms skewed distribution. 
   - consider_msft: confirms skewed distribution. 
   - consider_pepsi: confirms skewed distribution. 
   - consider_becu: confirms skewed distribution. 
   - consider_chihuly_studio: confirms skewed distribution. 
   - consider_hardrock_cafe: confirms skewed distribution. 
   - consider_health_warrior: confirms skewed distribution. 
   - consider_hyatt_house: confirms skewed distribution. 
   - consider_kraken_congee: confirms skewed distribution. 
   - consider_ruffneck_scarves: confirms skewed distribution. 
   - real_fan: confirms skewed distribution. low number of observations less than 0
   - player_fan: confirms skewed distribution.  low number of observations for 3
   - coach_fan: confirms skewed distribution. low number of observations less than 0
   - hope_solo_fan: confirms skewed distribution. 
   - pro_women_soccer_fan: confirms skewed distribution. low number of observations less than 0
   - provide_escape: confirms skewed distribution. low number of observations less than 0
   - players_are_skilled: confirms skewed distribution. low number of observations less than 1
   - team_wins_more: confirms skewed distribution. low number of observations less than 0
   - provides_excitement: confirms skewed distribution. low number of observations less than 1
   - team_plays_aggress: confirms skewed distribution. low number of observations less than 0
   - provides_social_interaction: confirms skewed distribution. low number of observations less than 0
   - provides_role_models: confirms skewed distribution. low number of observations less than 0
   - prefer_lumen_staidum: confirms skewed distribution
   - prefer_starfire_staidum: confirms skewed distribution
   - tickets_easy_get: confirms skewed distribution. low number of observations less than 0
   - support_kneeling: confirms skewed distribution. low number of observations -1, -2 and 1
   - match_cost_inexpensive: confirms skewed distribution. low number of observations less than 0
   - family_not_interested: confirms skewed distribution. low number of observations greater than 2
   - sig_other_not_interested: confirms skewed distribution. low number of observations greater than 0
   - friends_not_interested: confirms skewed distribution. low number of observations greater than 2
   - womans_national_team_fan: confirms skewed distribution. low number of observations less than 0
   - feel_part_of_community_fan: confirms skewed distribution. low number of observations less than 0
   - provides_learning_opp: confirms skewed distribution. low number of observations less than -1
   - support_woman_sport: confirms skewed distribution. low number of observations less than 2
   - concession_offering: confirms skewed distribution.
   - concession_food_price: confirms skewed distribution.
   - concession_food_quality: confirms skewed distribution.
   - concession_food_wait_time: confirms skewed distribution.
   - concession_drink_wait_time: confirms skewed distribution.
   - concession_location: confirms skewed distribution.
   - beergarden_locations: confirms skewed distribution.
   - concession_food_variety: confirms skewed distribution.
   - consession_staff: confirms skewed distribution. low number of observations 1,2,3, and 4
   - concession_drink_price: confirms skewed distribution.
   - concession_drink_variety: confirms skewed distribution.
   - beer_garden: confirms skewed distribution. low number of observations 1,2,3, and 4
   - food_truck_service_quality:confirms skewed distribution. low number of observations 1,2,3, and 4
   - food_truck_food_drink_quality: confirms skewed distribution. low number of observations 1,2,3, and 4
   - cleanliness: confirms skewed distribution
   
# Base EDA Step 2: Questions/Comments 

+ do these distributions appear normal / is this sample representative of the population of match attendees

+ do ticket types accurately reflect the distribution of sales for each type of ticket?

+ types of media platform visits where observations have a median of 0 visits could be useful for uncovering what type of person does engage with that type of media. 

  - such as facebook_visits - median number of weekly facebook visits across all observations is zero, but the upper quartile limit ranges up to two visits per week. there appears to be less observations for visits greater than 0 but there might be a large enough sample size for those different numbers of visits to unconver some signficant finding


# Base EDA Step 3: Multi-Variate Non-Graphical EDA

## Categorical Variables

### Attendance Variable Interactions

#### Variable of interest: ever_attend_match 

```{r}
attendance_interactions <- sea_reign %>%
  select(is.factor) %>%
  tableby(ever_attend_match ~ ., data = .) %>%
  summary(digits = 1, text=TRUE) 
```

`r  kbl(attendance_interactions) %>% kable_minimal(full_width = F, position = "left") `

**Comments:**

  - who in this survey responded as a die hard fan, but has never attended a match? 
      - I know its subjective, but those responses are contradictory
      
  - more attendees have attended with their family and friends than never attending with family and friends
  - most attendies have not attended a game with associates or by themselves
  - most attendees drive a personal car to get to the gaems
  - most attendees did attend a match in 2016
  - most attendees do not plan on using season tickets to attend games next year
  - most attendees do not plan on using 5 match pack tickets to attend games next year
  - most attendees do not plan on using 3 match pack tickets to attend games next year
  - most attendees do not plan on using single tickets to attend games next year
  - most attendees do not plan on using pitchside table tickets to attend games next year
  - most attendees are not undecided on the type of ticket they plan on using 
      - this is weird and should be looked into further
  - most attendees prefer short sleeve shirts
  - most attendees do not prefer long sleeve shirts
  - most attendees do not prefer jackets
  - most attendees do not prefer accessories
  - most attendees will likely follow the team in 2017
  - most attendees did not buy carter sub, microsoft, becu, chihuly studio, hardrock cafe, health warrior, hyatt house, kracken congee or ruffneck scarves in the past 6 months
  - most attendees have bought pepsi products in the past 6 moths
  - most attendees said they would be likely to purchase goods or services from sponsors of Seattle Reign FC than
similar non-sponsors
  - most attendees are women
  - most attendees are heterosexual
  - most attendees are white
  - most attendees are college graduates
  - most attendees earn an income of 100,000 - 149,000
  - most attendees are married
  - most attendees stated Sunday Evenings would be the most ideal match time

#### Secondary variable of interest: intend_season_ticket 

```{r}
attendance_interactions_2 <- sea_reign %>%
  select(is.factor) %>%
  tableby(intend_season_ticket ~ ., data = .) %>%
  summary(digits = 1, text=TRUE) 
```

`r  kbl(attendance_interactions_2) %>% kable_minimal(full_width = F, position = "left") `
  
**Comments:**

Most respondents who indicated that they plan on buying season tickets...

  - are loyal fans
  - have attended a match before
  - attend matches with family, friends
  - use a personal car to arrive at stadium
  - attended a match in 2016
  - prefer short sleeve products, prefer long sleeve products, prefer jackets, and prefer accessories, 
  - are likely to follow team in 2017
  - are female
  - are heterosexual
  - are white
  - are college graduates
  - earn an income of 100,000 - 149,000
  - are married
  - prefer sunday evenings as the ideal game time
  
### Corporate Sponsor Variable Interactions

#### Variable of interest:  likely_buy_sponsor

```{r}
sponsor_interactions<- sea_reign %>%
  select(is.factor) %>%
  tableby(likely_buy_sponsor ~ ., data = .) %>%
  summary(digits = 1, text=TRUE) 
```

`r  kbl(sponsor_interactions) %>% kable_minimal(full_width = F, position = "left") `

**Comments:**

Most respondents who indicated that they are likely to buy sponsor products...

  - are loyal fans
  - have attended matches
  - have attended matches with family and friends
  - have not attended matches with busienss associates or by themselves
  - use a car to get to the matches
  - attended matches in 2016
  - do not plan on buying season tickets, 5 match pack, 3 match pack, single match or pitchside table tickets
  - prefer short sleeve shirts
  - are likely to follow the team in 2017
  - have bought microsoft and pepsi products
  - are female
  - are heterosexual
  - are white
  - are college graduates
  - earn between 1000,000 and 149,000
  - are married
  - prefer sunday evenings as the ideal game time
  
### Brand Attitude variable interactions

#### Variable of interest: likely_follow_2017

```{r}
attitude_interactions<- sea_reign %>%
  select(is.factor) %>%
  tableby(likely_follow_2017 ~ ., data = .) %>%
  summary(digits = 1, text=TRUE) 
```

`r  kbl(attitude_interactions) %>% kable_minimal(full_width = F, position = "left") `

**Comments:**

Most respondents who indicated that they are likely to follow the team in 2017...

  - are loyal fans
  - have attended a match before
  - have attended matches with family and friends
  - have not attended matches with business associates or by themselves
  - use their personal car to get to the matches
  - attended a match last year
  - they have no intended ticket type for next year
  - prefer short sleeve products
  - have not bought any sponsor products in the past 6 months
  - are female
  - are heterosexual
  - white
  - are college graduates
  - earn between 1000,000 and 149,000
  - are married
  - prefer sunday evenings
  
  
## Quantative variables

### Correlation Table

```{r}
# create correlation matrix
correlation_matrix <- sea_reign %>%
  drop_na() %>%
  select(is.numeric) %>%
  cor() %>%
  round(2) 

correlations <- sea_reign %>%
  select(is.numeric, is.integer) %>%
  inspect_cor()
```

#### intended_num_matches_attend_2017 variable correlations

```{r}
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")

attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")

attendance_correlations <- bind_rows(attendance_positive_correlations,attendance_negative_correlations )
```

`r  kbl(attendance_correlations) %>% kable_minimal(full_width = F, position = "left") `
  
#### website_visits variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "website_visits" | col_2 == "website_visits")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "website_visits" | col_2 == "website_visits")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `
  
#### facebook_visits variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "facebook_visits" | col_2 == "facebook_visits")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "facebook_visits" | col_2 == "facebook_visits")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### twitter_visits variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "twitter_visits" | col_2 == "twitter_visits")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "twitter_visits" | col_2 == "twitter_visits")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### instagram_visits variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "instagram_visits" | col_2 == "instagram_visits")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "instagram_visits" | col_2 == "instagram_visits")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### youtube_visits variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "youtube_visits" | col_2 == "youtube_visits")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "youtube_visits" | col_2 == "youtube_visits")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### want_more_emails variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "want_more_emails" | col_2 == "want_more_emails")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "want_more_emails" | col_2 == "want_more_emails")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### intend_buy_merch variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### spend_2016 variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "spend_2016" | col_2 == "spend_2016")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "spend_2016" | col_2 == "spend_2016")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### season_outcome variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "season_outcome" | col_2 == "season_outcome")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "season_outcome" | col_2 == "season_outcome")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### season_performance variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "season_performance" | col_2 == "season_performance")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "season_performance" | col_2 == "season_performance")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

#### overall_match_day_experience variable correlations

```{r}
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")

negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")

var_correlations <- bind_rows(positive_correlations, negative_correlations )
```

`r  kbl(var_correlations) %>% kable_minimal(full_width = F, position = "left") `

# Base EDA Step 3: Questions/Comments 

- do correlations indicate a relationship?


# Base EDA Step 4: Multi-Variate Graphical EDA

## Categorical Variables

### Attendance Variable Interactions

#### Variable of interest: ever_attend_match 

```{r}
sea_reign %>%
	plot_bar(by = "ever_attend_match", by_position = "dodge", nrow = 2, ncol = 1)
```

#### Secondary variable of interest: intend_season_ticket 

```{r}
sea_reign %>%
	plot_bar(by = "intend_season_ticket", by_position = "dodge", nrow = 2, ncol = 1)
```

### Corporate Sponsor Variable Interactions

#### Variable of interest:  likely_buy_sponsor

```{r}
sea_reign %>%
	plot_bar(by = "likely_buy_sponsor", by_position = "dodge", nrow = 2, ncol = 1)
```

### Brand Attitude variable interactions

#### Variable of interest: likely_follow_2017

```{r}
sea_reign %>%
	plot_bar(by = "likely_follow_2017", by_position = "dodge", nrow = 2, ncol = 1)
```

## Quantatitive Variables

```{r}
# set up colors
fill_color <- "#4271AE"
line_color <- "#1F3552"
```


### Attendance Variables: intended_num_matches_attend_2017

#### intended_num_matches_attend_2017 and	num_matches_attend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, group = num_matches_attend_2016, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent


#### attend_2017 & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = attend_2017, group = attend_2017, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = attend_2017, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - there seems to be a positive relationship 
  - trend appears consistent

#### real_fan & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### likely_support_2017 & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = likely_support_2017, group = likely_support_2017, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = likely_support_2017, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### share_affiliation_others & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### spend_2016 & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = spend_2016, group = spend_2016, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = spend_2016, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not seem to be consistent
  
#### intend_buy_merch & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = intend_buy_merch, group = intend_buy_merch, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not seem consistent
  
#### coach_fan & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### feel_part_of_community_fan & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = feel_part_of_community_fan, group = feel_part_of_community_fan, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = feel_part_of_community_fan, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not seem consistent
  
#### consider_health_warrior & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_health_warrior, group = consider_health_warrior, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_health_warrior, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not seem consistent
  
#### merch_staff_satisfaction & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, group = merch_staff_satisfaction, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### consider_kraken_congee & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, group = consider_kraken_congee, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not seem consistent
  
#### tickets_easy_get & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
 
  ggplot(mapping = aes(x = tickets_easy_get, group = tickets_easy_get, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = tickets_easy_get, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### players_are_skilled & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, group = players_are_skilled, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### prefer_starfire_staidum & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = prefer_starfire_staidum, group = prefer_starfire_staidum, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = prefer_starfire_staidum, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend doesn't appear to be consistent
  
#### wish_werent_fan & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = wish_werent_fan, group = wish_werent_fan, y = intended_num_matches_attend_2017)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = wish_werent_fan, y = intended_num_matches_attend_2017)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend does not appear consistent

### Media Variables: website_visits

#### want_more_emails & website_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, group = want_more_emails, y = website_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, y = website_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### youtube_visits	& website_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, group = youtube_visits, y = website_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, y = website_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### num_read_about_team_newspaper_digital_media & website_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_read_about_team_newspaper_digital_media, group = num_read_about_team_newspaper_digital_media, y = website_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_read_about_team_newspaper_digital_media, y = website_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent

### Media Variables: facebook_visits

#### facebook_visits & facebook_post_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = facebook_post_influence, group = facebook_post_influence, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = facebook_post_influence, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### share_affiliation_others & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend apperars consistent
  
#### real_fan & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### intend_buy_merch & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, group = intend_buy_merch, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### coach_fan & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### facebook_visits & internet_ads_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = internet_ads_influence, group = internet_ads_influence, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = internet_ads_influence, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, group = youtube_visits, y = facebook_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, y = facebook_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  


### Media Variables: twitter_visits

#### twitter_visits & twitter_post_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, group = twitter_post_influence, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### coach_fan & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, group = youtube_visits, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = youtube_visits, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### consider_kraken_congee & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, group = consider_kraken_congee, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### real_fan & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### twitter_visits & num_matches_attend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, group = num_matches_attend_2016, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### age & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = age, group = age, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = age, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend does not appear consistent
  
#### prefer_starfire_staidum & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = prefer_starfire_staidum, group = prefer_starfire_staidum, y = twitter_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = prefer_starfire_staidum, y = twitter_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend does not appear consistent
  

### Media Variables: instagram_visits

#### instagram_visits & twitter_post_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, group = twitter_post_influence, y = instagram_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, y = instagram_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### coach_fan & instagram_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = instagram_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = instagram_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### age & instagram_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = age, group = age, y = instagram_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = age, y = instagram_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend does not appear consistent
  

### Media Variables: youtube_visits

#### coach_fan & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### youtube_visits & twitter_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = twitter_visits, group = twitter_visits, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = twitter_visits, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### real_fan & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & twitter_post_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, group = twitter_post_influence, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = twitter_post_influence, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & num_matches_attend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, group = num_matches_attend_2016, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### want_more_emails & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, group = want_more_emails, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & website_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = website_visits, group = website_visits, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = website_visits, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### num_read_about_team_newspaper_digital_media & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_read_about_team_newspaper_digital_media, group = num_read_about_team_newspaper_digital_media, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_read_about_team_newspaper_digital_media, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### hope_solo_fan & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = hope_solo_fan, group = hope_solo_fan, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = hope_solo_fan, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provide_escape & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provide_escape, group = provide_escape, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provide_escape, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_excitement & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, group = provides_excitement, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### youtube_visits & facebook_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = facebook_visits, group = facebook_visits, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = facebook_visits, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### share_affiliation_others & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  

### Media Variables: want_more_emails

#### want_more_emails & email_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = email_influence, group = email_influence, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = email_influence, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### provides_learning_opp & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_learning_opp, group = provides_learning_opp, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_learning_opp, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### overall_match_day_experience & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, group = overall_match_day_experience, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### share_affiliation_others & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### real_fan & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### intend_buy_merch & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, group = intend_buy_merch, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### want_more_emails & website_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, group = want_more_emails, y = website_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, y = website_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### want_more_emails & youtube_visits

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, group = want_more_emails, y = youtube_visits)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, y = youtube_visits)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### entering_stadium & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, group = entering_stadium, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_excitement & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, group = provides_excitement, y = want_more_emails)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, y = want_more_emails)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  


### Merch Variables: intend_buy_merch

#### share_affiliation_others & intend_buy_merch


```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### likely_support_2017 & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = likely_support_2017, group = likely_support_2017, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = likely_support_2017, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appear consistent
  
#### intend_buy_merch & merch_staff_satisfaction

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, group = merch_staff_satisfaction, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### real_fan & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### players_are_skilled & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, group = players_are_skilled, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### coach_fan & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### consider_ruffneck_scarves & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_ruffneck_scarves, group = consider_ruffneck_scarves, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_ruffneck_scarves, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### intend_buy_merch & spend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = spend_2016, group = spend_2016, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = spend_2016, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent

#### consider_kraken_congee & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, group = consider_kraken_congee, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_kraken_congee, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_excitement & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, group = provides_excitement, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### intend_buy_merch & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = intended_num_matches_attend_2017, group = intended_num_matches_attend_2017, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intended_num_matches_attend_2017, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### intend_buy_merch & merch_quality_satisfaction

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = merch_quality_satisfaction, group = merch_quality_satisfaction, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = merch_quality_satisfaction, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### entering_stadium & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, group = entering_stadium, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### support_woman_sport & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = support_woman_sport, group = support_woman_sport, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = support_woman_sport, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### support_kneeling & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = support_kneeling, group = support_kneeling, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = support_kneeling, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### intend_buy_merch & pre_match_events_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = pre_match_events_influence, group = pre_match_events_influence, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = pre_match_events_influence, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### provides_role_models & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, group = provides_role_models, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### autograph_opportunities & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = autograph_opportunities, group = autograph_opportunities, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = autograph_opportunities, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### intend_buy_merch & want_more_emails

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, group = want_more_emails, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = want_more_emails, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### consider_health_warrior & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = consider_health_warrior, group = consider_health_warrior, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = consider_health_warrior, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### overall_match_day_experience & intend_buy_merch

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, group = overall_match_day_experience, y = intend_buy_merch)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, y = intend_buy_merch)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  

### Merch Variables: spend_2016

#### spend_2016 & num_matches_attend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, group = num_matches_attend_2016, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = num_matches_attend_2016, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### intend_buy_merch & spend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, group = intend_buy_merch, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intend_buy_merch, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### spend_2016 & intended_num_matches_attend_2017

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = intended_num_matches_attend_2017, group = intended_num_matches_attend_2017, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = intended_num_matches_attend_2017, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### spend_2016 & merch_staff_satisfaction

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, group = merch_staff_satisfaction, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = merch_staff_satisfaction, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### real_fan & spend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, group = real_fan, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = real_fan, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### spend_2016 & post_match_events_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = post_match_events_influence, group = post_match_events_influence, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = post_match_events_influence, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### spend_2016 & pre_match_events_influence

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = pre_match_events_influence, group = pre_match_events_influence, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = pre_match_events_influence, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### coach_fan & spend_2016

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, group = coach_fan, y = spend_2016)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = coach_fan, y = spend_2016)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  

### Satisfaction Variables: season_outcome

#### happy_about_2016_season & season_outcome

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = happy_about_2016_season, group = happy_about_2016_season, y = season_outcome)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = happy_about_2016_season, y = season_outcome)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### season_performance & season_outcome

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = season_performance, group = season_performance, y = season_outcome)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = season_performance, y = season_outcome)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### disappointed_with_2016_season & season_outcome

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = disappointed_with_2016_season, group = disappointed_with_2016_season, y = season_outcome)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = disappointed_with_2016_season, y = season_outcome)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a negative relationship
  - trend appears consistent
  

### Satisfaction Variables: season_performance

#### happy_about_2016_season & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = happy_about_2016_season, group = happy_about_2016_season, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = happy_about_2016_season, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### season_performance & season_outcome

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = season_outcome, group = season_outcome, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = season_outcome, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_excitement & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, group = provides_excitement, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### players_are_skilled & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, group = players_are_skilled, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = players_are_skilled, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### overall_match_day_experience & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, group = overall_match_day_experience, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = overall_match_day_experience, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### share_affiliation_others & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, group = share_affiliation_others, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = share_affiliation_others, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### season_performance & merch_price_satisfaction

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = merch_price_satisfaction, group = merch_price_satisfaction, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = merch_price_satisfaction, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_role_models & season_performance

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, group = provides_role_models, y = season_performance)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, y = season_performance)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  


### Satisfaction Variables: overall_match_day_experience

#### overall_memorial_stadium_experience & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = overall_memorial_stadium_experience, group = overall_memorial_stadium_experience, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = overall_memorial_stadium_experience, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### arena_staff_friendliness & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = arena_staff_friendliness, group = arena_staff_friendliness, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = arena_staff_friendliness, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### entering_stadium & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, group = entering_stadium, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = entering_stadium, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_role_models & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, group = provides_role_models, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_role_models, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### likely_support_2017 & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = likely_support_2017, group = likely_support_2017, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = likely_support_2017, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend does not appears consistent
  
#### tickets_easy_get & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = tickets_easy_get, group = tickets_easy_get, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = tickets_easy_get, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### provides_excitement & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, group = provides_excitement, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = provides_excitement, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### arena_security & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = arena_security, group = arena_security, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = arena_security, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent
  
#### support_woman_sport & overall_match_day_experience

```{r}
# create box plot
box <-  sea_reign %>% 
  ggplot(mapping = aes(x = support_woman_sport, group = support_woman_sport, y = overall_match_day_experience)) +
  geom_boxplot(fill = fill_color, colour = line_color)

# create box plot
scatter <- sea_reign %>% 
  ggplot(mapping = aes(x = support_woman_sport, y = overall_match_day_experience)) +
  geom_point() +
  geom_smooth(method = "lm")

# output
box + scatter
```

**Comments:**

  - appears to be a positive relationship
  - trend appears consistent


## Categorical and Quantatitive together

ExpNumViz(Carseats,target="Price",nlim=4,scatter=FALSE,fname=NULL,col="green",Page=c(2,2),sample=8)
plot3[[1]]

### Attendance variables

#### Variable of interest: intended_num_matches_attend_2017

```{r}
attendance <- sea_reign$intended_num_matches_attend_2017

dummy_df <- sea_reign %>%
  select(-intended_num_matches_attend_2017) %>%
  dummify()

dummy_df <- cbind(dummy_df, attendance)

dummy_df <- dummy_df %>%
  mutate(across(where(is.integer), as.numeric))

dummy_df %>%
  #drop_na() %>%
  plot_boxplot( by = "attendance")
```

#### Variable of interest: attend_2017

```{r}
sea_reign %>%
  filter(is.na(attend_2017) == FALSE) %>%
  mutate(attend_2017 = factor(attend_2017)) %>%
  ExpNumViz( target = "attend_2017", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")

```

#### Variable of interest: ever_attend_match

```{r}
sea_reign %>%
  filter(is.na(ever_attend_match) == FALSE) %>%
  mutate(ever_attend_match = factor(ever_attend_match)) %>%
  ExpNumViz( target = "ever_attend_match", type = 2, nlim = 2, col = c("pink"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: intend_season_ticket

```{r}
sea_reign %>%
  filter(is.na(intend_season_ticket) == FALSE) %>%
  ExpNumViz( target = "intend_season_ticket", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

### Media variables

#### Variable of interest: website_visits

```{r}
sea_reign %>%
  filter(is.na(website_visits) == FALSE) %>%
  mutate(website_visits = factor(website_visits)) %>%
  ExpNumViz( target = "website_visits", type = 2, nlim = 2,col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: facebook_visits

```{r}
sea_reign %>%
  filter(is.na(facebook_visits) == FALSE) %>%
  mutate(facebook_visits = factor(facebook_visits)) %>%
  ExpNumViz( target = "facebook_visits", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: twitter_visits

```{r}
sea_reign %>%
  filter(is.na(twitter_visits) == FALSE) %>%
  mutate(twitter_visits = factor(twitter_visits)) %>%
  ExpNumViz( target = "twitter_visits", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: instagram_visits

```{r}
sea_reign %>%
  filter(is.na(instagram_visits) == FALSE) %>%
  mutate(instagram_visits = factor(instagram_visits)) %>%
  ExpNumViz( target = "instagram_visits", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: youtube_visits

```{r}
sea_reign %>%
  filter(is.na(youtube_visits) == FALSE) %>%
  mutate(youtube_visits = factor(youtube_visits)) %>%
  ExpNumViz( target = "youtube_visits", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: num_read_about_team_newspaper_digital_media

```{r}
sea_reign %>%
  filter(is.na(num_read_about_team_newspaper_digital_media) == FALSE) %>%
  mutate(num_read_about_team_newspaper_digital_media = factor(num_read_about_team_newspaper_digital_media)) %>%
  ExpNumViz( target = "num_read_about_team_newspaper_digital_media", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```


#### Variable of interest: want_more_emails

```{r}
sea_reign %>%
  filter(is.na(want_more_emails) == FALSE) %>%
  mutate(want_more_emails = factor(want_more_emails)) %>%
  ExpNumViz( target = "want_more_emails", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```


### Merch variables

#### Variable of interest: intend_buy_merch

```{r}
sea_reign %>%
  filter(is.na(intend_buy_merch) == FALSE) %>%
  mutate(intend_buy_merch = factor(intend_buy_merch)) %>%
  ExpNumViz( target = "intend_buy_merch", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

### Satisfaction variables

#### Outcome satisfaction variable of interest: season_outcome

```{r}
sea_reign %>%
  filter(is.na(season_outcome) == FALSE) %>%
  mutate(season_outcome = factor(season_outcome)) %>%
  ExpNumViz( target = "season_outcome", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Performance satisfaction variable of interest: season_performance

```{r}
sea_reign %>%
  filter(is.na(season_performance) == FALSE) %>%
  mutate(season_performance = factor(season_performance)) %>%
  ExpNumViz( target = "season_performance", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Matchday satisfaction variable of interest: overall_match_day_experience

```{r}
sea_reign %>%
  filter(is.na(overall_match_day_experience) == FALSE) %>%
  mutate(overall_match_day_experience = factor(overall_match_day_experience)) %>%
  ExpNumViz( target = "overall_match_day_experience", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

### Brand Attitude variables

#### Variable of interest: likely_support_2017

```{r}
sea_reign %>%
  filter(is.na(likely_support_2017) == FALSE) %>%
  mutate(likely_support_2017 = factor(likely_support_2017)) %>%
  ExpNumViz( target = "likely_support_2017", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

#### Variable of interest: happy_about_2016_season

```{r}
sea_reign %>%
  filter(is.na(happy_about_2016_season) == FALSE) %>%
  mutate(happy_about_2016_season = factor(happy_about_2016_season)) %>%
  ExpNumViz( target = "happy_about_2016_season", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```


#### Variable of interest: disappointed_with_2016_season

```{r}
sea_reign %>%
  filter(is.na(disappointed_with_2016_season) == FALSE) %>%
  mutate(disappointed_with_2016_season = factor(disappointed_with_2016_season)) %>%
  ExpNumViz( target = "disappointed_with_2016_season", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```

### Corporate Partner variables

#### Variable of interest: likely_buy_sponsor

```{r}
sea_reign %>%
  filter(is.na(likely_buy_sponsor) == FALSE) %>%
  mutate(likely_buy_sponsor = factor(likely_buy_sponsor)) %>%
  ExpNumViz( target = "likely_buy_sponsor", type = 2, nlim = 2, col = c("pink", "orange", "green", "red", "yellow", "blue", "magenta"), Page = NULL, sample = NULL, scatter = FALSE, gtitle = "Box plot: ")
```


# Detailed EDA

### Questions to be answered outside the data

+ do these distributions appear normal / is this sample representative of the population of match attendees

+ do ticket types accurately reflect the distribution of sales for each type of ticket?

+ can we get a larger sample size

+ can we get more comprehensive data about the staidum, team, merchandise - max. staidum capacity, ticket type costs, number of matches per season, product sales data, performance records for the team

+ what population was this sample taken from?

  - there's a lot of support and past match attendees in the sample, which is good since thats our target audience, but I am just curious about how representative this audience is of Seattle Reign attendees compared with sports event attendees overall

+ Interaction analysis confirms low observation counts of previously discussed categories of the variables (even for peak variable of interest categories in some cases) 

  - is it possible to get a larger sample size

### Primary questions to answer with this analysis

+ Determine the primary factors that impact attendance intentions, media consumption intentions, and merchandise consumption intention.

  - make specific recommendations and communicate what should be done to achieve

+ Determine the factors that impact satisfaction (Performance, Outcome, Matchday Satisfaction).

  - make specific recommendations and communicate what should be done to achieve

+ Determine ways to increase brand attitude.

  - make specific recommendations and communicate what should be done to achieve

+ Investigate purchasing habits of corporate partner products.

  - make specific recommendations and communicate what should be done to achieve

+ Investigate ways to improve Matchday experience.

  - make specific recommendations and communicate what should be done to achieve

+ Identify viable market segments.

  - make specific recommendations and communicate what should be done to achieve
  
  
# Determine factors that impact attendance intentions

Variables of interest:

  - intended_num_matches_attend_2017
  - attend_2017
  - ever_attend_match
  - intend_season_ticket
  

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")
# create table of correlations
attendance_correlations_1 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)
```

`r  kbl(attendance_correlations_1) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with attend_2017
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "attend_2017" | col_2 == "attend_2017")
# find negative correlations less than -.2 with attend_2017
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "attend_2017" | col_2 == "attend_2017")
# create table of correlations
attendance_correlations_2 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)
```

`r  kbl(attendance_correlations_2) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with ever_attend_match
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "ever_attend_match" | col_2 == "ever_attend_match")
# find negative correlations less than -.2 with ever_attend_match
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "ever_attend_match" | col_2 == "ever_attend_match")
# create table of correlations
attendance_correlations_3 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)
```

`r  kbl(attendance_correlations_3) %>% kable_minimal(full_width = F, position = "left") `
  
```{r}
# find positive correlations greater than .2 with intend_season_ticket
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intend_season_ticket" | col_2 == "intend_season_ticket")
# find negative correlations less than -.2 with intend_season_ticket
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intend_season_ticket" | col_2 == "intend_season_ticket")
# create table of correlations
attendance_correlations_4 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)
```

`r  kbl(attendance_correlations_4) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# create vector of correlated variables
one <- c(attendance_correlations_1$col_1, attendance_correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(attendance_correlations_2$col_1, attendance_correlations_2$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of correlated variables
three <- c(attendance_correlations_3$col_1, attendance_correlations_3$col_2)
# drop duplicate variables
three <- unique(three)
# create vector of correlated variables
four <- c(attendance_correlations_4$col_1, attendance_correlations_4$col_2)
# drop duplicate variables
four <- unique(four)
# create vector of all correlations
all_together <- c(one, two, three, four)
# drop duplicate variables
variables <- unique(all_together)
```

+ create data set 

```{r}
# create df of variables correlated with attendance variables
attendance_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables)  %>%
  # drop Na's
  drop_na()
```

+ prepare data set

```{r}
# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId, IDteam1,Attend17,  Support1, BIRG1, Buymer1, IDcoach1, IDcomm2, Spnbuy7, Mersat25, Spnbuy9, Ticket1, Skill2, Starfir1, CORF1, lasttype, Interest, Matchsat, Spnbuy4, Income, Marital, Email1)

# mutate values
variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "Not at all likely to consider them when making a purchase decision 1", "definitely would not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "Extremely likely to consider them when making a purchase decision 7", "definitely would consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "2", "would not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "3", "might not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "6", "would consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "5", "might consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "4", "neutral"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "6", "Satisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "5", "Somewhat Satisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "4", "Neutral"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "3", "Somewhat Dissatisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "2", "Dissatisfied"))) 
#add columns to attendance data set
attendance <- left_join(attendance_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
attendance_df <- attendance %>%
  mutate(attend_2017 = Attend17,
         real_fan = IDteam1,
         likely_support_2017 = Support1,
         share_affiliation_others =	BIRG1,
         intend_buy_merch	= Buymer1,
         coach_fan = IDcoach1,
         feel_part_of_community_fan = IDcomm2,
         consider_health_warrior = Spnbuy7,
         merch_staff_satisfaction = Mersat25,
         consider_kraken_congee = Spnbuy9,
         tickets_easy_get =	Ticket1,
         players_are_skilled = Skill2,
         prefer_starfire_staidum = Starfir1,
         wish_werent_fan = CORF1,
         ticket_type_used_2016 = lasttype,
         interest	= Interest.y,
         overall_match_day_experience = Matchsat,
         consider_becu = Spnbuy4,
         income = Income,
         marriage_status = Marital,
         want_more_emails = Email1) %>%
  select(-c(Attend17, IDteam1, Support1, BIRG1, Buymer1, IDcoach1, IDcomm2, Spnbuy7, Mersat25, Spnbuy9, Ticket1, Skill2, Starfir1, CORF1, lasttype, Interest.x, Interest.y, Matchsat, Spnbuy4, Income, Marital, Email1)) %>%
  mutate(intend_season_ticket = 
          case_when(
            intend_season_ticket == 1 ~ "Yes",
            intend_season_ticket == 0 ~ "No"),
        prefer_jackets = 
          case_when(
            prefer_jackets == 1 ~ "Yes",
            prefer_jackets == 0 ~ "No"),
        prefer_short_sleeve_shirts = 
          case_when(
            prefer_short_sleeve_shirts == 1 ~ "Yes",
            prefer_short_sleeve_shirts == 0 ~ "No"),
        prefer_accessories = 
          case_when(
            prefer_accessories == 1 ~ "Yes",
            prefer_accessories == 0 ~ "No"),
        prefer_long_sleeve_shirts= 
          case_when(
            prefer_long_sleeve_shirts == 1 ~ "Yes",
            prefer_long_sleeve_shirts == 0 ~ "No"),
        intend_single_match = 
          case_when(
            intend_single_match == 1 ~ "Yes",
            intend_single_match == 0 ~ "No"),
        ever_attend_match = 
          case_when(
            ever_attend_match == 1 ~ "Yes",
            ever_attend_match == 0 ~ "No"),
        att_game_with_friends = 
          case_when(
            att_game_with_friends == 1 ~ "Yes",
            att_game_with_friends == 0 ~ "No"),
        att_game_with_family = 
          case_when(
            att_game_with_family == 1 ~ "Yes",
            att_game_with_family == 0 ~ "No")) %>%
    mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId, -attend_match_2016, -intend_undecided_ticket)

vtable(attendance_df)
```


### Analyze variables correlated with attendance

```{r}
# look at data types
attendance_df  %>%
	inspect_types() %>%
	show_plot()
```

#### Ticket types used in 2016 and attendance

```{r}
attendance_df %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not a large enough sample size for 3 Match Pack, unknown or Pitchside Table
  

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
intended <- attendance_df %>%
  filter(ticket_type_used_2016 != "I don't know", ticket_type_used_2016 != "3 Match Pack", ticket_type_used_2016 != "Pitchside Table") %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(ticket_type_used_2016, avg_num_matches_2017), y = avg_num_matches_2017, fill = ticket_type_used_2016 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches plan to attend in 2017", x = "Ticket type used in 2016")

last_year <- attendance_df %>%
  filter(ticket_type_used_2016 != "I don't know", ticket_type_used_2016 != "3 Match Pack", ticket_type_used_2016 != "Pitchside Table") %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(ticket_type_used_2016, avg_matches), y = avg_matches, fill = ticket_type_used_2016 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches Attended in 2016", x = "Ticket type used in 2016")

intended / last_year
```

  - as expected, ticket types impact the number of matches attended
  
#### intend single match and attendance
  
```{r}
attendance_df %>%
  group_by(intend_single_match) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - good sample sizes

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
intended <- attendance_df %>%
  group_by(intend_single_match) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_single_match, avg_num_matches_2017), y = avg_num_matches_2017, fill = intend_single_match )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches plan to attend in 2017", x = "Intend Single Match Ticket 2017")

last_year <- attendance_df %>%
  group_by(intend_single_match) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_single_match, avg_matches), y = avg_matches, fill = intend_single_match )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches Attended in 2016", x = "Intend Single Match Ticket 2017")

intended / last_year
```

  - odd result, but okay. not really sure what this is telling me other than people who intend to use single tickets attend less matches than those who do not intend to use single match tickets, which... duh?
  
#### intend season ticket and attendance

```{r}
attendance_df %>%
  group_by(intend_season_ticket) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - good sample sizes

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
intended <- attendance_df %>%
  group_by(intend_season_ticket) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_season_ticket, avg_num_matches_2017), y = avg_num_matches_2017, fill = intend_season_ticket )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches plan to attend in 2017", x = "Intend Season Ticket 2017")

last_year <- attendance_df %>%
  group_by(intend_season_ticket) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_season_ticket, avg_matches), y = avg_matches, fill = intend_season_ticket )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"), labels = c("3 Match Pack", "Single Match", "Seson Ticket", "Pitchside Table",  "5 Match Pack"))+
  labs(y = "Number of Matches Attended in 2016", x = "Intend Season Ticket 2017")

intended / last_year
```

  - Intending to buy Season tickets seems to increase attendance
  

#### Plans to attend and attendance

- not exactly sure what I plan to find here, but I'm going to investigate the correlation

```{r}
attendance_df %>%
  group_by(attend_2017) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not enough observations for strongly disagree, somewhat disagree, and disagree 
  
#### Real fan and attendance

```{r}
attendance_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not a large enough sample size for disagree and somewhat disagree

```{r}

intended <- attendance_df %>%
  filter(real_fan != "Somewhat disagree", real_fan != "Disagree") %>%
  group_by(real_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(real_fan, avg_num_matches_2017), y = avg_num_matches_2017, fill = real_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))+
  labs(y = "Number of Matches in 2017", x = "'Real Fan'")


attended <- attendance_df %>%
  filter(real_fan != "Somewhat disagree", real_fan != "Disagree") %>%
  group_by(real_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(real_fan, avg_matches), y = avg_matches, fill = real_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))+
  labs(y = "Number of Matches Attended in 2016", x = "'Real Fan'")


intended / attended

```

  - Real fan levels do not seem to have the expected impact on attendance, not a good indicator of attenance 
  - strongly disagree should have lower attendance than somewhat disagree, but it doesnt
  
#### Support for team and attendance

```{r}
attendance_df %>%
  group_by(likely_support_2017) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not a large enough sample size for disagree, neutral and Strongly disagree

```{r}
intended <- attendance_df %>%
  filter(likely_support_2017 != "Strongly Disagree", likely_support_2017 != "Disagree", likely_support_2017 != "Neutral") %>%
  group_by(likely_support_2017) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017, avg_num_matches_2017), y = avg_num_matches_2017, fill = likely_support_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


attended <- attendance_df %>%
  filter(likely_support_2017 != "Strongly Disagree", likely_support_2017 != "Disagree", likely_support_2017 != "Neutral") %>%
  group_by(likely_support_2017) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017, avg_matches), y = avg_matches, fill = likely_support_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


intended / attended
```

  - seems to have an impact on attendance, but likely not a big one
  
#### BIRG and attendance

```{r}
attendance_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - uneven, but decent distribution of observations

```{r}
intended <- attendance_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, avg_num_matches_2017), y = avg_num_matches_2017, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, avg_matches), y = avg_matches, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  - does not seem to be a good indicator of attendance

  
#### Merch intentions and attendance

```{r}
attendance_df %>%
  group_by(intend_buy_merch) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - uneven, but decent distribution for sample sizes if representative of the attendance population

```{r}

intended <- attendance_df %>%
  filter(intend_buy_merch %in% c("Strongly agree", "Agree", "Somewhat agree", "Neutral")) %>%
  group_by(intend_buy_merch) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, avg_num_matches_2017), y = avg_num_matches_2017, fill = intend_buy_merch )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  filter(intend_buy_merch %in% c("Strongly agree", "Agree", "Somewhat agree", "Neutral")) %>%
  group_by(intend_buy_merch) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, avg_matches), y = avg_matches, fill = intend_buy_merch )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  - Intentions to buy merch seem to have an impact on last season's attendance, but not much
  
#### Coach fan and attendance

```{r}
attendance_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not enough observations for Disagree, somewhat disagree, and strongly disagree

```{r}

intended <- attendance_df %>%
  filter(coach_fan != "Strongly Disagree", coach_fan != "Somewhat disagree", coach_fan != "Disagree") %>%
  group_by(coach_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, avg_num_matches_2017), y = avg_num_matches_2017, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))+
  labs(y = "Number of Matches in 2017", x = "'Fan of Coach'")


attended <- attendance_df %>%
  filter(coach_fan != "Strongly Disagree", coach_fan != "Somewhat disagree", coach_fan != "Disagree") %>%
  group_by(coach_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, avg_matches), y = avg_matches, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))+
  labs(y = "Number of Matches Attended in 2016", x = "'Fan of Coach'")


intended / attended

```

  - Being a fan of Coach Laura Harvey seems to have an impact on attendance
  
#### Community affect and attendance

```{r}
attendance_df %>%
  group_by(feel_part_of_community_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - uneven, but decent distribution for sample sizes if representative of the attendance population

```{r}

intended <- attendance_df %>%
  filter(feel_part_of_community_fan != "Somewhat disagree",feel_part_of_community_fan != "Strongly Disagree") %>%
  group_by(feel_part_of_community_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(feel_part_of_community_fan, avg_num_matches_2017), y = avg_num_matches_2017, fill = feel_part_of_community_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


attended <- attendance_df %>%
  filter(feel_part_of_community_fan != "Somewhat disagree",feel_part_of_community_fan != "Strongly Disagree") %>%
  group_by(feel_part_of_community_fan) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_spend = median(spend_2016),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(feel_part_of_community_fan, avg_matches), y = avg_matches, fill = feel_part_of_community_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


intended / attended
```

  - Community affect seems to have a big impact on attendance

#### Ease of getting tickets affect and attendance

```{r}
attendance_df %>%
  group_by(tickets_easy_get) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - there is not a large enough sample size to use disagree or somewhat disagree
  

```{r}

intended <- attendance_df %>%
  filter(tickets_easy_get != "Disagree", tickets_easy_get != "Somewhat disagree") %>%
  group_by(tickets_easy_get) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(tickets_easy_get, avg_num_matches_2017), y = avg_num_matches_2017, fill = tickets_easy_get )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


attended <- attendance_df %>%
  filter(tickets_easy_get != "Disagree", tickets_easy_get != "Somewhat disagree") %>%
  group_by(tickets_easy_get) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(tickets_easy_get, avg_matches), y = avg_matches, fill = tickets_easy_get )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))


intended / attended
```

  - does not seem to have much of an impact
  

#### Precived player skill and attendance

```{r}
attendance_df %>%
  group_by(players_are_skilled) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not enough observations for Disagree, Somewhat disagree and strongly disagree

```{r}
intended <- attendance_df %>%
  filter(players_are_skilled != "Disagree", players_are_skilled != "Somewhat disagree", players_are_skilled != "Strongly Disagree") %>%
  group_by(players_are_skilled) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, avg_num_matches_2017), y = avg_num_matches_2017, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  filter(players_are_skilled != "Disagree", players_are_skilled != "Somewhat disagree", players_are_skilled != "Strongly Disagree") %>%
  group_by(players_are_skilled) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, avg_matches), y = avg_matches, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  -  perception of players' skill does seem to have some impact on attendance
  
#### Prefer starfire and attendance

```{r}
attendance_df %>%
  group_by(prefer_starfire_staidum) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - good distribution of samples across categories

```{r}
intended <- attendance_df %>%
  group_by(prefer_starfire_staidum) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(prefer_starfire_staidum, avg_num_matches_2017), y = avg_num_matches_2017, fill = prefer_starfire_staidum )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  group_by(prefer_starfire_staidum) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(prefer_starfire_staidum, avg_matches), y = avg_matches, fill = prefer_starfire_staidum )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  -  preference for starfire does seem to have some impact on attendance
  
#### Attending games with friends and attendance

```{r}
attendance_df %>%
  group_by(att_game_with_friends) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - good distribution of samples across categories

```{r}
intended <- attendance_df %>%
  group_by(att_game_with_friends) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(att_game_with_friends, avg_num_matches_2017), y = avg_num_matches_2017, fill = att_game_with_friends )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  group_by(att_game_with_friends) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(att_game_with_friends, avg_matches), y = avg_matches, fill = att_game_with_friends )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  - attending games with friends seems to have some impact on attendance

#### Matchday experience and attendance

```{r}
attendance_df %>%
  group_by(overall_match_day_experience) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - not large enough sample size for 2 (Dissatisfied), somewhat dissatisfied, or very dissatisfied

```{r}
intended <- attendance_df %>%
  filter(overall_match_day_experience %in% c("Neutral", "Satisfied", "Somewhat Satisfied", "Very Satisfied")) %>%
  group_by(overall_match_day_experience) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(overall_match_day_experience, avg_num_matches_2017), y = avg_num_matches_2017, fill = overall_match_day_experience )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  filter(overall_match_day_experience %in% c("Neutral", "Satisfied", "Somewhat Satisfied", "Very Satisfied")) %>%
  group_by(overall_match_day_experience) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(overall_match_day_experience, avg_matches), y = avg_matches, fill = overall_match_day_experience )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  - unexpected result for past attendance, but does seem to be an indicator for number of matches attended

#### att_game_with_family experience and attendance

```{r}
attendance_df %>%
  group_by(att_game_with_family) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - good sample sizes

```{r}
intended <- attendance_df %>%
  group_by(att_game_with_family) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(att_game_with_family, avg_num_matches_2017), y = avg_num_matches_2017, fill = att_game_with_family )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


attended <- attendance_df %>%
  group_by(att_game_with_family) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(att_game_with_family, avg_matches), y = avg_matches, fill = att_game_with_family )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))


intended / attended
```

  - does not seem to be an indicator for number of matches attended
  

#### income and attendance

```{r}
attendance_df %>%
  group_by(income) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - decent sample size for groups if representative of attendee population

```{r}
intended <- attendance_df %>%
  group_by(income) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(income, avg_num_matches_2017), y = avg_num_matches_2017, fill = income )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


attended <- attendance_df %>%
  group_by(income) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(income, avg_matches), y = avg_matches, fill = income )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


intended / attended
```

  - does not seem to be an indicator for number of matches attended
  

#### marriage_status and attendance

```{r}
attendance_df %>%
  group_by(marriage_status) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - small sample size for "other

```{r}
intended <- attendance_df %>%
  filter(marriage_status != "Other") %>%
  group_by(marriage_status) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(marriage_status, avg_num_matches_2017), y = avg_num_matches_2017, fill = marriage_status )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


attended <- attendance_df %>%
  filter(marriage_status != "Other") %>%
  group_by(marriage_status) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(marriage_status, avg_matches), y = avg_matches, fill = marriage_status )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


intended / attended
```

  - does not seem to be an indicator for number of matches attended

#### youtube visits and attendance

```{r}
attendance_df %>%
  group_by(youtube_visits) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - small sample size for 4 and 5 visits 

```{r}
intended <- attendance_df %>%
  mutate(youtube_visits = factor(youtube_visits)) %>%
  filter(youtube_visits != 4, youtube_visits != 5) %>%
  group_by(youtube_visits) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(youtube_visits, avg_num_matches_2017), y = avg_num_matches_2017, fill = youtube_visits )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


attended <- attendance_df %>%
  mutate(youtube_visits = factor(youtube_visits)) %>%
  filter(youtube_visits != 4, youtube_visits != 5) %>%
  group_by(youtube_visits) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(youtube_visits, avg_matches), y = avg_matches, fill = youtube_visits )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


intended / attended
```

  - youtube visits do seem to be an indicator for number of matches attended


#### want more emails and attendance

```{r}
attendance_df %>%
  group_by(want_more_emails) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - decent sample sizes if representative of the population

```{r}
intended <- attendance_df %>%
  group_by(want_more_emails) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(want_more_emails, avg_num_matches_2017), y = avg_num_matches_2017, fill = want_more_emails )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


attended <- attendance_df %>%
  group_by(want_more_emails) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(want_more_emails, avg_matches), y = avg_matches, fill = want_more_emails )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


intended / attended
```

  - wanting more emails does not seem to be an indicator for number of matches attended


#### interest and attendance

```{r}
attendance_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016))
```

  - small sample size for I have a small amount of interest

```{r}
intended <- attendance_df %>%
  filter(interest != "I have a small amount of interest") %>%
  group_by(interest) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(interest, avg_num_matches_2017), y = avg_num_matches_2017, fill = interest )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


attended <- attendance_df %>%
  filter(interest != "I have a small amount of interest") %>%
  group_by(interest) %>%
  summarise(
    avg_num_matches_2017 = median(intended_num_matches_attend_2017),
    avg_matches = median(num_matches_attend_2016)) %>%
  ggplot(mapping = aes(x = reorder(interest, avg_matches), y = avg_matches, fill = interest )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF", "#6F8FAF", "#5D3FD3"))


intended / attended
```

  - interest seems to be a good indicator for number of matches attended


# Statistical EDA: Attendance

### Intend season ticket and attendance

```{r}
# Linear regression with linear model
# control for type of ticket used last season and number of matches attended last year
regression_season_ticket <- lm(intended_num_matches_attend_2017 ~ intend_season_ticket + ticket_type_used_2016 + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_season_ticket)
```

  - small p-value
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_season_ticket$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_season_ticket)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_season_ticket)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and reliably significant difference for season ticket

### Ticket types and attendancet and attendance

```{r}
# drop small samples
ticket_types <- attendance_df %>%
  filter(ticket_type_used_2016 != "I don't know", ticket_type_used_2016 != "3 Match Pack", ticket_type_used_2016 != "Pitchside Table") 
# Linear regression with linear model
# control for ticket used last year and number of matches attended last year
regression_ticket_type <- lm(intended_num_matches_attend_2017 ~ ticket_type_used_2016 + ticket_type_used_2016 + num_matches_attend_2016, data = ticket_types)
# Review output
summary(regression_ticket_type)
```

  - large p-values
  
```{r}
par(mfrow = c(1, 1))
plot(ticket_types$intended_num_matches_attend_2017, regression_ticket_type$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_ticket_type)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_ticket_type)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically or reliably different
  
### support and attendance

```{r}
# drop small samples
support <- attendance_df %>%
  filter(likely_support_2017 != "Strongly Disagree", likely_support_2017 != "Disagree", likely_support_2017 != "Neutral") 
# Linear regression with linear model
# controlling for number of matches attended last year
regression_support <- lm(intended_num_matches_attend_2017 ~ likely_support_2017 + num_matches_attend_2016, data = support)
# Review output
summary(regression_support)
```

  - small p-value
  
```{r}
par(mfrow = c(1, 1))
plot(support$intended_num_matches_attend_2017, regression_support$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_support)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_support)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - reliably significant difference
  - statistically significant difference
  
### merch intentions and attendance

```{r}
# Linear regression with linear model
regression_merch_intentions <- lm(intended_num_matches_attend_2017 ~ intend_buy_merch + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_merch_intentions)
```

  - large p-value for neutral and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_merch_intentions$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_merch_intentions)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_merch_intentions)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - reliably significant - strongly disagree, somewhat disagree, somewhat agree
  - statistically significant - agree, somewhat agree, somewhat disagree, disagree, strongly diagree
  
### Coach and attendance

```{r}
coach <- attendance_df %>%
  filter(coach_fan != "Strongly Disagree", coach_fan != "Somewhat disagree", coach_fan != "Disagree") 
# Linear regression with linear model
regression_coach <- lm(intended_num_matches_attend_2017 ~ coach_fan + num_matches_attend_2016, data = coach)
# Review output
summary(regression_coach)
```

  - small p-value for agree
  
```{r}
par(mfrow = c(1, 1))
plot(coach$intended_num_matches_attend_2017, regression_coach$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_coach)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_coach)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically or reliably significant

### Community affect and attendance

```{r}
# drop small samples
community <- attendance_df %>%
  filter(feel_part_of_community_fan != "Somewhat disagree",feel_part_of_community_fan != "Strongly Disagree")
# Linear regression with linear model
regression_comm <- lm(intended_num_matches_attend_2017 ~ feel_part_of_community_fan + num_matches_attend_2016, data = community)
# Review output
summary(regression_comm)
```

  - small p-value for neutral and agree
  
```{r}
par(mfrow = c(1, 1))
plot(community$intended_num_matches_attend_2017, regression_comm$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_comm)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_comm)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically or whatever the word is different

### Skill perception and attendance

```{r}
# drop small samples
skill <- attendance_df %>%
  filter(players_are_skilled != "Disagree", players_are_skilled != "Somewhat disagree", players_are_skilled != "Strongly Disagree") 
# Linear regression with linear model
regression_skill <- lm(intended_num_matches_attend_2017 ~ players_are_skilled + num_matches_attend_2016, data = skill)
# Review output
summary(regression_skill)
```

  - small p-value for agree only
  
```{r}
par(mfrow = c(1, 1))
plot(skill$intended_num_matches_attend_2017, regression_skill$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_skill)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_skill)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not reliably different

### Prefer starfire and attendance

```{r}
# Linear regression with linear model
regression_starfire <- lm(intended_num_matches_attend_2017 ~ prefer_starfire_staidum + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_starfire)
```

  - small p values agree and strongly disagree
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_starfire$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_starfire)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_starfire)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - agree and strongly disagree are reliably different

### Youtube and attendance

```{r}
# Linear regression with linear model
regression_youtube <- lm(intended_num_matches_attend_2017 ~ youtube_visits + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_youtube)
```

  - not statistically significant


### Interest and attendance

```{r}

# Linear regression with linear model
regression_interest <- lm(intended_num_matches_attend_2017 ~ interest + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_interest)
```

  - small p-values for loyal small amount and die-hard fans
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_interest$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_interest)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_interest)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - die-hard, small amount and loyal fans are statistically and reliablely significant

### num_matches_attend_2016 and attendance

```{r}

# Linear regression with linear model
regression_past_attend <- lm(intended_num_matches_attend_2017 ~ num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_past_attend)
```

  - small p-values for loyal small amount and die-hard fans
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_past_attend$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_past_attend)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression_past_attend)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - die-hard, small amount and loyal fans are statistically and reliablely significant

### spend_2016 and attendance

```{r}

# Linear regression with linear model
regression_spend <- lm(intended_num_matches_attend_2017 ~ spend_2016 + num_matches_attend_2016, data = attendance_df)
# Review output
summary(regression_spend)
```

  - small p-values for loyal small amount and die-hard fans
  
```{r}
par(mfrow = c(1, 1))
plot(attendance_df$intended_num_matches_attend_2017, regression_spend$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression_spend)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression_spend)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - die-hard, small amount and loyal fans are statistically and reliablely significant


# Statistical EDA Conclusions: primary factors that impact attendance intentions

Statistically and practically significant:

  - interest
  - intent to buy merch
  - likely_support_2017
  - season ticket
  - number of matches attended last year
  

# Determine factors that impact media consumption intentions

Variables of interest:

  - website_visits
  - facebook_visits
  - twitter_visits
  - instagram_visits
  - youtube_visits
  - num_read_about_team_newspaper_digital_media
  

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with website_visits
website_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "website_visits" | col_2 == "website_visits")
# find negative correlations less than -.2 with website_visits
website_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "website_visits" | col_2 == "website_visits")
# create table of correlations
website_correlations <- bind_rows(website_positive_correlations,website_negative_correlations)
```

`r  kbl(website_correlations) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with facebook_visits
facebook_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "facebook_visits" | col_2 == "facebook_visits")
# find negative correlations less than -.2 with facebook_visits
facebook_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "facebook_visits" | col_2 == "facebook_visits")
# create table of correlations
facebook_correlations <- bind_rows(facebook_positive_correlations,facebook_negative_correlations)
```

`r  kbl(facebook_correlations) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with twitter_visits
twitter_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "twitter_visits" | col_2 == "twitter_visits")
# find negative correlations less than -.2 with twitter_visits
twitter_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "twitter_visits" | col_2 == "twitter_visits")
# create table of correlations
twitter_correlations <- bind_rows(twitter_positive_correlations,twitter_negative_correlations)
```

`r  kbl(twitter_correlations) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with instagram_visits
ig_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "instagram_visits" | col_2 == "instagram_visits")
# find negative correlations less than -.2 with instagram_visits
ig_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "instagram_visits" | col_2 == "instagram_visits")
# create table of correlations
ig_correlations <- bind_rows(ig_positive_correlations,ig_negative_correlations)
```

`r  kbl(ig_correlations) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with youtube_visits
yt_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "youtube_visits" | col_2 == "youtube_visits")
# find negative correlations less than -.2 with youtube_visits
yt_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "youtube_visits" | col_2 == "youtube_visits")
# create table of correlations
yt_correlations <- bind_rows(yt_positive_correlations,yt_negative_correlations)
```

`r  kbl(yt_correlations) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with num_read_about_team_newspaper_digital_media
digmed_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "num_read_about_team_newspaper_digital_media" | col_2 == "num_read_about_team_newspaper_digital_media")
# find negative correlations less than -.2 with num_read_about_team_newspaper_digital_media
digmed_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "num_read_about_team_newspaper_digital_media" | col_2 == "num_read_about_team_newspaper_digital_media")
# create table of correlations
digmed_correlations <- bind_rows(digmed_positive_correlations,digmed_negative_correlations)
```

`r  kbl(digmed_correlations) %>% kable_minimal(full_width = F, position = "left") `


```{r}
# create vector of correlated variables
one <- c(website_correlations$col_1, website_correlations$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(facebook_correlations$col_1, facebook_correlations$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of correlated variables
three <- c(twitter_correlations$col_1, twitter_correlations$col_2)
# drop duplicate variables
three <- unique(three)
# create vector of correlated variables
four <- c(ig_correlations$col_1, ig_correlations$col_2)
# drop duplicate variables
four <- unique(four)
# create vector of correlated variables
five <- c(yt_correlations$col_1, yt_correlations$col_2)
# drop duplicate variables
five <- unique(five)
# create vector of correlated variables
six <- c(digmed_correlations$col_1, digmed_correlations$col_2)
# drop duplicate variables
six <- unique(six)

# create vector of all correlations
all_together <- c(one, two, three, four, five, six)
# drop duplicate variables
variables <- unique(all_together)
```

+ create data set 

```{r}
# create df of variables correlated with attendance variables
media_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables)  %>%
  # drop Na's
  drop_na()

vtable(media_correlations_df)
```

+ prepare data set

```{r}
# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId, Email1, Interest, BIRG1, IDteam1, Buymer1, IDcoach1, Media7a, Media6, Starfir1, Media7b, lasttype, Gender, HopeS1, Escape1, Drama4, Attend1)

# mutate values
variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Has no influence on my attendance  0", "0"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Has a positive influence on my attendance 3", "3"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Had a negative influence on my attendance -3", "-3"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "0", "no influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-3", "very negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-2", "negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-1", "slightly negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "3", "very positive influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "2", "positive influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "1", "slightly positive influence"))) 
  
#add columns to attendance data set
media <- left_join(media_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
media_df <- media %>%
  mutate(
    want_more_emails = Email1,
    interest = Interest.y,
    share_affiliation_others = BIRG1,
    real_fan = IDteam1,
    intend_buy_merch = Buymer1,
    coach_fan = IDcoach1,
    facebook_post_influence = Media7a,
    internet_ads_influence = Media6,
    prefer_starfire_staidum = Starfir1,
    twitter_post_influence = Media7b,
    ticket_type_used_2016 = lasttype,
    gender = Gender,
    hope_solo_fan = HopeS1,
    provide_escape = Escape1,
    provides_excitement = Drama4,
    ever_attend_match = Attend1) %>%
  group_by(ResponseId) %>%
  mutate(
    weekly_media_consumption = (youtube_visits + website_visits + facebook_visits + twitter_visits + instagram_visits + num_read_about_team_newspaper_digital_media)) %>%
  ungroup() %>%
  select(-c(ResponseId, Email1, Interest.x, Interest.y, BIRG1, IDteam1, Buymer1, IDcoach1, Media7a, Media6, Starfir1, Media7b, lasttype, Gender, HopeS1, Escape1, Drama4, Attend1, consider_kraken_congee, youtube_visits, website_visits, facebook_visits, twitter_visits, instagram_visits, num_read_about_team_newspaper_digital_media)) %>%
  mutate(across(where(is.character), as.factor)) 

```


### Analyze variables correlated with media

```{r}
# look at data types
media_df  %>%
	inspect_types() %>%
	show_plot()
```


#### want_more_emails and media consumption

```{r}
media_df %>%
  group_by(want_more_emails) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - uneven, but decent distribution of observations if representative of population

```{r}
media_df %>%
  group_by(want_more_emails) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(want_more_emails, average_media), y = average_media, fill = want_more_emails )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption

#### share_affiliation_others and media consumption

```{r}
media_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for strongly disagree 

```{r}
media_df %>%
  filter(share_affiliation_others != "Strongly Disagree") %>%
  group_by(share_affiliation_others) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, average_media), y = average_media, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption
  
#### real_fan and media consumption

```{r}
media_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for strongly disagree, Disagree and somewhat disagree

```{r}
media_df %>%
  filter(real_fan != "Strongly Disagree", real_fan != "Somewhat disagree", real_fan != "Disagree") %>%
  group_by(real_fan) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(real_fan, average_media), y = average_media, fill = real_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption

#### intend_buy_merch and media consumption

```{r}
media_df %>%
  group_by(intend_buy_merch) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for strongly disagree, Disagree and somewhat disagree

```{r}
media_df %>%
  filter(intend_buy_merch != "Strongly Disagree", intend_buy_merch != "Somewhat disagree", intend_buy_merch != "Disagree") %>%
  group_by(intend_buy_merch) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, average_media), y = average_media, fill = intend_buy_merch )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - does not appear to be a strong indicator of media consumption


#### coach_fan and media consumption

```{r}
media_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for strongly disagree, Disagree and somewhat disagree

```{r}
media_df %>%
  filter(coach_fan != "Strongly Disagree", coach_fan != "Somewhat disagree", coach_fan != "Disagree") %>%
  group_by(coach_fan) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, average_media), y = average_media, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - Appears to be a good indicator of media consumption

#### coach_fan and media consumption

```{r}
media_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for strongly disagree, Disagree and somewhat disagree

```{r}
media_df %>%
  filter(coach_fan != "Strongly Disagree", coach_fan != "Somewhat disagree", coach_fan != "Disagree") %>%
  group_by(coach_fan) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, average_media), y = average_media, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - Appears to be a good indicator of media consumption


####  facebook_post_influence and media consumption

```{r}
media_df %>%
  group_by(facebook_post_influence) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for slightly negative influence

```{r}
media_df %>%
  filter(facebook_post_influence != "slightly negative influence") %>%
  group_by(facebook_post_influence) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(facebook_post_influence, average_media), y = average_media, fill = facebook_post_influence )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - Appears to be a good indicator of media consumption

####  internet_ads_influence and media consumption

```{r}
media_df %>%
  group_by(internet_ads_influence) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for slightly negative and negative influence

```{r}
media_df %>%
  filter(internet_ads_influence != "slightly negative influence", internet_ads_influence != "negative influence") %>%
  group_by(internet_ads_influence) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(internet_ads_influence, average_media), y = average_media, fill = internet_ads_influence )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - Appears to be a good indicator of media consumption, but inconsistent


####  age and media consumption

```{r}
media_df %>%
  filter(gender != "Prefer not to answer") %>%
  ggplot(aes(x=age, y=weekly_media_consumption, color = gender))+ 
  geom_point()
```

  - Appears to be a good indicator of media consumption, but inconsistent

####  prefer_starfire_staidum and media consumption

```{r}
media_df %>%
  group_by(prefer_starfire_staidum) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - good sample size across categories

```{r}
media_df %>%
  group_by(prefer_starfire_staidum) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(prefer_starfire_staidum, average_media), y = average_media, fill = prefer_starfire_staidum )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - does not appear to be a good indicator of media consumption


####  twitter_post_influence and media consumption

```{r}
media_df %>%
  group_by(twitter_post_influence) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for slightly negative influence and very negative influence
  
```{r}
media_df %>%
  filter(twitter_post_influence !=  "slightly negative influence", twitter_post_influence != "very negative influence") %>%
  group_by(twitter_post_influence) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(twitter_post_influence, average_media), y = average_media, fill = twitter_post_influence )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption

####  ticket_type_used_2016 and media consumption

```{r}
media_df %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for Psitchside Table and 3 Match Pack
  
```{r}
media_df %>%
  filter(ticket_type_used_2016 !=  "Pitchside Table", ticket_type_used_2016 != "3 Match Pack") %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(ticket_type_used_2016, average_media), y = average_media, fill = ticket_type_used_2016 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption, but inconsistent

####  num_matches_attend_2016 and media consumption


```{r}
media_df %>%
  ggplot(aes(x=num_matches_attend_2016, y=weekly_media_consumption, color = ticket_type_used_2016))+ 
  geom_point()
```

  - interesting visual for types of tickets bought and number of matches attended, also shows who you're most media engaged respondents are in terms of ticket types
  

####  gender and media consumption

```{r}
media_df %>%
  group_by(gender) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for prefer not to answer
  
```{r}
media_df %>%
  filter(gender != "Prefer not to answer") %>%
  group_by(gender, ticket_type_used_2016) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(gender, average_media), y = average_media, fill = ticket_type_used_2016 )) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - looking at it broken down by ticket types, it doesnt seem as if women consistently have more engagement than men
  
####  hope_solo_fan and media consumption

```{r}
media_df %>%
  group_by(hope_solo_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - sgood distribution of ovservations across groups
  
```{r}
media_df %>%
  #filter(gender != "Prefer not to answer") %>%
  group_by(hope_solo_fan) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(hope_solo_fan, average_media), y = average_media, fill = hope_solo_fan )) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - looks like theres a relationship but not being a fan has no impact
  
####  hope_solo_fan and media consumption

```{r}
media_df %>%
  group_by(provide_escape) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for Disagree and Somewhat disagree
  
```{r}
media_df %>%
  filter(provide_escape != "Disagree", provide_escape != "Somewhat disagree") %>%
  group_by(provide_escape) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(provide_escape, average_media), y = average_media, fill = provide_escape )) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption
  

####  provides_excitement and media consumption

```{r}
media_df %>%
  group_by(provides_excitement) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for Disagree and Somewhat disagree
  
```{r}
media_df %>%
  filter(provides_excitement != "Disagree", provides_excitement != "Somewhat disagree") %>%
  group_by(provides_excitement) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_media), y = average_media, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a good indicator of media consumption
  
####  interest and media consumption

```{r}
media_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    average_media = median(weekly_media_consumption))
```

  - small sample for I have a small amount of interest
  
```{r}
media_df %>%
  filter(interest != "I have a small amount of interest") %>%
  group_by(interest) %>%
  summarise(
    average_media = median(weekly_media_consumption)) %>%
  ggplot(mapping = aes(x = reorder(interest, average_media), y = average_media, fill = interest)) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#00FFFF"))

```

  - appears to be a very good indicator of media consumption!
  
####  Interest and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ interest , data = media_df)
# Review output
summary(regression)
```

  - small p-values and significant coefficient differences
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - die-hard and loyal fans  and low level are statistically 
  - practically significant

####  provide_escape and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ provide_escape , data = media_df)
# Review output
summary(regression)
```

  - small p-values and potentially significant coefficient differences
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - agree, strongly agree, somewhat disagree somewhat agree and neutral
  - slightly practically significant


####  share_affiliation_others and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ share_affiliation_others , data = media_df)
# Review output
summary(regression)
```

  - small p-values for agree disagree neutral somewhat disagree and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - yes statistically and somewhat reliably strongly agree, agree and neutral
  - practically different

####  want_more_emails and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ want_more_emails , data = media_df)
# Review output
summary(regression)
```

  - small p-values for agree, disagree, somewhat disagree and strongly disagree
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - yes statistically and somewhat reliably strongly agree, agree and neutral
  - not practically different
  
####  real_fan and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ real_fan , data = media_df)
# Review output
summary(regression)
```

  - small p-value, intercepts appear significant as well
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - yes statistically and  reliably strongly agree, agree, neutral, somewhat agree
  - practically significant
  
####  num_matches_attend_2016 and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ num_matches_attend_2016 , data = media_df)
# Review output
summary(regression)
```

  - small p-value, but very small coeficient
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically, but not practically significant

####  age and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ age , data = media_df)
# Review output
summary(regression)
```

  - small p-value, but also very small coefficient
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not practically significant

####  hope_solo_fan and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ hope_solo_fan , data = media_df)
# Review output
summary(regression)
```

  - small p-value for agree, disagree somewhat agree and somewhat disagree
  - coefficients seem significant
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - yes, disagree and somewhat disagree, somewhat agree, and agree
  - not practically significant, other featues have a bigger impact
  
####  ticket_type_used_2016 and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ ticket_type_used_2016 , data = media_df)
# Review output
summary(regression)
```

  - not significant - large p-values
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - Not statistically significant


  
####  coach_fan and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ coach_fan , data = media_df)
# Review output
summary(regression)
```

  - small p-value for all except Disagree
  - coeficients seem significant
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and reliably different for somewhat disagree, somewhat agree, neutral, agree and strongly agree
  - practically significant
  
####  ticket_type_used_2016 and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ provide_escape, data = media_df)
# Review output
summary(regression)
```

  - small p-values for all
  - coeffficients seem significant
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and reliably different for somewhat disagree, strongly agree, agree, and neutral
  - not the most practically significant
  
####  provides_excitement and media consumption

```{r}
# Linear regression with linear model
regression <- lm(weekly_media_consumption ~ provides_excitement, data = media_df)
# Review output
summary(regression)
```

  - small p-values for agree, somewhat agree and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(media_df$weekly_media_consumption, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and practically significant for strongly agree somewhat agree and agree
    
  

# Statistical EDA Conclusions: primary factors that impact media consumption intentions

Statistically and practically significant:

  - Interest
  - Share affiliation other
  - Real fan
  - Coach fan
  
  less practically significant, but still practically and statistically significant:
  
  - provides excitement
  - hope solo fan
  - provides escape
  
# Determine factors that impact merchandise consumption intentions

Variables of interest:

  - intend_buy_merch
  - spend_2016

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .3, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.3, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
```

`r  kbl(correlations_1) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# find positive correlations greater than .2 with attend_2017
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "spend_2016" | col_2 == "spend_2016")
# find negative correlations less than -.2 with attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "spend_2016" | col_2 == "spend_2016")
# create table of correlations
correlations_2 <- bind_rows(positive_correlations, negative_correlations)
```

`r  kbl(correlations_2) %>% kable_minimal(full_width = F, position = "left") `

```{r}
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(correlations_2$col_1, correlations_2$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of all correlations
all_together <- c(one, two)
# drop duplicate variables
variables <- unique(all_together)
```

+ create data set 

```{r}
# create df of variables correlated with attendance variables
merch_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables)  %>%
  # drop Na's
  drop_na()

vtable(merch_correlations_df)
```

+ prepare data set

```{r}
# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId,BIRG1, Support1, Buymer1, IDteam1, Skill2, IDcoach1, Drama4, CORF1, Interest, Mersat25, lasttype, Promo6, Promo5)

variables %>%
  select(Promo5) %>%
  unique
# mutate values
variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Has no influence on my attendance  0", "no influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Has a positive influence on my attendance 3", "very positive influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Had a negative influence on my attendance -3", "very negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "-2", "negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "-1", "slightly negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "2", "positive influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "1", "slightly positive influence"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "6", "Satisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "5", "Somewhat Satisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "2", "Somewhat Dissatisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "3", "Dissatisfied"))) 
#add columns to attendance data set
merchandise <- left_join(merch_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
merch_df <- merchandise %>%
  mutate(
         real_fan = IDteam1,
         likely_support_2017 = Support1,
         share_affiliation_others =	BIRG1,
         intend_buy_merch	= Buymer1,
         coach_fan = IDcoach1,
         merch_staff_satisfaction = Mersat25,
         players_are_skilled = Skill2,
         wish_werent_fan = CORF1,
         ticket_type_used_2016 = lasttype,
         interest	= Interest.y,
         provides_excitement = Drama4,
         post_match_events_influence = Promo6,
         pre_match_events_influence = Promo5) %>%
  select(-c(ResponseId, BIRG1, Support1, Buymer1, IDteam1, Skill2, IDcoach1, Drama4, CORF1, Interest.y, Interest.x, Mersat25, lasttype, Promo6, Promo5,consider_ruffneck_scarves, consider_kraken_congee, intend_season_ticket, intend_single_match)) %>%
  mutate(across(where(is.character), as.factor))

```


### Analyze variables correlated with merchandise consumption intentions

```{r}
# look at data types
merch_df  %>%
	inspect_types() %>%
	show_plot()
```


```{r}
# create customized theme function starting with theme_classic()
clean_theme <- theme_classic() +
  theme(legend.direction = "horizontal", # create horizontal legend
        legend.position = "bottom", # put legend at bottom of graph
        legend.justification='left', # align legend to the left
        legend.title = element_blank(), # remove legend title
        axis.line.y = element_blank(), # remove y-axis line
        axis.ticks.y = element_blank(), # remove y-axis ticks
        axis.ticks.x = element_blank(), # remove x-axis ticks
        plot.title = element_text(face = "bold", size = 15)) # make graph title bold and a larger font
```

####  share_affiliation_others and merch

```{r}
merch_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for somewhat disagree and Strongly Disagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
merch_df %>%
  filter(share_affiliation_others != "Somewhat disagree", share_affiliation_others != "Disagree", share_affiliation_others != "Strongly Disagree") %>%
  group_by(share_affiliation_others) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, average_spend), y = average_spend, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be an indicator, but inconsistend over groups
  
####  intend_buy_merch and merch

```{r}
merch_df %>%
  group_by(intend_buy_merch) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Strongly Disagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
merch_df %>%
  filter(intend_buy_merch != "Strongly Disagree") %>%
  group_by(intend_buy_merch) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, average_spend), y = average_spend, fill = intend_buy_merch )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be an indicator, but thats expected since this is one of my variables of interest over groups
  
####  real_fan and merch

```{r}
merch_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Strongly Disagree
  
```{r}
merch_df %>%
  filter(real_fan != "Somewhat disagree", real_fan != "Disagree", real_fan != "Strongly Disagree") %>%
  group_by(real_fan) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(real_fan, average_spend), y = average_spend, fill = real_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be a good indicator
  
####  players_are_skilled and merch

```{r}
merch_df %>%
  group_by(players_are_skilled) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Strongly Disagree
  
```{r}
merch_df %>%
  filter(players_are_skilled != "Somewhat disagree", players_are_skilled != "Disagree", players_are_skilled != "Strongly Disagree", players_are_skilled != "Neutral") %>%
  group_by(players_are_skilled) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, average_spend), y = average_spend, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be a good indicator
  
####  coach_fan and merch

```{r}
merch_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Strongly Disagree
  
```{r}
merch_df %>%
  filter(coach_fan != "Somewhat disagree", coach_fan != "Disagree", coach_fan != "Strongly Disagree") %>%
  group_by(coach_fan) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, average_spend), y = average_spend, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be a good indicator
  
####  provides_excitement and merch

```{r}
merch_df %>%
  group_by(provides_excitement) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Strongly Disagree
  
```{r}
merch_df %>%
  filter(provides_excitement != "Somewhat disagree", provides_excitement != "Disagree", provides_excitement != "Strongly Disagree", provides_excitement != "Neutral") %>%
  group_by(provides_excitement) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_spend), y = average_spend, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - does not seem to be a good indicator
  

####  merch_staff_satisfaction and merch

```{r}
merch_df %>%
  group_by(merch_staff_satisfaction) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for Very Dissatisfied, Dissatisfied, and somewhat dissatisfied
  
```{r}
merch_df %>%
  filter(merch_staff_satisfaction != "Somewhat Dissatisfied", merch_staff_satisfaction != "Dissatisfied", merch_staff_satisfaction != "Strongly Dissatisfied") %>%
  group_by(merch_staff_satisfaction) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(merch_staff_satisfaction, average_spend), y = average_spend, fill = merch_staff_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - does not seem to be a good indicator 
  
####  intended_num_matches_attend_2017 and merch

```{r}
merch_df %>%
  ggplot(aes(x=intended_num_matches_attend_2017, y=spend_2016, color = ticket_type_used_2016))+ 
  geom_point()
```

####  intended_num_matches_attend_2017 and merch

```{r}
merch_df %>%
  ggplot(aes(x=num_matches_attend_2016, y=spend_2016, color = ticket_type_used_2016))+ 
  geom_point()
```

####  prefer_jackets and merch

```{r}
merch_df %>%
  group_by(prefer_jackets) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - good distribution of observations
  
```{r}
merch_df %>%
  mutate(prefer_jackets = factor(prefer_jackets)) %>%
  group_by(prefer_jackets) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(prefer_jackets, average_spend), y = average_spend, fill = prefer_jackets )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - people who prefer jackets spend more that people who dont

####  ticket_type_used_2016 and merch

```{r}
merch_df %>%
  group_by(ticket_type_used_2016) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for 3 Match Pack, 5 Match Pack, Pitchside Table and I don't know
  
```{r}
merch_df %>%
  filter(ticket_type_used_2016 %in% c("Season Ticket", "Single Match")) %>%
  group_by(ticket_type_used_2016) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(ticket_type_used_2016, average_spend), y = average_spend, fill = ticket_type_used_2016 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - season ticket holders appear to spend more on merch (understandable result) 
  
####  post_match_events_influence and merch

```{r}
merch_df %>%
  group_by(post_match_events_influence) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for negative influence, slightly negative influence verynegative influence
  
```{r}
merch_df %>%
  filter(post_match_events_influence %in% c("very positive influence", "slightly positive influence", "positive influence", "no influence")) %>%
  group_by(post_match_events_influence) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(post_match_events_influence, average_spend), y = average_spend, fill = post_match_events_influence )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems to be an indicator
  
####  pre_match_events_influence and merch

```{r}
merch_df %>%
  group_by(pre_match_events_influence) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for negative influence, slightly negative influence verynegative influence
  
```{r}
merch_df %>%
  filter(pre_match_events_influence %in% c("very positive influence", "slightly positive influence", "positive influence", "no influence")) %>%
  group_by(pre_match_events_influence) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(pre_match_events_influence, average_spend), y = average_spend, fill = pre_match_events_influence )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

- seems to be a good indicator

####  prefer_short_sleeve_shirts and merch

```{r}
merch_df %>%
  group_by(prefer_short_sleeve_shirts) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - good sample sizes
  
```{r}
merch_df %>%
  mutate(prefer_short_sleeve_shirts = factor(prefer_short_sleeve_shirts)) %>%
  group_by(prefer_short_sleeve_shirts) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(prefer_short_sleeve_shirts, average_spend), y = average_spend, fill = prefer_short_sleeve_shirts )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

- people who prefer shirts spend more than people who dont

####  interest and merch

```{r}
merch_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    average_spend = median(spend_2016))
```

  - small sample size for I have a small amount of interest
  
```{r}
merch_df %>%
  filter(interest != "I have a small amount of interest") %>%
  group_by(interest) %>%
  summarise(average_spend = median(spend_2016)) %>%
  ggplot(mapping = aes(x = reorder(interest, average_spend), y = average_spend, fill = interest )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

- appears to be a good indicator

####  share_affiliation_others and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ share_affiliation_others, data = merch_df)
# Review output
summary(regression)
```

  - small p-values for agree, disagree, neutral, somewhat agree and somewhat disagree
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and practically significant

  
####  real_fan and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ real_fan, data = merch_df)
# Review output
summary(regression)
```

  - small p-values for agree, neutral, somewhat disagree and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}

# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and practically significant
  

####  players_are_skilled and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ players_are_skilled, data = merch_df)
# Review output
summary(regression)
```

  - small p-values for agree, neutral, somewhat disagree and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically significant
  
####  coach_fan and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ coach_fan, data = merch_df)
# Review output
summary(regression)
```

  - small p-values for agree, neutral, somewhat disagree and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant
  
####  Interest and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ interest, data = merch_df)
# Review output
summary(regression)
```

  - most ptactically and statistically significant
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[-1, ], confint(regression)[-1, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant
  
####  intended_num_matches_attend_2017 and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ intended_num_matches_attend_2017, data = merch_df)
# Review output
summary(regression)
```

  - small p-value 
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant 
  
  
####  num_matches_attend_2016 and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ num_matches_attend_2016, data = merch_df)
# Review output
summary(regression)
```

  - small p-value 
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}

# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant  
  
  
####  prefer_jackets and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ prefer_jackets, data = merch_df)
# Review output
summary(regression)
```

  - small p-value 
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant  
  
####  ticket_type_used_2016 and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ ticket_type_used_2016, data = merch_df)
# Review output
summary(regression)
```

  - large p-values
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically significant    
  
  
####  prefer_short_sleeve_shirts and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ prefer_short_sleeve_shirts, data = merch_df)
# Review output
summary(regression)
```

  - large p-values, not practically significant
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically significant      
  
####  pre_match_events_influence and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ pre_match_events_influence, data = merch_df)
# Review output
summary(regression)
```

  - large p-values, not statistically
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically significant      
    
####  post_match_events_influence and merch

```{r}
# Linear regression with linear model
regression <- lm(spend_2016 ~ post_match_events_influence, data = merch_df)
# Review output
summary(regression)
```

  - large p-values, not statistically significant
  
```{r}
par(mfrow = c(1, 1))
plot(merch_df$intended_num_matches_attend_2017, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not statistically significant        
  
# Statistical EDA Conclusions: primary factors that impact merch consumption intentions  
  
Statistically and practically significant:

  - share_affiliation_others
  - real_fan
  - coach_fan
  - Interest
  - intended_num_matches_attend_2017
  - num_matches_attend_2016
  - prefer_jackets
  
  
# Determine factors that impact Satisfaction 

### Season Outcome Satisfaction

Variables of interest:

  - season_outcome

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .1, col_1 == "season_outcome" | col_2 == "season_outcome")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.1, col_1 == "season_outcome" | col_2 == "season_outcome")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)

# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .1, col_1 == "happy_about_2016_season" | col_2 == "happy_about_2016_season")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.1, col_1 == "happy_about_2016_season" | col_2 == "happy_about_2016_season")
# create table of correlations
correlations_2 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
two <- c(correlations_2$col_1, correlations_2$col_2)
# drop duplicate variables
two <- unique(two)

three <- c(one, two)

three <- unique(three)
```

`r  kbl(correlations_1) %>% kable_minimal(full_width = F, position = "left") `

+ create data set 

```{r}
# create df of variables correlated with attendance variables
outcome_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, three)  %>%
  # drop Na's
  drop_na() 

vtable(outcome_correlations_df)
  
outcome_df <- outcome_correlations_df %>%
  mutate(
    provides_learning_opp = case_when(
      provides_learning_opp == -3 ~ "strongly disagree",
      provides_learning_opp == -2 ~ "disagree",
      provides_learning_opp == -1 ~ "somewhat disagree",
      provides_learning_opp == 0 ~ "neutral",
      provides_learning_opp == 1 ~ "somewhat agree",
      provides_learning_opp == 2 ~ "agree",
      provides_learning_opp == 3 ~ "strongly agree"),
    pro_women_soccer_fan = case_when(
      pro_women_soccer_fan == -3 ~ "strongly disagree",
      pro_women_soccer_fan == -2 ~ "disagree",
      pro_women_soccer_fan == -1 ~ "somewhat disagree",
      pro_women_soccer_fan == 0 ~ "neutral",
      pro_women_soccer_fan == 1 ~ "somewhat agree",
      pro_women_soccer_fan == 2 ~ "agree",
      pro_women_soccer_fan == 3 ~ "strongly agree"),
    disappointed_with_2016_season = case_when(
      disappointed_with_2016_season == -3 ~ "strongly disagree",
      disappointed_with_2016_season == -2 ~ "disagree",
      disappointed_with_2016_season == -1 ~ "somewhat disagree",
      disappointed_with_2016_season == 0 ~ "neutral",
      disappointed_with_2016_season == 1 ~ "somewhat agree",
      disappointed_with_2016_season == 2 ~ "agree",
      disappointed_with_2016_season == 3 ~ "strongly agree"),

    attend_2017 = case_when(
      attend_2017 == -3 ~ "strongly disagree",
      attend_2017 == -2 ~ "disagree",
      attend_2017 == -1 ~ "somewhat disagree",
      attend_2017 == 0 ~ "neutral",
      attend_2017 == 1 ~ "somewhat agree",
      attend_2017 == 2 ~ "agree",
      attend_2017 == 3 ~ "strongly agree"),
    provides_role_models = case_when(
      provides_role_models == -3 ~ "strongly disagree",
      provides_role_models == -2 ~ "disagree",
      provides_role_models == -1 ~ "somewhat disagree",
      provides_role_models == 0 ~ "neutral",
      provides_role_models == 1 ~ "somewhat agree",
      provides_role_models == 2 ~ "agree",
      provides_role_models == 3 ~ "strongly agree"),
    likely_support_2017 = case_when(
      likely_support_2017 == -3 ~ "strongly disagree",
      likely_support_2017 == -2 ~ "disagree",
      likely_support_2017 == -1 ~ "somewhat disagree",
      likely_support_2017 == 0 ~ "neutral",
      likely_support_2017 == 1 ~ "somewhat agree",
      likely_support_2017 == 2 ~ "agree",
      likely_support_2017 == 3 ~ "strongly agree"),
    tickets_easy_get = case_when(
      tickets_easy_get == -3 ~ "strongly disagree",
      tickets_easy_get == -2 ~ "disagree",
      tickets_easy_get == -1 ~ "somewhat disagree",
      tickets_easy_get == 0 ~ "neutral",
      tickets_easy_get == 1 ~ "somewhat agree",
      tickets_easy_get == 2 ~ "agree",
      tickets_easy_get == 3 ~ "strongly agree"),
    provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    support_woman_sport = case_when(
      support_woman_sport == -3 ~ "strongly disagree",
      support_woman_sport == -2 ~ "disagree",
      support_woman_sport == -1 ~ "somewhat disagree",
      support_woman_sport == 0 ~ "neutral",
      support_woman_sport == 1 ~ "somewhat agree",
      support_woman_sport == 2 ~ "agree",
      support_woman_sport == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    share_affiliation_others = case_when(
      share_affiliation_others == -3 ~ "strongly disagree",
      share_affiliation_others == -2 ~ "disagree",
      share_affiliation_others == -1 ~ "somewhat disagree",
      share_affiliation_others == 0 ~ "neutral",
      share_affiliation_others == 1 ~ "somewhat agree",
      share_affiliation_others == 2 ~ "agree",
      share_affiliation_others == 3 ~ "strongly agree"),
    match_cost_inexpensive = case_when(
      match_cost_inexpensive == -3 ~ "strongly disagree",
      match_cost_inexpensive == -2 ~ "disagree",
      match_cost_inexpensive == -1 ~ "somewhat disagree",
      match_cost_inexpensive == 0 ~ "neutral",
      match_cost_inexpensive == 1 ~ "somewhat agree",
      match_cost_inexpensive == 2 ~ "agree",
      match_cost_inexpensive == 3 ~ "strongly agree"),
    Interest = case_when(
      Interest == 1 ~ "not a fan",
      Interest == 2 ~ "low level fan",
      Interest == 3 ~ "moderate fan ",
      Interest == 4 ~ "loyal fan",
      Interest == 5 ~ "die-hard fan"),
    merch_staff_satisfaction = case_when(
      merch_staff_satisfaction == 1 ~ "very unsatisfied",
      merch_staff_satisfaction == 2 ~ "unsatisfied",
      merch_staff_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_staff_satisfaction == 4 ~ "neutral",
      merch_staff_satisfaction == 5 ~ "somewhat satisfied",
      merch_staff_satisfaction == 6 ~ "satisfied",
      merch_staff_satisfaction == 7 ~ "very satisfied"),
    merch_variety_satisfaction = case_when(
      merch_variety_satisfaction == 1 ~ "very unsatisfied",
      merch_variety_satisfaction == 2 ~ "unsatisfied",
      merch_variety_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_variety_satisfaction == 4 ~ "neutral",
      merch_variety_satisfaction == 5 ~ "somewhat satisfied",
      merch_variety_satisfaction == 6 ~ "satisfied",
      merch_variety_satisfaction == 7 ~ "very satisfied"),
    merch_price_satisfaction = case_when(
      merch_price_satisfaction == 1 ~ "very unsatisfied",
      merch_price_satisfaction == 2 ~ "unsatisfied",
      merch_price_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_price_satisfaction == 4 ~ "neutral",
      merch_price_satisfaction == 5 ~ "somewhat satisfied",
      merch_price_satisfaction == 6 ~ "satisfied",
      merch_price_satisfaction == 7 ~ "very satisfied"),
    merch_quality_satisfaction = case_when(
      merch_quality_satisfaction == 1 ~ "very unsatisfied",
      merch_quality_satisfaction == 2 ~ "unsatisfied",
      merch_quality_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_quality_satisfaction == 4 ~ "neutral",
      merch_quality_satisfaction == 5 ~ "somewhat satisfied",
      merch_quality_satisfaction == 6 ~ "satisfied",
      merch_quality_satisfaction == 7 ~ "very satisfied"),
    merch_wait_time_satisfaction = case_when(
      merch_wait_time_satisfaction == 1 ~ "very unsatisfied",
      merch_wait_time_satisfaction == 2 ~ "unsatisfied",
      merch_wait_time_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_wait_time_satisfaction == 4 ~ "neutral",
      merch_wait_time_satisfaction == 5 ~ "somewhat satisfied",
      merch_wait_time_satisfaction == 6 ~ "satisfied",
      merch_wait_time_satisfaction == 7 ~ "very satisfied"),
    concession_food_wait_time = case_when(
      concession_food_wait_time == 1 ~ "very unsatisfied",
      concession_food_wait_time == 2 ~ "unsatisfied",
      concession_food_wait_time == 3 ~ "somewhat unsatisfied",
      concession_food_wait_time == 4 ~ "neutral",
      concession_food_wait_time == 5 ~ "somewhat satisfied",
      concession_food_wait_time == 6 ~ "satisfied",
      concession_food_wait_time == 7 ~ "very satisfied"),
    cleanliness = case_when(
      cleanliness == 0 ~ "very unsatisfied",
      cleanliness == 1 ~ "very unsatisfied",
      cleanliness == 2 ~ "unsatisfied",
      cleanliness == 3 ~ "somewhat unsatisfied",
      cleanliness == 4 ~ "neutral",
      cleanliness == 5 ~ "somewhat satisfied",
      cleanliness == 6 ~ "satisfied",
      cleanliness == 7 ~ "very satisfied"),
    overall_match_day_experience = case_when(
      overall_match_day_experience == 1 ~ "very unsatisfied",
      overall_match_day_experience == 2 ~ "unsatisfied",
      overall_match_day_experience == 3 ~ "somewhat unsatisfied",
      overall_match_day_experience == 4 ~ "neutral",
      overall_match_day_experience == 5 ~ "somewhat satisfied",
      overall_match_day_experience == 6 ~ "satisfied",
      overall_match_day_experience == 7 ~ "very satisfied"),
    arena_security = case_when(
      arena_security == 1 ~ "very unsatisfied",
      arena_security == 2 ~ "unsatisfied",
      arena_security == 3 ~ "somewhat unsatisfied",
      arena_security == 4 ~ "neutral",
      arena_security == 5 ~ "somewhat satisfied",
      arena_security == 6 ~ "satisfied",
      arena_security == 7 ~ "very satisfied"),
    entering_stadium = case_when(
      entering_stadium == 1 ~ "very unsatisfied",
      entering_stadium == 2 ~ "unsatisfied",
      entering_stadium == 3 ~ "somewhat unsatisfied",
      entering_stadium == 4 ~ "neutral",
      entering_stadium == 5 ~ "somewhat satisfied",
      entering_stadium == 6 ~ "satisfied",
      entering_stadium == 7 ~ "very satisfied"),
    arena_staff_friendliness = case_when(
      arena_staff_friendliness == 1 ~ "very unsatisfied",
      arena_staff_friendliness == 2 ~ "unsatisfied",
      arena_staff_friendliness == 3 ~ "somewhat unsatisfied",
      arena_staff_friendliness == 4 ~ "neutral",
      arena_staff_friendliness == 5 ~ "somewhat satisfied",
      arena_staff_friendliness == 6 ~ "satisfied",
      arena_staff_friendliness == 7 ~ "very satisfied"),
    overall_memorial_stadium_experience = case_when(
      overall_memorial_stadium_experience == 1 ~ "very unsatisfied",
      overall_memorial_stadium_experience == 2 ~ "unsatisfied",
      overall_memorial_stadium_experience == 3 ~ "somewhat unsatisfied",
      overall_memorial_stadium_experience == 4 ~ "neutral",
      overall_memorial_stadium_experience == 5 ~ "somewhat satisfied",
      overall_memorial_stadium_experience == 6 ~ "satisfied",
      overall_memorial_stadium_experience == 7 ~ "very satisfied") ) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId)
    
#vtable(outcome_correlations_df)
```


### Analyze variables correlated with season outcome satisfaction

```{r}
# look at data types
outcome_df  %>%
	inspect_types() %>%
	show_plot()
```
  
####  disappointed_with_2016_season and season_outcome

```{r}
outcome_df %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(outcome_df)),
    average_satisfaction= median(season_outcome))
```

  - small sample size for very disappointed
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  filter(disappointed_with_2016_season != "very disappointed") %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(disappointed_with_2016_season, average_satisfaction), y = average_satisfaction, fill = disappointed_with_2016_season )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#008080"))
```

  - not the best


####  season_performance and season_outcome

```{r}
outcome_df %>%
  group_by(season_performance) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(outcome_df)),
    average_satisfaction= median(season_outcome))
```

  - small sample size for very unsatisfied and unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  mutate(season_performance = factor(season_performance)) %>%
  filter(season_performance != "very unsatisfied", season_performance != "unsatisfied") %>%
  group_by(season_performance) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(season_performance, average_satisfaction), y = average_satisfaction, fill = season_performance )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - seems to be a good indicator
  
#### staff friendliness
 
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(arena_staff_friendliness) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(arena_staff_friendliness, average_satisfaction), y = average_satisfaction, fill = arena_staff_friendliness )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - seems to be a good indicator
  
#### entering staidum

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(entering_stadium) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(entering_stadium, average_satisfaction), y = average_satisfaction, fill = entering_stadium )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no

#### provides_role_models

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(provides_role_models) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(provides_role_models, average_satisfaction), y = average_satisfaction, fill = provides_role_models )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no


#### likely_support_2017

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(likely_support_2017) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017, average_satisfaction), y = average_satisfaction, fill = likely_support_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### tickets_easy_get

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(tickets_easy_get) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(tickets_easy_get, average_satisfaction), y = average_satisfaction, fill = tickets_easy_get )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### provides_excitement

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(provides_excitement) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_satisfaction), y = average_satisfaction, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  

#### arena_security

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(arena_security) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(arena_security, average_satisfaction), y = average_satisfaction, fill = arena_security )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### support_woman_sport

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(support_woman_sport) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(support_woman_sport, average_satisfaction), y = average_satisfaction, fill = support_woman_sport )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  

#### r

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(players_are_skilled) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, average_satisfaction), y = average_satisfaction, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### share_affiliation_others

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(share_affiliation_others) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, average_satisfaction), y = average_satisfaction, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### cleanliness

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(cleanliness) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(cleanliness, average_satisfaction), y = average_satisfaction, fill = cleanliness )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### match_cost_inexpensive

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(match_cost_inexpensive) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(match_cost_inexpensive, average_satisfaction), y = average_satisfaction, fill = match_cost_inexpensive )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
  
#### concession_food_wait_time

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(concession_food_wait_time) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(concession_food_wait_time, average_satisfaction), y = average_satisfaction, fill = concession_food_wait_time )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  

#### provides_learning_opp

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(provides_learning_opp) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(provides_learning_opp, average_satisfaction), y = average_satisfaction, fill = provides_learning_opp )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### pro_women_soccer_fan

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(pro_women_soccer_fan) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(pro_women_soccer_fan, average_satisfaction), y = average_satisfaction, fill = pro_women_soccer_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### match_cost_inexpensive

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(disappointed_with_2016_season, average_satisfaction), y = average_satisfaction, fill = disappointed_with_2016_season )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### want_more_emails

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  mutate(want_more_emails = factor(want_more_emails)) %>%
  group_by(want_more_emails) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(want_more_emails, average_satisfaction), y = average_satisfaction, fill = want_more_emails )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### attend_2017

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(attend_2017) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(attend_2017, average_satisfaction), y = average_satisfaction, fill = attend_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
  
  
#### want_more_emails

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(merch_wait_time_satisfaction) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(merch_wait_time_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_wait_time_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
  
  
#### want_more_emails

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(merch_quality_satisfaction) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(merch_quality_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_quality_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
  
  
#### want_more_emails

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(merch_price_satisfaction) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(merch_price_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_price_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - no  
  
#### Interest

```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
outcome_df %>%
  group_by(Interest) %>%
  summarise(average_satisfaction = median(season_outcome)) %>%
  ggplot(mapping = aes(x = reorder(Interest, average_satisfaction), y = average_satisfaction, fill = Interest )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED",  "#008080"))
```

  - perhaps
  

  
    
####  Interest and season_outcome

```{r}
# Linear regression with linear model
regression <- lm(season_outcome ~ Interest, data = outcome_df)
# Review output
summary(regression)
```

  - small p-values
  
```{r}
par(mfrow = c(1, 1))
plot(outcome_df$season_outcome, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - all practically and statistically significant      

####  disappointed_with_2016_season and season_outcome

```{r}
# Linear regression with linear model
regression <- lm(season_outcome ~ disappointed_with_2016_season, data = outcome_df)
# Review output
summary(regression)
```

  - small p-values
  
```{r}
par(mfrow = c(1, 1))
plot(outcome_df$season_outcome, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - all practically and statistically significant except for very disappointed   

####  season_performance and season_outcome

```{r}
# Linear regression with linear model
regression <- lm(season_outcome ~ season_performance, data = outcome_df)
# Review output
summary(regression)
```

  - small p-values for satisfied, somewhat satisfied, very unsatisfied, very satisfied and unsatisfied
  
```{r}
par(mfrow = c(1, 1))
plot(outcome_df$season_outcome, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - all practically and statistically significant except for very unsatisfied, unsatisfied and somewhat unsatisfied
  
### Season Performance Satisfaction 

Variables of interest:

  - season_performance

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "season_performance" | col_2 == "season_performance")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "season_performance" | col_2 == "season_performance")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
```

`r  kbl(correlations_1) %>% kable_minimal(full_width = F, position = "left") `

+ create data set 

```{r}
# create df of variables correlated with attendance variables
performance_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one)  %>%
  # drop Na's
  drop_na() 
vtable(performance_correlations_df)

performance_df <- performance_correlations_df %>%
  mutate(happy_about_2016_season = case_when(
    happy_about_2016_season == -3 ~ "very unhappy",
    happy_about_2016_season == -2 ~ "unhappy",
    happy_about_2016_season == -1 ~ "somewhat unhappy",
    happy_about_2016_season == 0 ~ "neutral",
    happy_about_2016_season == 1 ~ "somewhat happy",
    happy_about_2016_season == 2 ~ "happy",
    happy_about_2016_season == 3 ~ "very happy"),
    disappointed_with_2016_season = case_when(
    disappointed_with_2016_season == -3 ~ "very happy",
    disappointed_with_2016_season == -2 ~ "happy",
    disappointed_with_2016_season == -1 ~ "somewhat happy",
    disappointed_with_2016_season == 0 ~ "neutral",
    disappointed_with_2016_season == 1 ~ "somewhat disappointed",
    disappointed_with_2016_season == 2 ~ "disappointed",
    disappointed_with_2016_season == 3 ~ "very disappointed"),
    season_outcome = case_when(
    season_outcome == -3 ~ "very unsatisfied",
    season_outcome == -2 ~ "unsatisfied",
    season_outcome == -1 ~ "somewhat unsatisfied",
    season_outcome == 0 ~ "neutral",
    season_outcome == 1 ~ "somewhat satisfied",
    season_outcome == 2 ~ "satisfied",
    season_outcome == 3 ~ "very satisfied"),
    provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    share_affiliation_others = case_when(
      share_affiliation_others == -3 ~ "strongly disagree",
      share_affiliation_others == -2 ~ "disagree",
      share_affiliation_others == -1 ~ "somewhat disagree",
      share_affiliation_others == 0 ~ "neutral",
      share_affiliation_others == 1 ~ "somewhat agree",
      share_affiliation_others == 2 ~ "agree",
      share_affiliation_others == 3 ~ "strongly agree"),
    provides_role_models = case_when(
      provides_role_models == -3 ~ "strongly disagree",
      provides_role_models == -2 ~ "disagree",
      provides_role_models == -1 ~ "somewhat disagree",
      provides_role_models == 0 ~ "neutral",
      provides_role_models == 1 ~ "somewhat agree",
      provides_role_models == 2 ~ "agree",
      provides_role_models == 3 ~ "strongly agree"),
    team_plays_aggress = case_when(
      team_plays_aggress == -3 ~ "strongly disagree",
      team_plays_aggress == -2 ~ "disagree",
      team_plays_aggress == -1 ~ "somewhat disagree",
      team_plays_aggress == 0 ~ "neutral",
      team_plays_aggress == 1 ~ "somewhat agree",
      team_plays_aggress == 2 ~ "agree",
      team_plays_aggress == 3 ~ "strongly agree"),
    merch_staff_satisfaction = case_when(
      merch_staff_satisfaction == 1 ~ "very unsatisfied",
      merch_staff_satisfaction == 2 ~ "unsatisfied",
      merch_staff_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_staff_satisfaction == 4 ~ "neutral",
      merch_staff_satisfaction == 5 ~ "somewhat satisfied",
      merch_staff_satisfaction == 6 ~ "satisfied",
      merch_staff_satisfaction == 7 ~ "very satisfied"),
    merch_variety_satisfaction = case_when(
      merch_variety_satisfaction == 1 ~ "very unsatisfied",
      merch_variety_satisfaction == 2 ~ "unsatisfied",
      merch_variety_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_variety_satisfaction == 4 ~ "neutral",
      merch_variety_satisfaction == 5 ~ "somewhat satisfied",
      merch_variety_satisfaction == 6 ~ "satisfied",
      merch_variety_satisfaction == 7 ~ "very satisfied"),
    overall_match_day_experience = case_when(
      overall_match_day_experience == 1 ~ "very unsatisfied",
      overall_match_day_experience == 2 ~ "unsatisfied",
      overall_match_day_experience == 3 ~ "somewhat unsatisfied",
      overall_match_day_experience == 4 ~ "neutral",
      overall_match_day_experience == 5 ~ "somewhat satisfied",
      overall_match_day_experience == 6 ~ "satisfied",
      overall_match_day_experience == 7 ~ "very satisfied"),
    arena_staff_friendliness = case_when(
      arena_staff_friendliness == 1 ~ "very unsatisfied",
      arena_staff_friendliness == 2 ~ "unsatisfied",
      arena_staff_friendliness == 3 ~ "somewhat unsatisfied",
      arena_staff_friendliness == 4 ~ "neutral",
      arena_staff_friendliness == 5 ~ "somewhat satisfied",
      arena_staff_friendliness == 6 ~ "satisfied",
      arena_staff_friendliness == 7 ~ "very satisfied"),
    entering_stadium = case_when(
      entering_stadium == 1 ~ "very unsatisfied",
      entering_stadium == 2 ~ "unsatisfied",
      entering_stadium == 3 ~ "somewhat unsatisfied",
      entering_stadium == 4 ~ "neutral",
      entering_stadium == 5 ~ "somewhat satisfied",
      entering_stadium == 6 ~ "satisfied",
      entering_stadium == 7 ~ "very satisfied"),
    merch_price_satisfaction = case_when(
      merch_price_satisfaction == 1 ~ "very unsatisfied",
      merch_price_satisfaction == 2 ~ "unsatisfied",
      merch_price_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_price_satisfaction == 4 ~ "neutral",
      merch_price_satisfaction == 5 ~ "somewhat satisfied",
      merch_price_satisfaction == 6 ~ "satisfied",
      merch_price_satisfaction == 7 ~ "very satisfied"),
    merch_retail_convenience_satisfaction  = case_when(
      merch_retail_convenience_satisfaction == 1 ~ "very unsatisfied",
      merch_retail_convenience_satisfaction == 2 ~ "unsatisfied",
      merch_retail_convenience_satisfaction == 3 ~ "somewhat unsatisfied",
      merch_retail_convenience_satisfaction == 4 ~ "neutral",
      merch_retail_convenience_satisfaction == 5 ~ "somewhat satisfied",
      merch_retail_convenience_satisfaction == 6 ~ "satisfied",
      merch_retail_convenience_satisfaction == 7 ~ "very satisfied"),
    intend_buy_merch  = case_when(
      intend_buy_merch == -3 ~ "strongly disagree",
      intend_buy_merch == -2 ~ "disagree",
      intend_buy_merch == -1 ~ "somewhat disagree",
      intend_buy_merch == 0 ~ "neutral",
      intend_buy_merch == 1 ~ "somewhat agree",
      intend_buy_merch == 2 ~ "agree",
      intend_buy_merch == 3 ~ "strongly agree")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId)
    
#vtable(outcome_correlations_df)
```

### Analyze variables correlated with season performance satisfaction

```{r}
# look at data types
performance_df  %>%
	inspect_types() %>%
	show_plot()
```


```{r}
# create customized theme function starting with theme_classic()
clean_theme <- theme_classic() +
  theme(legend.direction = "horizontal", # create horizontal legend
        legend.position = "bottom", # put legend at bottom of graph
        legend.justification='left', # align legend to the left
        legend.title = element_blank(), # remove legend title
        axis.line.y = element_blank(), # remove y-axis line
        axis.ticks.y = element_blank(), # remove y-axis ticks
        axis.ticks.x = element_blank(), # remove x-axis ticks
        plot.title = element_text(face = "bold", size = 15)) # make graph title bold and a larger font
```

####  happy_about_2016_season and season_performance

```{r}
performance_df %>%
  group_by(happy_about_2016_season) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very unhappy
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(happy_about_2016_season != "very unhappy") %>%
  group_by(happy_about_2016_season) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(happy_about_2016_season, average_satisfaction), y = average_satisfaction, fill = happy_about_2016_season )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - seems not to be a good indicator
  
####  disappointed_with_2016_season and season_outcome

```{r}
performance_df %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(outcome_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disappointed
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(disappointed_with_2016_season != "very disappointed") %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(disappointed_with_2016_season, average_satisfaction), y = average_satisfaction, fill = disappointed_with_2016_season )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - does not seem to be a good indicator


####  season_performance and season_outcome

```{r}
performance_df %>%
  group_by(season_outcome) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very unsatisfied and unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(season_outcome != "very unsatisfied", season_outcome != "very unsatisfied") %>%
  group_by(season_outcome) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(season_outcome, average_satisfaction), y = average_satisfaction, fill = season_outcome )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - does not seem to be a good indicator

####  provides_excitement and season_performance

```{r}
performance_df %>%
  group_by(provides_excitement) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(provides_excitement != "disagree", provides_excitement != "somewhat disagree", provides_excitement != "neutral") %>%
  group_by(provides_excitement) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_satisfaction), y = average_satisfaction, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - might be an okay indicator, hard to tell from here

####  players_are_skilled and season_performance

```{r}
performance_df %>%
  group_by(players_are_skilled) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - too many small sample sizes for groups other than agree somewhat agree and strongly disagree

  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(players_are_skilled != "disagree", players_are_skilled != "somewhat disagree", players_are_skilled != "unsatisfied", players_are_skilled != "strongly disagree")%>%
  group_by(players_are_skilled) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, average_satisfaction), y = average_satisfaction, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


####  share_affiliation_others and season_performance

```{r}
performance_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(share_affiliation_others %in% c("agree", "neutral", "somewhat agree", "strongly agree")) %>%
  group_by(share_affiliation_others) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, average_satisfaction), y = average_satisfaction, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - might be an okay indicator, hard to tell from here

####  provides_role_models and season_performance

```{r}
performance_df %>%
  group_by(provides_role_models) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(provides_role_models %in% c("agree", "neutral", "somewhat agree", "strongly agree")) %>%
  group_by(provides_role_models) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(provides_role_models, average_satisfaction), y = average_satisfaction, fill = provides_role_models )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


####  team_plays_aggress and season_performance

```{r}
performance_df %>%
  group_by(team_plays_aggress) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(team_plays_aggress %in% c("agree", "neutral", "somewhat agree", "strongly agree")) %>%
  group_by(team_plays_aggress) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(team_plays_aggress, average_satisfaction), y = average_satisfaction, fill = team_plays_aggress )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator



####  intend_buy_merch and season_performance

```{r}
performance_df %>%
  group_by(intend_buy_merch) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(intend_buy_merch %in% c("agree", "neutral", "somewhat agree", "strongly agree")) %>%
  group_by(intend_buy_merch) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, average_satisfaction), y = average_satisfaction, fill = intend_buy_merch )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


####  merch_staff_satisfaction and season_performance

```{r}
performance_df %>%
  group_by(merch_staff_satisfaction) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(merch_staff_satisfaction %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(merch_staff_satisfaction) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(merch_staff_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_staff_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator

####  merch_variety_satisfaction and season_performance

```{r}
performance_df %>%
  group_by(merch_variety_satisfaction) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(merch_variety_satisfaction != "unsatisfied", merch_variety_satisfaction != "very unsatisfied") %>%
  group_by(merch_variety_satisfaction) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(merch_variety_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_variety_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator

####  overall_match_day_experience and season_performance

```{r}
performance_df %>%
  group_by(overall_match_day_experience) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(overall_match_day_experience %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(overall_match_day_experience) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(overall_match_day_experience, average_satisfaction), y = average_satisfaction, fill = overall_match_day_experience )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator



####  arena_staff_friendliness and season_performance

```{r}
performance_df %>%
  group_by(arena_staff_friendliness) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(arena_staff_friendliness %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(arena_staff_friendliness) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(arena_staff_friendliness, average_satisfaction), y = average_satisfaction, fill = arena_staff_friendliness )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


####  entering_stadium and season_performance

```{r}
performance_df %>%
  group_by(entering_stadium) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(entering_stadium %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(entering_stadium) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(entering_stadium, average_satisfaction), y = average_satisfaction, fill = entering_stadium )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


####  merch_price_satisfaction and season_performance

```{r}
performance_df %>%
  group_by(merch_price_satisfaction) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(merch_price_satisfaction %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(merch_price_satisfaction) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(merch_price_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_price_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator

####  merch_retail_convenience_satisfaction and season_performance

```{r}
performance_df %>%
  group_by(merch_retail_convenience_satisfaction) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(performance_df)),
    average_satisfaction= median(season_performance))
```

  - small sample size for very disagree, somewhat disagree and neutral
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
performance_df %>%
  filter(merch_retail_convenience_satisfaction %in% c("satisfied", "neutral", "somewhat satisfied", "very satisfied")) %>%
  group_by(merch_retail_convenience_satisfaction) %>%
  summarise(average_satisfaction = median(season_performance)) %>%
  ggplot(mapping = aes(x = reorder(merch_retail_convenience_satisfaction, average_satisfaction), y = average_satisfaction, fill = merch_retail_convenience_satisfaction )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator


### Matchday satisfaction

Variables of interest:

  - overall_match_day_experience

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .3, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.3, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
```

`r  kbl(correlations_1) %>% kable_minimal(full_width = F, position = "left") `

+ create data set 

```{r}
# create df of variables correlated with attendance variables
matchday_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one)  %>%
  # drop Na's
  drop_na() 


vtable(matchday_correlations_df)

matchday_df <- matchday_correlations_df %>%
  mutate(provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    share_affiliation_others = case_when(
      share_affiliation_others == -3 ~ "strongly disagree",
      share_affiliation_others == -2 ~ "disagree",
      share_affiliation_others == -1 ~ "somewhat disagree",
      share_affiliation_others == 0 ~ "neutral",
      share_affiliation_others == 1 ~ "somewhat agree",
      share_affiliation_others == 2 ~ "agree",
      share_affiliation_others == 3 ~ "strongly agree"),
    provides_role_models = case_when(
      provides_role_models == -3 ~ "strongly disagree",
      provides_role_models == -2 ~ "disagree",
      provides_role_models == -1 ~ "somewhat disagree",
      provides_role_models == 0 ~ "neutral",
      provides_role_models == 1 ~ "somewhat agree",
      provides_role_models == 2 ~ "agree",
      provides_role_models == 3 ~ "strongly agree"),
    likely_support_2017 = case_when(
      likely_support_2017 == -3 ~ "strongly disagree",
      likely_support_2017 == -2 ~ "disagree",
      likely_support_2017 == -1 ~ "somewhat disagree",
      likely_support_2017 == 0 ~ "neutral",
      likely_support_2017 == 1 ~ "somewhat agree",
      likely_support_2017 == 2 ~ "agree",
      likely_support_2017 == 3 ~ "strongly agree"),
    support_woman_sport = case_when(
      support_woman_sport == -3 ~ "strongly disagree",
      support_woman_sport == -2 ~ "disagree",
      support_woman_sport == -1 ~ "somewhat disagree",
      support_woman_sport == 0 ~ "neutral",
      support_woman_sport == 1 ~ "somewhat agree",
      support_woman_sport == 2 ~ "agree",
      support_woman_sport == 3 ~ "strongly agree"),
    tickets_easy_get = case_when(
      tickets_easy_get == -3 ~ "strongly disagree",
      tickets_easy_get == -2 ~ "disagree",
      tickets_easy_get == -1 ~ "somewhat disagree",
      tickets_easy_get == 0 ~ "neutral",
      tickets_easy_get == 1 ~ "somewhat agree",
      tickets_easy_get == 2 ~ "agree",
      tickets_easy_get == 3 ~ "strongly agree"),
    entering_stadium = case_when(
      entering_stadium == 1 ~ "very unsatisfied",
      entering_stadium == 2 ~ "unsatisfied",
      entering_stadium == 3 ~ "somewhat unsatisfied",
      entering_stadium == 4 ~ "neutral",
      entering_stadium == 5 ~ "somewhat satisfied",
      entering_stadium == 6 ~ "satisfied",
      entering_stadium == 7 ~ "very satisfied"),
   arena_security = case_when(
      arena_security == 1 ~ "very unsatisfied",
      arena_security == 2 ~ "unsatisfied",
      arena_security == 3 ~ "somewhat unsatisfied",
      arena_security == 4 ~ "neutral",
      arena_security == 5 ~ "somewhat satisfied",
      arena_security == 6 ~ "satisfied",
      arena_security == 7 ~ "very satisfied"),
   arena_staff_friendliness = case_when(
      arena_staff_friendliness == 1 ~ "very unsatisfied",
      arena_staff_friendliness == 2 ~ "unsatisfied",
      arena_staff_friendliness == 3 ~ "somewhat unsatisfied",
      arena_staff_friendliness == 4 ~ "neutral",
      arena_staff_friendliness == 5 ~ "somewhat satisfied",
      arena_staff_friendliness == 6 ~ "satisfied",
      arena_staff_friendliness == 7 ~ "very satisfied"),
   overall_memorial_stadium_experience = case_when(
      overall_memorial_stadium_experience == 1 ~ "very unsatisfied",
      overall_memorial_stadium_experience == 2 ~ "unsatisfied",
      overall_memorial_stadium_experience == 3 ~ "somewhat unsatisfied",
      overall_memorial_stadium_experience == 4 ~ "neutral",
      overall_memorial_stadium_experience == 5 ~ "somewhat satisfied",
      overall_memorial_stadium_experience == 6 ~ "satisfied",
      overall_memorial_stadium_experience == 7 ~ "very satisfied")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId)
    
#vtable(outcome_correlations_df)
```

### Analyze variables correlated with performance satisfaction

```{r}
# look at data types
matchday_df  %>%
	inspect_types() %>%
	show_plot()
```

####  overall_memorial_stadium_experience and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(overall_memorial_stadium_experience) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - good sample size across variables, drop very unsatisfied 
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(overall_memorial_stadium_experience != "very unsatisfied") %>%
  group_by(overall_memorial_stadium_experience) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(overall_memorial_stadium_experience, average_satisfaction), y = average_satisfaction, fill = overall_memorial_stadium_experience )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator

####  arena_staff_friendliness and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(arena_staff_friendliness) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - good sample size across variables, drop very unsatisfied 
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(arena_staff_friendliness != "very unsatisfied") %>%
  group_by(arena_staff_friendliness) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(arena_staff_friendliness, average_satisfaction), y = average_satisfaction, fill = arena_staff_friendliness )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - good indicator
  
####  entering_stadium and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(entering_stadium) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - good sample size across variables, drop very unsatisfied 
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(entering_stadium != "very unsatisfied") %>%
  group_by(entering_stadium) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(entering_stadium, average_satisfaction), y = average_satisfaction, fill = entering_stadium )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator

####  arena_security and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(arena_security) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - good sample size across variables, drop very unsatisfied 
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(arena_security != "very unsatisfied", arena_security != "unsatisfied") %>%
  group_by(arena_security) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(arena_security, average_satisfaction), y = average_satisfaction, fill = arena_security )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator
  
  
####  support_woman_sport and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(support_woman_sport) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(support_woman_sport != "neutral", support_woman_sport != "somewhat disagree") %>%
  group_by(support_woman_sport) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(support_woman_sport, average_satisfaction), y = average_satisfaction, fill = support_woman_sport )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a very good indicator
  
####  share_affiliation_others and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(share_affiliation_others != "strongly disagree", share_affiliation_others != "somewhat disagree", share_affiliation_others != "disagree") %>%
  group_by(share_affiliation_others) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others, average_satisfaction), y = average_satisfaction, fill = share_affiliation_others )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a very good indicator  
  
  
####  players_are_skilled and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(players_are_skilled) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(players_are_skilled != "strongly disagree", players_are_skilled != "somewhat disagree", players_are_skilled != "disagree") %>%
  group_by(players_are_skilled) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, average_satisfaction), y = average_satisfaction, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a very good indicator  
  
####  provides_role_models and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(provides_role_models) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(provides_role_models != "strongly disagree", provides_role_models != "somewhat disagree", provides_role_models != "disagree") %>%
  group_by(provides_role_models) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(provides_role_models, average_satisfaction), y = average_satisfaction, fill = provides_role_models )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - looks like an okay indicator
  
  
####  likely_support_2017 and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(likely_support_2017) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(likely_support_2017 != "strongly disagree", likely_support_2017 != "somewhat disagree", likely_support_2017 != "disagree") %>%
  group_by(likely_support_2017) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017, average_satisfaction), y = average_satisfaction, fill = likely_support_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator
  
  
####  tickets_easy_get and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(tickets_easy_get) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(tickets_easy_get != "strongly disagree", tickets_easy_get != "somewhat disagree", tickets_easy_get != "disagree") %>%
  group_by(tickets_easy_get) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(tickets_easy_get, average_satisfaction), y = average_satisfaction, fill = tickets_easy_get )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator
 
####  provides_excitement and overall_match_day_experience

```{r}
matchday_df %>%
  group_by(provides_excitement) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    average_satisfaction= median(overall_match_day_experience))
```

  - small sample size for neutral and somewhat idsagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
matchday_df %>%
  filter(provides_excitement != "strongly disagree", provides_excitement != "somewhat disagree", provides_excitement != "disagree") %>%
  group_by(provides_excitement) %>%
  summarise(average_satisfaction = median(overall_match_day_experience)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_satisfaction), y = average_satisfaction, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#5D3FD3" ))
```

  - not a good indicator 
  
# Statistical EDA
 
####  arena_staff_friendliness and overall_match_day_experience

```{r}
# Linear regression with linear model
regression <- lm(overall_match_day_experience ~ arena_staff_friendliness, data = matchday_df)
# Review output
summary(regression)
```

  - small p-values for neutral, satisfied, unsatisfied, somewhat unsatisfied and very satisfied
  
```{r}
par(mfrow = c(1, 1))
plot(matchday_df$overall_match_day_experience, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - very satisfied, unsatisfied, satisfied, and neutral are all practically and statistically significant 
  
####  provides_role_models and overall_match_day_experience

```{r}
# Linear regression with linear model
regression <- lm(overall_match_day_experience ~ provides_role_models, data = matchday_df)
# Review output
summary(regression)
```

  - small p-values agree, disagree, neutral, somewhat agree, and strongly agree
  
```{r}
par(mfrow = c(1, 1))
plot(matchday_df$overall_match_day_experience, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - very satisfied, unsatisfied, satisfied, and neutral are all practically and statistically significant   
  
# Statistical EDA Conclusions: primary factors that impact satisfaction 

### Outcome satisfaction
  
Statistically and practically significant:

  - happy about 2016 season

### Matchday satisfaction 

Statistically and practically significant:

  - arena_staff_friendliness
  - provides_role_models
  
# Determine factors that impact Brand Attitude  

Variables of interest:

  - share_affiliation_others

**Create data set of correlations**

```{r}
# correlations
correlations <- numeric_data_set %>%
	inspect_cor() 
```


```{r}
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .3, col_1 == "share_affiliation_others" | col_2 == "share_affiliation_others")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.3, col_1 == "share_affiliation_others" | col_2 == "share_affiliation_others")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
```

`r  kbl(correlations_1) %>% kable_minimal(full_width = F, position = "left") `

+ create data set 

```{r}
# create df of variables correlated with attendance variables
attitude_corr_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one, support_woman_sport)  %>%
  # drop Na's
  drop_na() 


attitude_df <- attitude_corr_df %>%
  mutate(
    likely_support_2017 = case_when(
      likely_support_2017 == -3 ~ "strongly disagree",
      likely_support_2017 == -2 ~ "disagree",
      likely_support_2017 == -1 ~ "somewhat disagree",
      likely_support_2017 == 0 ~ "neutral",
      likely_support_2017 == 1 ~ "somewhat agree",
      likely_support_2017 == 2 ~ "agree",
      likely_support_2017 == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    support_woman_sport = case_when(
      support_woman_sport == -3 ~ "strongly disagree",
      support_woman_sport == -2 ~ "disagree",
      support_woman_sport == -1 ~ "somewhat disagree",
      support_woman_sport == 0 ~ "neutral",
      support_woman_sport == 1 ~ "somewhat agree",
      support_woman_sport == 2 ~ "agree",
      support_woman_sport == 3 ~ "strongly agree"),
    provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    overall_match_day_experience = case_when(
      overall_match_day_experience == 1 ~ "very unsatisfied",
      overall_match_day_experience == 2 ~ "unsatisfied",
      overall_match_day_experience == 3 ~ "somewhat unsatisfied",
      overall_match_day_experience == 4 ~ "neutral",
      overall_match_day_experience == 5 ~ "somewhat satisfied",
      overall_match_day_experience == 6 ~ "satisfied",
      overall_match_day_experience == 7 ~ "very satisfied"),
    real_fan = case_when(
      real_fan == -3 ~ "strongly disagree",
      real_fan == -2 ~ "disagree",
      real_fan == -1 ~ "somewhat disagree",
      real_fan == 0 ~ "neutral",
      real_fan == 1 ~ "somewhat agree",
      real_fan == 2 ~ "agree",
      real_fan == 3 ~ "strongly agree"),
    coach_fan = case_when(
      coach_fan == -3 ~ "strongly disagree",
      coach_fan == -2 ~ "disagree",
      coach_fan == -1 ~ "somewhat disagree",
      coach_fan == 0 ~ "neutral",
      coach_fan == 1 ~ "somewhat agree",
      coach_fan == 2 ~ "agree",
      coach_fan == 3 ~ "strongly agree"),
    wish_werent_fan = case_when(
      wish_werent_fan == -3 ~ "strongly disagree",
      wish_werent_fan == -2 ~ "disagree",
      wish_werent_fan == -1 ~ "somewhat disagree",
      wish_werent_fan == 0 ~ "neutral",
      wish_werent_fan == 1 ~ "somewhat agree",
      wish_werent_fan == 2 ~ "agree",
      wish_werent_fan == 3 ~ "strongly agree"),
    Interest = case_when(
      Interest == 1 ~ "I have a small amount of interest",
      Interest == 2 ~ "I consider myself to be a low-level fan of this team",
      Interest == 3 ~ "I consider myself to be a moderate fan of this team",
      Interest == 4 ~ "I consider myself to be a loyal fan of this team",
      Interest == 5 ~ "I live and die with this team")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId, -intend_buy_merch, -merch_staff_satisfaction, -merch_retail_convenience_satisfaction)
    
#vtable(attitude_df)
```


### Determine ways to increase brand attitude.

```{r}
# look at data types
attitude_df  %>%
	inspect_types() %>%
	show_plot()
```


```{r}
# create customized theme function starting with theme_classic()
clean_theme <- theme_classic() +
  theme(legend.direction = "horizontal", # create horizontal legend
        legend.position = "bottom", # put legend at bottom of graph
        legend.justification='left', # align legend to the left
        legend.title = element_blank(), # remove legend title
        axis.line.y = element_blank(), # remove y-axis line
        axis.ticks.y = element_blank(), # remove y-axis ticks
        axis.ticks.x = element_blank(), # remove x-axis ticks
        plot.title = element_text(face = "bold", size = 15)) # make graph title bold and a larger font
```

####  likely_support_2017 and BIRG

```{r}
attitude_df %>%
  group_by(likely_support_2017) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for very disagree, neutral, and strongly disagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(likely_support_2017 %in% c("agree", "somewhat agree", "strongly agree")) %>%
  group_by(likely_support_2017) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017, average_satisfaction), y = average_satisfaction, fill = likely_support_2017 )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  -   appears to be a good indicator
  

  
####  real_fan and BIRG

```{r}
attitude_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for very unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(real_fan %in% c("agree", "somewhat agree", "strongly agree", "neutral")) %>%
  group_by(real_fan) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(real_fan, average_satisfaction), y = average_satisfaction, fill = real_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a great indicator
  
  
####  coach_fan and BIRG

```{r}
attitude_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for very unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(coach_fan %in% c("agree", "somewhat agree", "strongly agree", "neutral")) %>%
  group_by(coach_fan) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(coach_fan, average_satisfaction), y = average_satisfaction, fill = coach_fan )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a great indicator  
   

####  players_are_skilled and BIRG

```{r}
attitude_df %>%
  group_by(players_are_skilled) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for very unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(players_are_skilled != "disagree", players_are_skilled != "somewhat disagree", players_are_skilled != "strongly disagree") %>%
  group_by(players_are_skilled) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(players_are_skilled, average_satisfaction), y = average_satisfaction, fill = players_are_skilled )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a great indicator
  
    
####  provides_excitement and BIRG

```{r}
attitude_df %>%
  group_by(provides_excitement) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for very unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(provides_excitement != "disagree", provides_excitement != "somewhat disagree", provides_excitement != "neutral") %>%
  group_by(provides_excitement) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(provides_excitement, average_satisfaction), y = average_satisfaction, fill = provides_excitement )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a great indicator  
     
####  wish_werent_fan and BIRG

```{r}
attitude_df %>%
  group_by(wish_werent_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for most categories 

####  Interest and BIRG

```{r}
attitude_df %>%
  group_by(Interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for I have a small amount of interest
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(Interest != "I have a small amount of interest") %>%
  group_by(Interest) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(Interest, average_satisfaction), y = average_satisfaction, fill = Interest )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - appears to be a good indicator
  
####  intended_num_matches_attend_2017 and BIRG

```{r}
attitude_df %>%
  ggplot(aes(x = intended_num_matches_attend_2017, y = share_affiliation_others)) +
  geom_point()
```

+ appears to be a good indicator

####  num_matches_attend_2016 and BIRG

```{r}
attitude_df %>%
  ggplot(aes(x = num_matches_attend_2016, y = share_affiliation_others)) +
  geom_point()
```

+ appears to be a good indicator
  
  
####  overall_match_day_experience and BIRG

```{r}
attitude_df %>%
  group_by(overall_match_day_experience) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for somewhat unsatisfied, unsatisfied, and unsatisfied
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(overall_match_day_experience != "somewhat unsatisfied", overall_match_day_experience != "very unsatisfied", overall_match_day_experience != "unsatisfied") %>%
  group_by(overall_match_day_experience) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(overall_match_day_experience, average_satisfaction), y = average_satisfaction, fill = overall_match_day_experience )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - not a good indicator  
  

####  support_woman_sport and BIRG

```{r}
attitude_df %>%
  group_by(support_woman_sport) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    average_satisfaction= median(share_affiliation_others))
```

  - small sample size for neutral and somewhat disagree
  
```{r}
# ticket ttypes used in 2016 and number of matches planned on attend ing in 2017
attitude_df %>%
  filter(support_woman_sport != "neutral", support_woman_sport != "somewhat disagree") %>%
  group_by(support_woman_sport) %>%
  summarise(average_satisfaction = median(share_affiliation_others)) %>%
  ggplot(mapping = aes(x = reorder(support_woman_sport, average_satisfaction), y = average_satisfaction, fill = support_woman_sport )) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  coord_flip() + 
  clean_theme +
  theme(axis.line.y = element_blank()) +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED"))
```

  - appears to be a good indicator  
  
  
# Statistical EDA 

####  support_woman_sport and BIRG1

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ support_woman_sport, data = attitude_df)
# Review output
summary(regression)
```

  - large p-values, not statistically significant
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - not practically or statistically significant      

####  num_matches_attend_2016 and BIRG

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ num_matches_attend_2016, data = attitude_df)
# Review output
summary(regression)
```

  - small p-values 
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```
  
  - statistically, but not practically significant

####  intended_num_matches_attend_2017 and BIRG

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ intended_num_matches_attend_2017, data = attitude_df)
# Review output
summary(regression)
```

  - small p-values, statistically significant
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - statistically and practically significant

####  Interest and BIRG

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ Interest, data = attitude_df)
# Review output
summary(regression)
```

  - small p-values for loyal fan, moderate fan, and die-hard fan
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - practically and statistically significant

####  real_fan and BIRG

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ real_fan, data = attitude_df)
# Review output
summary(regression)
```

  - small p-values for all 
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  - all are statistically and practically significant

####  likely_support_2017 and BIRG

```{r}
# Linear regression with linear model
regression <- lm(share_affiliation_others ~ likely_support_2017, data = attitude_df)
# Review output
summary(regression)
```

  - small p-values for all
  
```{r}
par(mfrow = c(1, 1))
plot(attitude_df$share_affiliation_others, regression$residuals)
```


```{r}
 
# Pull out the coefficients and confidence interval for table and graph
coe <- summary(regression)$coefficients # get coefficients and related stats
coe_CI <- as.data.frame(cbind(coe[, ], confint(regression)[, ])) # find and bind CI, remove Intercept 

# Rename results data frame
names(coe_CI) <- c("estimate", "se", "t", "pval","low_CI","high_CI") 

htmlTable(round(coe_CI[order(coe_CI$pval, decreasing = FALSE), ], 3))
```

```{r}
# Cleveland dot plot of results
ggplot(coe_CI, aes(x = estimate, y = row.names(coe_CI))) +
  geom_point(size = 3) +
  xlim(min(coe_CI$low_CI), max(coe_CI$high_CI)) +
  ylab("Variable") +
  xlab("Coefficient") +
  theme_bw()+
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(pval))), 
               xend = coe_CI$high_CI, color = "Blue") +
  geom_segment(aes(yend = reorder(row.names(coe_CI),desc(coe_CI$pval))), 
               xend = coe_CI$low_CI, color = "Blue") +
   xlab("Coefficient with Confidence Interval")+
  geom_vline(xintercept = 0, color = "red")
```

  -  all are statistically and practically significant
  
# Statistical EDA Conclusions: ways to increase brand attitude
  
Statistically and practically significant:

  - Likely Support
  - real_fan
  - Interest
  - intended_num_matches_attend_2017
  - support_woman_sport

# Create Professional Visuals

```{r}
# correlations
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with intended_num_matches_attend_2017
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intended_num_matches_attend_2017" | col_2 == "intended_num_matches_attend_2017")
# create table of correlations
attendance_correlations_1 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)

# find positive correlations greater than .2 with attend_2017
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "attend_2017" | col_2 == "attend_2017")
# find negative correlations less than -.2 with attend_2017
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "attend_2017" | col_2 == "attend_2017")
# create table of correlations
attendance_correlations_2 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)


# find positive correlations greater than .2 with ever_attend_match
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "ever_attend_match" | col_2 == "ever_attend_match")
# find negative correlations less than -.2 with ever_attend_match
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "ever_attend_match" | col_2 == "ever_attend_match")
# create table of correlations
attendance_correlations_3 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)

# find positive correlations greater than .2 with intend_season_ticket
attendance_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "intend_season_ticket" | col_2 == "intend_season_ticket")
# find negative correlations less than -.2 with intend_season_ticket
attendance_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "intend_season_ticket" | col_2 == "intend_season_ticket")
# create table of correlations
attendance_correlations_4 <- bind_rows(attendance_positive_correlations,attendance_negative_correlations)

# create vector of correlated variables
one <- c(attendance_correlations_1$col_1, attendance_correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(attendance_correlations_2$col_1, attendance_correlations_2$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of correlated variables
three <- c(attendance_correlations_3$col_1, attendance_correlations_3$col_2)
# drop duplicate variables
three <- unique(three)
# create vector of correlated variables
four <- c(attendance_correlations_4$col_1, attendance_correlations_4$col_2)
# drop duplicate variables
four <- unique(four)
# create vector of all correlations
all_together <- c(one, two, three, four)
# drop duplicate variables
variables <- unique(all_together)


# create df of variables correlated with attendance variables
attendance_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables, distance_traveled, age)  %>%
  # drop Na's
  drop_na()

vars_1 <- copy_of_data %>%
  select(ResponseId, race, education, most_ideal_time)

attendance_correlations_df <- left_join(attendance_correlations_df, vars_1, by = "ResponseId")

# look at data
#vtable(attendance_correlations_df)
# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId, IDteam1,Attend17,  Support1, BIRG1, Buymer1, IDcoach1, IDcomm2, Spnbuy7, Mersat25, Spnbuy9, Ticket1, Skill2, Starfir1, CORF1, lasttype, Interest, Matchsat, Spnbuy4, Income, Marital, Email1)

# mutate values
variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "Not at all likely to consider them when making a purchase decision 1", "definitely would not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "Extremely likely to consider them when making a purchase decision 7", "definitely would consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "2", "would not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "3", "might not consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "6", "would consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "5", "might consider"))) %>%
  mutate(across(c("Spnbuy7", "Spnbuy9", "Spnbuy4"), ~ str_replace(., "4", "neutral"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "6", "Satisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "5", "Somewhat Satisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "4", "Neutral"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "3", "Somewhat Dissatisfied"))) %>%
  mutate(across(c("Mersat25", "Matchsat"), ~ str_replace(., "2", "Dissatisfied"))) 
#add columns to attendance data set
attendance <- left_join(attendance_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
attendance_df <- attendance %>%
  mutate(attend_2017 = Attend17,
         real_fan = IDteam1,
         likely_support_2017 = Support1,
         share_affiliation_others = BIRG1,
         intend_buy_merch   = Buymer1,
         coach_fan = IDcoach1,
         feel_part_of_community_fan = IDcomm2,
         consider_health_warrior = Spnbuy7,
         merch_staff_satisfaction = Mersat25,
         consider_kraken_congee = Spnbuy9,
         tickets_easy_get = Ticket1,
         players_are_skilled = Skill2,
         prefer_starfire_staidum = Starfir1,
         wish_werent_fan = CORF1,
         ticket_type_used_2016 = lasttype,
         interest   = Interest.y,
         overall_match_day_experience = Matchsat,
         consider_becu = Spnbuy4,
         income = Income,
         marriage_status = Marital,
         want_more_emails = Email1) %>%
  select(-c(Attend17, IDteam1, Support1, BIRG1, Buymer1, IDcoach1, IDcomm2, Spnbuy7, Mersat25, Spnbuy9, Ticket1, Skill2, Starfir1, CORF1, lasttype, Interest.x, Interest.y, Matchsat, Spnbuy4, Income, Marital, Email1)) %>%
  mutate(intend_season_ticket = 
          case_when(
            intend_season_ticket == 1 ~ "Yes",
            intend_season_ticket == 0 ~ "No"),
        prefer_jackets = 
          case_when(
            prefer_jackets == 1 ~ "Yes",
            prefer_jackets == 0 ~ "No"),
        prefer_short_sleeve_shirts = 
          case_when(
            prefer_short_sleeve_shirts == 1 ~ "Yes",
            prefer_short_sleeve_shirts == 0 ~ "No"),
        prefer_accessories = 
          case_when(
            prefer_accessories == 1 ~ "Yes",
            prefer_accessories == 0 ~ "No"),
        prefer_long_sleeve_shirts= 
          case_when(
            prefer_long_sleeve_shirts == 1 ~ "Yes",
            prefer_long_sleeve_shirts == 0 ~ "No"),
        intend_single_match = 
          case_when(
            intend_single_match == 1 ~ "Yes",
            intend_single_match == 0 ~ "No"),
        ever_attend_match = 
          case_when(
            ever_attend_match == 1 ~ "Yes",
            ever_attend_match == 0 ~ "No"),
        att_game_with_friends = 
          case_when(
            att_game_with_friends == 1 ~ "Yes",
            att_game_with_friends == 0 ~ "No"),
        att_game_with_family = 
          case_when(
            att_game_with_family == 1 ~ "Yes",
            att_game_with_family == 0 ~ "No")) %>%
    mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId, -attend_match_2016, -intend_undecided_ticket) 

```


interest
community affect
intent to buy merch
support for the team
season ticket
number of matches attended last year


  - interest

## Interest

```{r}

df_1 <- attendance_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_intended_matches = as.integer(median(intended_num_matches_attend_2017)))

memoplot1 <- df_1 %>%
  ggplot(mapping = aes(x = reorder(interest, avg_intended_matches), y = avg_intended_matches, fill = interest)) +
  clean_theme +
  labs(title = "Interest Impacts Attendance Intentions", y = "Average Intended Match Attendance 2017", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
 # geom_text(aes(label= avg_intended_matches), position=position_dodge(width=0.9), hjust = 1.5, vjust=.5,size=5, colour="black", fontface = "bold") +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
memoplot1
```

  - intent to buy merch

```{r}

df_2 <- attendance_df %>%
  group_by(intend_buy_merch) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017))  %>%
  filter(count > 8)

df_2$intend_buy_merch <- factor(df_2$intend_buy_merch, levels = c("Strongly agree", "Agree",  "Somewhat agree", "Neutral"))

merch_intent <- df_2 %>%
  ggplot(mapping = aes(x = reorder(intend_buy_merch, avg_num_matches_2017), y = avg_num_matches_2017, fill = intend_buy_merch)) +
  clean_theme +
  labs(title = "Intentions to Purchase Merchandise \nImpact Attendance Intentions", y = "Average Intended Match Attendance 2017", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

merch_intent
```

- likely_support_2017

```{r}
df_3 <- attendance_df %>%
  #filter(interest != "I have a small amount of interest") %>%
  #filter(feel_part_of_community_fan != "Somewhat disagree",feel_part_of_community_fan != "Strongly Disagree") %>%
  group_by(likely_support_2017) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017)) %>%
  filter(count > 3)

df_3$likely_support_2017 <- factor(df_3$likely_support_2017, levels = c("Strongly agree", "Agree",  "Somewhat agree"))

support <- df_3 %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017,avg_num_matches_2017) , y = avg_num_matches_2017, fill = likely_support_2017)) +
  clean_theme +
  labs(title = "Team Support Impacts Attendance Intentions", y = "Average Intended Match Attendance 2017", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" )) 

support
```
 
  - season ticket

```{r}
df_4 <- attendance_df %>%
  group_by(intend_season_ticket) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017)) 


df_4$intend_season_ticket <- factor(df_4$intend_season_ticket, levels = c("Yes", "No"))

season_ticket <- df_4 %>%
  ggplot(mapping = aes(x = reorder(intend_season_ticket,avg_num_matches_2017) , y = avg_num_matches_2017, fill = intend_season_ticket)) +
  clean_theme +
  labs(title = "Planning to use Season Tickets \nImpacts Attendance Intentions", y = "Average Intended Match Attendance 2017", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

season_ticket
```


```{r}
df_4 <- attendance_df %>%
  group_by(intend_season_ticket) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attendance_df)),
    avg_num_matches_2017 = median(intended_num_matches_attend_2017)) 


df_4$intend_season_ticket <- factor(df_4$intend_season_ticket, levels = c("Yes", "No"))

memoplot2 <- attendance_df %>%
  filter(ticket_type_used_2016 %in% c("Season Ticket", "Single Match", "5 Match Pack")) %>%
  ggplot(mapping = aes(x = num_matches_attend_2016 , y = intended_num_matches_attend_2017, color = ticket_type_used_2016)) +
  clean_theme +
  labs(title = "Attendance in 2016 Impacts Attendance Intentions", y = "Average Intended Match Attendance 2017", x = "Matches Attended in 2016") +
  geom_point() +
  coord_flip() + 
  clean_theme +
  scale_color_manual(values = c("Season Ticket" = "magenta", "Single Match" = "#0818A8", "5 Match Pack" = "green")) +
  theme(
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ),
        axis.text.y = element_text(color = "#808080" ),
        axis.title.y =  element_text(color = "#808080" )) 


memoplot2
```  
  

# Media Consuption

```{r}
# correlations
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with website_visits
website_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "website_visits" | col_2 == "website_visits")
# find negative correlations less than -.2 with website_visits
website_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "website_visits" | col_2 == "website_visits")
# create table of correlations
website_correlations <- bind_rows(website_positive_correlations,website_negative_correlations)

# find positive correlations greater than .2 with facebook_visits
facebook_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "facebook_visits" | col_2 == "facebook_visits")
# find negative correlations less than -.2 with facebook_visits
facebook_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "facebook_visits" | col_2 == "facebook_visits")
# create table of correlations
facebook_correlations <- bind_rows(facebook_positive_correlations,facebook_negative_correlations)

# find positive correlations greater than .2 with twitter_visits
twitter_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "twitter_visits" | col_2 == "twitter_visits")
# find negative correlations less than -.2 with twitter_visits
twitter_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "twitter_visits" | col_2 == "twitter_visits")
# create table of correlations
twitter_correlations <- bind_rows(twitter_positive_correlations,twitter_negative_correlations)


# find positive correlations greater than .2 with instagram_visits
ig_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "instagram_visits" | col_2 == "instagram_visits")
# find negative correlations less than -.2 with instagram_visits
ig_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "instagram_visits" | col_2 == "instagram_visits")
# create table of correlations
ig_correlations <- bind_rows(ig_positive_correlations,ig_negative_correlations)

# find positive correlations greater than .2 with youtube_visits
yt_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "youtube_visits" | col_2 == "youtube_visits")
# find negative correlations less than -.2 with youtube_visits
yt_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "youtube_visits" | col_2 == "youtube_visits")
# create table of correlations
yt_correlations <- bind_rows(yt_positive_correlations,yt_negative_correlations)

# find positive correlations greater than .2 with num_read_about_team_newspaper_digital_media
digmed_positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "num_read_about_team_newspaper_digital_media" | col_2 == "num_read_about_team_newspaper_digital_media")
# find negative correlations less than -.2 with num_read_about_team_newspaper_digital_media
digmed_negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "num_read_about_team_newspaper_digital_media" | col_2 == "num_read_about_team_newspaper_digital_media")
# create table of correlations
digmed_correlations <- bind_rows(digmed_positive_correlations,digmed_negative_correlations)

# create vector of correlated variables
one <- c(website_correlations$col_1, website_correlations$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(facebook_correlations$col_1, facebook_correlations$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of correlated variables
three <- c(twitter_correlations$col_1, twitter_correlations$col_2)
# drop duplicate variables
three <- unique(three)
# create vector of correlated variables
four <- c(ig_correlations$col_1, ig_correlations$col_2)
# drop duplicate variables
four <- unique(four)
# create vector of correlated variables
five <- c(yt_correlations$col_1, yt_correlations$col_2)
# drop duplicate variables
five <- unique(five)
# create vector of correlated variables
six <- c(digmed_correlations$col_1, digmed_correlations$col_2)
# drop duplicate variables
six <- unique(six)

# create vector of all correlations
all_together <- c(one, two, three, four, five, six)
# drop duplicate variables
variables <- unique(all_together)

# create df of variables correlated with attendance variables
media_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables)  %>%
  # drop Na's
  drop_na()

# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId, Email1, Interest, BIRG1, IDteam1, Buymer1, IDcoach1, Media7a, Media6, Starfir1, Media7b, lasttype, Gender, HopeS1, Escape1, Drama4, Attend1)

# mutate values
variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Has no influence on my attendance  0", "0"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Has a positive influence on my attendance 3", "3"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~ str_replace(., "Had a negative influence on my attendance -3", "-3"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "0", "no influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-3", "very negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-2", "negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "-1", "slightly negative influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "3", "very positive influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "2", "positive influence"))) %>%
  mutate(across(c("Media7a", "Media7b", "Media6"), ~str_replace(., "1", "slightly positive influence"))) 
  
#add columns to attendance data set
media <- left_join(media_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
media_df <- media %>%
  mutate(
    want_more_emails = Email1,
    interest = Interest.y,
    share_affiliation_others = BIRG1,
    real_fan = IDteam1,
    intend_buy_merch = Buymer1,
    coach_fan = IDcoach1,
    facebook_post_influence = Media7a,
    internet_ads_influence = Media6,
    prefer_starfire_staidum = Starfir1,
    twitter_post_influence = Media7b,
    ticket_type_used_2016 = lasttype,
    gender = Gender,
    hope_solo_fan = HopeS1,
    provide_escape = Escape1,
    provides_excitement = Drama4,
    ever_attend_match = Attend1) %>%
  group_by(ResponseId) %>%
  mutate(
    weekly_media_consumption = (youtube_visits + website_visits + facebook_visits + twitter_visits + instagram_visits + num_read_about_team_newspaper_digital_media)) %>%
  ungroup() %>%
  select(-c(ResponseId, Email1, Interest.x, Interest.y, BIRG1, IDteam1, Buymer1, IDcoach1, Media7a, Media6, Starfir1, Media7b, lasttype, Gender, HopeS1, Escape1, Drama4, Attend1, consider_kraken_congee, youtube_visits, website_visits, facebook_visits, twitter_visits, instagram_visits, num_read_about_team_newspaper_digital_media)) %>%
  mutate(across(where(is.character), as.factor)) 
```


Interest

```{r}
df5 <- media_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    weekly_media = median(weekly_media_consumption))  %>%
  filter(count >3)

memoplot5 <- df5 %>%
  ggplot(mapping = aes(x = reorder(interest,weekly_media) , y = weekly_media, fill = interest)) +
  clean_theme +
  labs(title = "Interest impacts media consumption", y = "Average Weekly Media Visits", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

memoplot5
```

Share affiliation other


```{r}
df6 <- media_df %>%
  group_by(share_affiliation_others) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    weekly_media = median(weekly_media_consumption)) %>%
  filter(count >13)

birg_media <- df6 %>%
  ggplot(mapping = aes(x = reorder(share_affiliation_others,weekly_media) , y = weekly_media, fill = share_affiliation_others)) +
  clean_theme +
  labs(title = "A desire to share team affiliation with \nothers impacts media consumption", y = "Average Weekly Media Visits", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

birg_media
```


Real fan

```{r}
df7 <- media_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    weekly_media = median(weekly_media_consumption)) %>%
  filter(count >10)

memoplot3 <- df7 %>%
  ggplot(mapping = aes(x = reorder(real_fan,weekly_media) , y = weekly_media, fill = real_fan)) +
  clean_theme +
  labs(title = "Being a 'real fan' impacts media consumption", y = "Average Weekly Media Visits", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

memoplot3
```


Coach fan

```{r}
df8 <- media_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(media_df)),
    weekly_media = median(weekly_media_consumption)) %>%
  filter(count >10)

memoplot4 <- df8 %>%
  ggplot(mapping = aes(x = reorder(coach_fan,weekly_media) , y = weekly_media, fill = coach_fan)) +
  clean_theme +
  labs(title = "Being a fan of Coach Laura Harvey \nimpacts media consumption", y = "Average Weekly Media Visits", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

memoplot4
```


# merch



```{r}
# correlations
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .3, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.3, col_1 == "intend_buy_merch" | col_2 == "intend_buy_merch")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)

# find positive correlations greater than .2 with attend_2017
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "spend_2016" | col_2 == "spend_2016")
# find negative correlations less than -.2 with attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "spend_2016" | col_2 == "spend_2016")
# create table of correlations
correlations_2 <- bind_rows(positive_correlations, negative_correlations)

# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
# create vector of correlated variables
two <- c(correlations_2$col_1, correlations_2$col_2)
# drop duplicate variables
two <- unique(two)
# create vector of all correlations
all_together <- c(one, two)
# drop duplicate variables
variables <- unique(all_together)

# create df of variables correlated with attendance variables
merch_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, variables)  %>%
  # drop Na's
  drop_na()



# pull variables from oritional data set
variables <- sea_reign_data %>%
  select(ResponseId,BIRG1, Support1, Buymer1, IDteam1, Skill2, IDcoach1, Drama4, CORF1, Interest, Mersat25, lasttype, Promo6, Promo5)

variables %>%
  select(Promo5) %>%
  unique

variables <- variables %>%
  mutate(ResponseId = factor(ResponseId)) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Has no influence on my attendance  0", "no influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Has a positive influence on my attendance 3", "very positive influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "Had a negative influence on my attendance -3", "very negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "-2", "negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "-1", "slightly negative influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "2", "positive influence"))) %>%
  mutate(across(c("Promo5", "Promo6"), ~ str_replace(., "1", "slightly positive influence"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "6", "Satisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "5", "Somewhat Satisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "2", "Somewhat Dissatisfied"))) %>%
  mutate(across(c("Mersat25"), ~ str_replace(., "3", "Dissatisfied"))) 
#add columns to attendance data set
merchandise <- left_join(merch_correlations_df, variables, by = "ResponseId")

# change number coded variables back to origional variable values
merch_df <- merchandise %>%
  mutate(
         real_fan = IDteam1,
         likely_support_2017 = Support1,
         share_affiliation_others = BIRG1,
         intend_buy_merch   = Buymer1,
         coach_fan = IDcoach1,
         merch_staff_satisfaction = Mersat25,
         players_are_skilled = Skill2,
         wish_werent_fan = CORF1,
         ticket_type_used_2016 = lasttype,
         interest   = Interest.y,
         provides_excitement = Drama4,
         post_match_events_influence = Promo6,
         pre_match_events_influence = Promo5) %>%
  select(-c(ResponseId, BIRG1, Support1, Buymer1, IDteam1, Skill2, IDcoach1, Drama4, CORF1, Interest.y, Interest.x, Mersat25, lasttype, Promo6, Promo5,consider_ruffneck_scarves, consider_kraken_congee, intend_season_ticket, intend_single_match)) %>%
  mutate(across(where(is.character), as.factor))
```



real_fan

```{r}
df10 <- merch_df %>%
  group_by(real_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    avg_spend = median(spend_2016))%>%
  filter(count >30)

memoplot6 <- df10 %>%
  ggplot(mapping = aes(x = reorder(real_fan,avg_spend) , y = avg_spend, fill = real_fan)) +
  clean_theme +
  labs(title = "Being a 'real fan' impacts spend on merchandise", y = "Average spend on merchandise in 2016", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

memoplot6
```


coach_fan

```{r}
df11 <- merch_df %>%
  group_by(coach_fan) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    avg_spend = median(spend_2016))%>%
  filter(count >10)

coach_spend <- df11 %>%
  ggplot(mapping = aes(x = reorder(coach_fan,avg_spend) , y = avg_spend, fill = coach_fan)) +
  clean_theme +
  labs(title = "Being a fan of Coach Laura Harvey \nimpacts spend on merchandise", y = "Average spend on merchandise in 2016", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

coach_spend
```


Interest


```{r}
df12 <- merch_df %>%
  group_by(interest) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(merch_df)),
    avg_spend = median(spend_2016))%>%
  filter(count >10)

memoplot7 <- df12 %>%
  ggplot(mapping = aes(x = reorder(interest,avg_spend) , y = avg_spend, fill = interest)) +
  clean_theme +
  labs(title = "Interest impacts spend on merchandise", y = "Average spend on merchandise in 2016", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

memoplot7
```


num_matches_attend_2016



```{r}

memoplot8 <- merch_df %>%
  mutate(shirt = case_when(
    prefer_jackets == 1 ~ "Prefers Jackets",
    prefer_jackets == 0 ~ "Does not prefer Jackets")) %>%
  ggplot(mapping = aes(x = num_matches_attend_2016 , y = spend_2016, color = factor(shirt))) +
  clean_theme +
  labs(title = "Attendance Intentions for 2017 \nimpact spend on merchandise", y = "Average spend on merchandise in 2016", x = "Matches Attended in 2016") +
  geom_point() +
  coord_flip() + 
  clean_theme +
  scale_color_manual(values = c("Prefers Jackets" = "magenta",  "Does not prefer Jackets" = "green")) +
  theme(
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ),
        axis.text.y = element_text(color = "#808080" ),
        axis.title.y =  element_text(color = "#808080" )) 
memoplot8
```  



# Outcome satisfaction

```{r}

# correlations
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "season_outcome" | col_2 == "season_outcome")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "season_outcome" | col_2 == "season_outcome")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)

# create df of variables correlated with attendance variables
outcome_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one)  %>%
  # drop Na's
  drop_na() 
  
outcome_df <- outcome_correlations_df %>%
  mutate(happy_about_2016_season = case_when(
    happy_about_2016_season == -3 ~ "very unhappy",
    happy_about_2016_season == -2 ~ "unhappy",
    happy_about_2016_season == -1 ~ "somewhat unhappy",
    happy_about_2016_season == 0 ~ "neutral",
    happy_about_2016_season == 1 ~ "somewhat happy",
    happy_about_2016_season == 2 ~ "happy",
    happy_about_2016_season == 3 ~ "very happy"),
    disappointed_with_2016_season = case_when(
    disappointed_with_2016_season == -3 ~ "very happy",
    disappointed_with_2016_season == -2 ~ "happy",
    disappointed_with_2016_season == -1 ~ "somewhat happy",
    disappointed_with_2016_season == 0 ~ "neutral",
    disappointed_with_2016_season == 1 ~ "somewhat disappointed",
    disappointed_with_2016_season == 2 ~ "disappointed",
    disappointed_with_2016_season == 3 ~ "very disappointed"),
    season_performance = case_when(
    season_performance == -3 ~ "very unsatisfied",
    season_performance == -2 ~ "unsatisfied",
    season_performance == -1 ~ "somewhat unsatisfied",
    season_performance == 0 ~ "neutral",
    season_performance == 1 ~ "somewhat satisfied",
    season_performance == 2 ~ "satisfied",
    season_performance == 3 ~ "very satisfied")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId)
    
```


happy about 2016 season

```{r}
df22 <- outcome_df %>%
  group_by(happy_about_2016_season) %>%
  summarise(
    count = n(),
    avg_sat = median(season_outcome))%>%
  filter(count >10)

df22 %>%
  ggplot(mapping = aes(x = reorder(happy_about_2016_season,avg_sat) , y = avg_sat, fill = happy_about_2016_season)) +
  clean_theme +
  labs(title = "Being happy about the 2016 season \nimpacts season outcome satisfaction", y = "Average season outcome satisfaction", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
  
```

- there is no way i can use this.. the title alone was too much. duh being happy with the season impacts outcome satisfaction, need to find:
    
  - what makes people happy?

# Satisfaction

```{r}
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .2, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.2, col_1 == "overall_match_day_experience" | col_2 == "overall_match_day_experience")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)

# create df of variables correlated with attendance variables
matchday_correlations_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one)  %>%
  # drop Na's
  drop_na()



matchday_df <- matchday_correlations_df %>%
  mutate(provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    share_affiliation_others = case_when(
      share_affiliation_others == -3 ~ "strongly disagree",
      share_affiliation_others == -2 ~ "disagree",
      share_affiliation_others == -1 ~ "somewhat disagree",
      share_affiliation_others == 0 ~ "neutral",
      share_affiliation_others == 1 ~ "somewhat agree",
      share_affiliation_others == 2 ~ "agree",
      share_affiliation_others == 3 ~ "strongly agree"),
    provides_role_models = case_when(
      provides_role_models == -3 ~ "strongly disagree",
      provides_role_models == -2 ~ "disagree",
      provides_role_models == -1 ~ "somewhat disagree",
      provides_role_models == 0 ~ "neutral",
      provides_role_models == 1 ~ "somewhat agree",
      provides_role_models == 2 ~ "agree",
      provides_role_models == 3 ~ "strongly agree"),
    likely_support_2017 = case_when(
      likely_support_2017 == -3 ~ "strongly disagree",
      likely_support_2017 == -2 ~ "disagree",
      likely_support_2017 == -1 ~ "somewhat disagree",
      likely_support_2017 == 0 ~ "neutral",
      likely_support_2017 == 1 ~ "somewhat agree",
      likely_support_2017 == 2 ~ "agree",
      likely_support_2017 == 3 ~ "strongly agree"),
    support_woman_sport = case_when(
      support_woman_sport == -3 ~ "strongly disagree",
      support_woman_sport == -2 ~ "disagree",
      support_woman_sport == -1 ~ "somewhat disagree",
      support_woman_sport == 0 ~ "neutral",
      support_woman_sport == 1 ~ "somewhat agree",
      support_woman_sport == 2 ~ "agree",
      support_woman_sport == 3 ~ "strongly agree"),
    tickets_easy_get = case_when(
      tickets_easy_get == -3 ~ "strongly disagree",
      tickets_easy_get == -2 ~ "disagree",
      tickets_easy_get == -1 ~ "somewhat disagree",
      tickets_easy_get == 0 ~ "neutral",
      tickets_easy_get == 1 ~ "somewhat agree",
      tickets_easy_get == 2 ~ "agree",
      tickets_easy_get == 3 ~ "strongly agree"),
    entering_stadium = case_when(
      entering_stadium == 1 ~ "very unsatisfied",
      entering_stadium == 2 ~ "unsatisfied",
      entering_stadium == 3 ~ "somewhat unsatisfied",
      entering_stadium == 4 ~ "neutral",
      entering_stadium == 5 ~ "somewhat satisfied",
      entering_stadium == 6 ~ "satisfied",
      entering_stadium == 7 ~ "very satisfied"),
   arena_security = case_when(
      arena_security == 1 ~ "very unsatisfied",
      arena_security == 2 ~ "unsatisfied",
      arena_security == 3 ~ "somewhat unsatisfied",
      arena_security == 4 ~ "neutral",
      arena_security == 5 ~ "somewhat satisfied",
      arena_security == 6 ~ "satisfied",
      arena_security == 7 ~ "very satisfied"),
   arena_staff_friendliness = case_when(
      arena_staff_friendliness == 1 ~ "very unsatisfied",
      arena_staff_friendliness == 2 ~ "unsatisfied",
      arena_staff_friendliness == 3 ~ "somewhat unsatisfied",
      arena_staff_friendliness == 4 ~ "neutral",
      arena_staff_friendliness == 5 ~ "somewhat satisfied",
      arena_staff_friendliness == 6 ~ "satisfied",
      arena_staff_friendliness == 7 ~ "very satisfied"),
   overall_memorial_stadium_experience = case_when(
      overall_memorial_stadium_experience == 1 ~ "very unsatisfied",
      overall_memorial_stadium_experience == 2 ~ "unsatisfied",
      overall_memorial_stadium_experience == 3 ~ "somewhat unsatisfied",
      overall_memorial_stadium_experience == 4 ~ "neutral",
      overall_memorial_stadium_experience == 5 ~ "somewhat satisfied",
      overall_memorial_stadium_experience == 6 ~ "satisfied",
      overall_memorial_stadium_experience == 7 ~ "very satisfied")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId)
    
#vtable(outcome_correlations_df)
```


arena_staff_friendliness


```{r}
df33 <- matchday_df %>%
  group_by(arena_staff_friendliness)%>%
  summarise(
    count = n(),
    avg_sat = median(overall_match_day_experience)) %>%
  filter(count >15)

df33  %>%
  ggplot(mapping = aes(x = reorder(arena_staff_friendliness,avg_sat) , y = avg_sat, fill = arena_staff_friendliness)) +
  clean_theme +
  labs(title = "Arena staff friendliness \nimpacts matchday satisfaction", y = "Average matchday satisfaction", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

```


provides_role_models

```{r}
df32 <- matchday_df %>%
  group_by(provides_role_models)%>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(matchday_df)),
    avg_sat = median(overall_match_day_experience)) %>%
  filter(count >39)

df32  %>%
  ggplot(mapping = aes(x = reorder(provides_role_models,avg_sat) , y = avg_sat, fill = provides_role_models)) +
  clean_theme +
  labs(title = "Reign's role models impact matchday satisfaction", y = "Average matchday satisfaction", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))

```



# brand attitude

```{r}
# correlations
correlations <- numeric_data_set %>%
    inspect_cor() 
# find positive correlations greater than .2 with intended_num_matches_attend_2017
positive_correlations <- correlations %>%
  filter(corr > .3, col_1 == "share_affiliation_others" | col_2 == "share_affiliation_others")
# find negative correlations less than -.2 with intended_num_matches_attend_2017
negative_correlations <- correlations %>%
  filter(corr < -.3, col_1 == "share_affiliation_others" | col_2 == "share_affiliation_others")
# create table of correlations
correlations_1 <- bind_rows(positive_correlations,negative_correlations)
# create vector of correlated variables
one <- c(correlations_1$col_1, correlations_1$col_2)
# drop duplicate variables
one <- unique(one)
# create df of variables correlated with attendance variables
attitude_corr_df <- numeric_data_set %>%
  # select correlated variables from number coded df 
  select(ResponseId, one, support_woman_sport)  %>%
  # drop Na's
  drop_na() 


attitude_df <- attitude_corr_df %>%
  mutate(
    likely_support_2017 = case_when(
      likely_support_2017 == -3 ~ "strongly disagree",
      likely_support_2017 == -2 ~ "disagree",
      likely_support_2017 == -1 ~ "somewhat disagree",
      likely_support_2017 == 0 ~ "neutral",
      likely_support_2017 == 1 ~ "somewhat agree",
      likely_support_2017 == 2 ~ "agree",
      likely_support_2017 == 3 ~ "strongly agree"),
    players_are_skilled = case_when(
      players_are_skilled == -3 ~ "strongly disagree",
      players_are_skilled == -2 ~ "disagree",
      players_are_skilled == -1 ~ "somewhat disagree",
      players_are_skilled == 0 ~ "neutral",
      players_are_skilled == 1 ~ "somewhat agree",
      players_are_skilled == 2 ~ "agree",
      players_are_skilled == 3 ~ "strongly agree"),
    support_woman_sport = case_when(
      support_woman_sport == -3 ~ "strongly disagree",
      support_woman_sport == -2 ~ "disagree",
      support_woman_sport == -1 ~ "somewhat disagree",
      support_woman_sport == 0 ~ "neutral",
      support_woman_sport == 1 ~ "somewhat agree",
      support_woman_sport == 2 ~ "agree",
      support_woman_sport == 3 ~ "strongly agree"),
    provides_excitement = case_when(
      provides_excitement == -3 ~ "strongly disagree",
      provides_excitement == -2 ~ "disagree",
      provides_excitement == -1 ~ "somewhat disagree",
      provides_excitement == 0 ~ "neutral",
      provides_excitement == 1 ~ "somewhat agree",
      provides_excitement == 2 ~ "agree",
      provides_excitement == 3 ~ "strongly agree"),
    overall_match_day_experience = case_when(
      overall_match_day_experience == 1 ~ "very unsatisfied",
      overall_match_day_experience == 2 ~ "unsatisfied",
      overall_match_day_experience == 3 ~ "somewhat unsatisfied",
      overall_match_day_experience == 4 ~ "neutral",
      overall_match_day_experience == 5 ~ "somewhat satisfied",
      overall_match_day_experience == 6 ~ "satisfied",
      overall_match_day_experience == 7 ~ "very satisfied"),
    real_fan = case_when(
      real_fan == -3 ~ "strongly disagree",
      real_fan == -2 ~ "disagree",
      real_fan == -1 ~ "somewhat disagree",
      real_fan == 0 ~ "neutral",
      real_fan == 1 ~ "somewhat agree",
      real_fan == 2 ~ "agree",
      real_fan == 3 ~ "strongly agree"),
    coach_fan = case_when(
      coach_fan == -3 ~ "strongly disagree",
      coach_fan == -2 ~ "disagree",
      coach_fan == -1 ~ "somewhat disagree",
      coach_fan == 0 ~ "neutral",
      coach_fan == 1 ~ "somewhat agree",
      coach_fan == 2 ~ "agree",
      coach_fan == 3 ~ "strongly agree"),
    wish_werent_fan = case_when(
      wish_werent_fan == -3 ~ "strongly disagree",
      wish_werent_fan == -2 ~ "disagree",
      wish_werent_fan == -1 ~ "somewhat disagree",
      wish_werent_fan == 0 ~ "neutral",
      wish_werent_fan == 1 ~ "somewhat agree",
      wish_werent_fan == 2 ~ "agree",
      wish_werent_fan == 3 ~ "strongly agree"),
    Interest = case_when(
      Interest == 1 ~ "I have a small amount of interest",
      Interest == 2 ~ "I consider myself to be a low-level fan of this team",
      Interest == 3 ~ "I consider myself to be a moderate fan of this team",
      Interest == 4 ~ "I consider myself to be a loyal fan of this team",
      Interest == 5 ~ "I live and die with this team")) %>%
  mutate(across(where(is.character), as.factor)) %>%
  select(-ResponseId, -intend_buy_merch, -merch_staff_satisfaction, -merch_retail_convenience_satisfaction)
  
```
Likely Support

```{r}
df32 <- attitude_df %>%
  group_by(likely_support_2017)%>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    avg_sat = median(share_affiliation_others)) %>%
  filter(count >25)

support__att <- df32  %>%
  ggplot(mapping = aes(x = reorder(likely_support_2017,avg_sat) , y = avg_sat, fill = likely_support_2017)) +
  clean_theme +
  labs(title = "Intentions to support Reign FC impact brand attitude", y = "Average BIRG", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
support__att
```


real_fan

```{r}
df32 <- attitude_df %>%
  group_by(real_fan)%>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    avg_sat = median(share_affiliation_others)) %>%
  filter(count >10)

df32  %>%
  ggplot(mapping = aes(x = reorder(real_fan,avg_sat) , y = avg_sat, fill = real_fan)) +
  clean_theme +
  labs(title = "Real fan impact brand attitude", y = "Average BIRG", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
```


Interest

```{r}
df32 <- attitude_df %>%
  group_by(Interest)%>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    avg_sat = median(share_affiliation_others)) %>%
  filter(count >23)

df32  %>%
  ggplot(mapping = aes(x = reorder(Interest,avg_sat) , y = avg_sat, fill = Interest)) +
  clean_theme +
  labs(title = "Real fan impact brand attitude", y = "Average BIRG", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
```


support_woman_sport

```{r}
df32 <- attitude_df %>%
  group_by(support_woman_sport)%>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(attitude_df)),
    avg_sat = median(share_affiliation_others)) %>%
  filter(count >13)

df32  %>%
  ggplot(mapping = aes(x = reorder(support_woman_sport,avg_sat) , y = avg_sat, fill = support_woman_sport)) +
  clean_theme +
  labs(title = "Desire to support woman's sports impact brand attitude", y = "Average BIRG", x = "") +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  theme(axis.text.x=element_blank()) + # remove y-axis line
  coord_flip() +
  scale_fill_manual(values = c("#CCCCFF", "#336699", "#89CFF0", "#0096FF", "#5F9EA0", "#6495ED", "#0818A8"))  +
  theme(#plot.title  = element_text(color = "#808080"),
        axis.text.x = element_text(color = "#808080" ),
        axis.title.x =  element_text(color = "#808080" ))
```




```{r}
ggsave(filename = "memoplot1.png", plot = memoplot1)
ggsave(filename = "memoplot2.png", plot = memoplot2)
ggsave(filename = "memoplot3.png", plot = memoplot3)
ggsave(filename = "memoplot4.png", plot = memoplot4)
ggsave(filename = "memoplot5.png", plot = memoplot5)
ggsave(filename = "memoplot6.png", plot = memoplot6)
ggsave(filename = "memoplot7.png", plot = memoplot7)
ggsave(filename = "memoplot8.png", plot = memoplot8)
```

```{r}
numeric_data_set %>% 
  mutate(family_not_interested = case_when(
  family_not_interested %in% c(0,-1,-2,-3) ~ "disagree",
  family_not_interested %in% c(1,2,3) ~ "agree"),
  sig_other_not_interested = case_when(
  sig_other_not_interested %in% c(0,-1,-2,-3) ~ "disagree",
  sig_other_not_interested %in% c(1,2,3) ~ "agree"),
  friends_not_interested = case_when(
  friends_not_interested %in% c(0,-1,-2,-3) ~ "disagree",
  friends_not_interested %in% c(1,2,3) ~ "agree")) %>%
  group_by(family_not_interested, sig_other_not_interested, friends_not_interested) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(numeric_data_set))
    )
```


```{r}
numeric_data_set %>% 
  mutate(support_kneeling = case_when(
    support_kneeling %in% c(-1,-2,-3) ~ "do not support kneeling",
    support_kneeling %in% c(1,2,3) ~ "support kneeling")) %>%
  group_by(support_kneeling) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(numeric_data_set)),
    average_support = median(likely_support_2017),
    average_perf_satisfaction = median(season_performance),
    average_season_satisfaction = median(season_outcome),
    average_happy = median(happy_about_2016_season),
    average_dissapoint = median(disappointed_with_2016_season),
    average_birg = median(share_affiliation_others),
    average_coef = median(wish_werent_fan),
    average_player_fan = median(player_fan))
    
```


```{r}

numeric_data_set %>% 
  mutate(team_wins_more_b = case_when(
    team_wins_more %in% c(-1,-2,-3) ~ "disagree",
    team_wins_more %in% c(1,2,3) ~ "agree")) %>%
  filter(is.na(team_wins_more_b) == FALSE,
         is.na(likely_support_2017) == FALSE,
         is.na(season_performance) == FALSE,
         is.na(season_outcome) == FALSE,
         is.na(happy_about_2016_season) == FALSE,
         is.na(disappointed_with_2016_season) == FALSE,
         is.na(share_affiliation_others) == FALSE,
         is.na(wish_werent_fan) == FALSE,
         is.na(player_fan) == FALSE,
         ) %>%
  group_by(team_wins_more_b) %>%
  summarise(
    count = n(),
    average_support = median(likely_support_2017),
    average_perf_satisfaction = median(season_performance),
    average_season_satisfaction = median(season_outcome),
    average_happy = median(happy_about_2016_season),
    average_dissapoint = median(disappointed_with_2016_season),
    average_birg = median(share_affiliation_others),
    average_coef = median(wish_werent_fan),
    average_player_fan = median(player_fan))
    
```

```{r}
numeric_data_set %>% 
  mutate(wish_werent_fan = factor(wish_werent_fan)) %>%
  filter(is.na(wish_werent_fan) == FALSE,
         is.na(likely_support_2017) == FALSE,
         is.na(season_performance) == FALSE,
         is.na(season_outcome) == FALSE,
         is.na(happy_about_2016_season) == FALSE,
         is.na(disappointed_with_2016_season) == FALSE,
         is.na(share_affiliation_others) == FALSE,
         is.na(wish_werent_fan) == FALSE,
         is.na(player_fan) == FALSE,
         ) %>%
  group_by(wish_werent_fan) %>%
  summarise(
    count = n(),
    average_support = median(likely_support_2017),
    average_perf_satisfaction = median(season_performance),
    average_season_satisfaction = median(season_outcome),
    average_happy = median(happy_about_2016_season),
    average_dissapoint = median(disappointed_with_2016_season),
    average_birg = median(share_affiliation_others),
    #average_coef = median(wish_werent_fan),
    average_player_fan = median(player_fan))
```



```{r}
numeric_data_set %>% 
  mutate(disappointed_with_2016_season = factor(disappointed_with_2016_season)) %>%
  filter(is.na(disappointed_with_2016_season) == FALSE,
         is.na(likely_support_2017) == FALSE,
         is.na(season_performance) == FALSE,
         is.na(most_ideal_time) == FALSE,
         is.na(happy_about_2016_season) == FALSE,
         is.na(disappointed_with_2016_season) == FALSE,
         is.na(overall_memorial_stadium_experience) == FALSE,
         is.na(wish_werent_fan) == FALSE,
         is.na(distance_traveled) == FALSE,
         ) %>%
  group_by(disappointed_with_2016_season) %>%
  summarise(
    count = n(),
    average_support = median(likely_support_2017),
    average_perf_satisfaction = median(season_performance),
    average_season_satisfaction = median(season_outcome),
    average_happy = median(happy_about_2016_season),
    #average_dissapoint = median(disappointed_with_2016_season),
    average_birg = median(share_affiliation_others),
    average_coef = median(wish_werent_fan),
    average_player_fan = median(player_fan),
    average_wins_more = median(team_wins_more),
    average_kneeling = median(support_kneeling),
    average_excitement = median(provides_excitement),
    average_distance = median(distance_traveled),
    average_seating = median(reserved_seating),
    average_stadium_exp = median(overall_memorial_stadium_experience),
    average_time = median(most_ideal_time),
    average_skill = median(players_are_skilled),
    average_community = median(feel_part_of_community_fan),
    average_beer = median(beer_garden),
    consession = median(concession_offering))
```


```{r}
improve_gameday_experience <-numeric_data_set %>% 
  group_by(overall_memorial_stadium_experience) %>%
  filter(is.na(overall_memorial_stadium_experience)==FALSE) %>%
  summarise(
    count = n(),
    percent = percent(sum(count) / nrow(numeric_data_set)),
    avg_match_day_exp = median(overall_match_day_experience),
    avg_staff_frendliness = median(arena_staff_friendliness),
    avg_autograph_opp = median(autograph_opportunities),
    avg_arena_security = median(arena_security),
    avg_entering_stadium = median(entering_stadium),
    avg_prefer_lumen = median(prefer_lumen_staidum),
    avg_perfer_starfire = median(prefer_starfire_staidum),
    avg_consession_stand_offer = median(concession_offering),
    avg_food_price = median(concession_food_price),
    avg_food_quality = median(concession_food_price),
    avg_food_wait_times = median(concession_food_wait_time),
    avg_drink_wait_times = median(concession_drink_wait_time),
    avg_consession_location = median(concession_location),
    avg_beergarden_location = median(beergarden_locations),
    avg_food_variety = median(concession_food_variety),
    avg_consession_stand_staff = median(consession_staff),
    avg_drink_price = median(concession_drink_price),
    avg_drink_variety = median(concession_drink_variety),
    avg_beer_garden = median(beer_garden),
    avg_foodtruck_service_quality = median(food_truck_service_quality),
    avg_foodtruk_drink_food_quality = median(food_truck_service_quality),
    avg_cleanliness = median(cleanliness)) %>%
  mutate(across(where(is.numeric), as.integer))

copy <- numeric_data_set

improve_gameday_experience <- left_join(copy, improve_gameday_experience, by = "overall_memorial_stadium_experience")

improve_gameday_experience <- improve_gameday_experience %>%
  select(count, overall_memorial_stadium_experience, avg_match_day_exp, avg_prefer_lumen, avg_consession_stand_offer, 
         avg_food_price, avg_food_quality, avg_food_wait_times,avg_drink_wait_times, avg_consession_location,
         avg_beergarden_location, avg_drink_price, avg_drink_variety, avg_beer_garden, avg_cleanliness) %>%
  mutate(overall_memorial_stadium_experience_cat = case_when(
        overall_memorial_stadium_experience == 1 ~ "Very dissatisfied with my experience",
        overall_memorial_stadium_experience == 2~ "Dissatisfied with my experience",
        overall_memorial_stadium_experience == 3 ~ "Somewhat dissatisfied with my experience",
        overall_memorial_stadium_experience == 4 ~ "Neutral",
        overall_memorial_stadium_experience == 5 ~ "Somewhat satisfied with my experience",
        overall_memorial_stadium_experience == 6 ~ "Satisfied with my experience",
        overall_memorial_stadium_experience == 7 ~ "Very satisfied with my experience"),
      avg_match_day_exp = case_when(
        avg_match_day_exp == 1 ~ "Very dissatisfied",
        avg_match_day_exp == 2~ "Dissatisfied",
        avg_match_day_exp == 3 ~ "Somewhat dissatisfied",
        avg_match_day_exp == 4 ~ "Neutral",
        avg_match_day_exp == 5 ~ "Somewhat satisfied",
        avg_match_day_exp == 6 ~ "Satisfied",
        avg_match_day_exp == 7 ~ "Very satisfied"),
    avg_prefer_lumen = case_when(
    avg_prefer_lumen == 0 ~ "Neutral",
    avg_prefer_lumen == 1 ~ "Somewhat",
    avg_prefer_lumen == 2 ~ "Prefer",
    avg_prefer_lumen == 3 ~ "Strongly prefer"),
    avg_consession_stand_offer = case_when(
      avg_consession_stand_offer == 2~ "Dissatisfied with offerings",
      avg_consession_stand_offer == 3 ~ "Somewhat dissatisfied with offerings",
      avg_consession_stand_offer == 4 ~ "Neutral",
      avg_consession_stand_offer == 5 ~ "Somewhat satisfied with offerings",
      avg_consession_stand_offer == 6 ~ "Satisfied with offerings"),
    avg_food_price = case_when(
      avg_food_price == 1 ~ "Very dissatisfied with price",
      avg_food_price == 2~ "Dissatisfied with price",
      avg_food_price == 3 ~ "Somewhat dissatisfied with price",
      avg_food_price == 4 ~ "Neutral",
      avg_food_price == 5 ~ "Somewhat satisfied with price"),
    avg_food_quality = case_when(
      avg_food_quality == 1 ~ "Very dissatisfied with price",
      avg_food_quality == 2~ "Dissatisfied with price",
      avg_food_quality == 3 ~ "Somewhat dissatisfied with price",
      avg_food_quality == 4 ~ "Neutral",
      avg_food_quality == 5 ~ "Somewhat satisfied with price"),
    avg_food_wait_times = case_when(
      avg_food_wait_times == 0 ~ "Very dissatisfied with wait times",
      avg_food_wait_times == 1 ~ "Very dissatisfied with wait times",
      avg_food_wait_times == 2~ "Dissatisfied with wait times",
      avg_food_wait_times == 3 ~ "Somewhat dissatisfied with wait times",
      avg_food_wait_times == 4 ~ "Neutral",
      avg_food_wait_times == 5 ~ "Somewhat satisfied with wait times",
      avg_food_wait_times == 6 ~ "Satisfied with wait times"),
     avg_drink_wait_times = case_when(
      avg_drink_wait_times == 0 ~ "Very dissatisfied with wait times",
      avg_drink_wait_times == 1 ~ "Very dissatisfied with wait times",
      avg_drink_wait_times == 2~ "Dissatisfied with wait times",
      avg_drink_wait_times == 3 ~ "Somewhat dissatisfied with wait times",
      avg_drink_wait_times == 4 ~ "Neutral",
      avg_drink_wait_times == 5 ~ "Somewhat satisfied with wait times",
      avg_drink_wait_times == 6 ~ "Satisfied with wait times"),
    avg_consession_location = case_when(
      avg_consession_location == 1 ~ "Very dissatisfied with wait times",
      avg_consession_location == 2~ "Dissatisfied with wait times",
      avg_consession_location == 3 ~ "Somewhat dissatisfied with wait times",
      avg_consession_location == 4 ~ "Neutral",
      avg_consession_location == 5 ~ "Somewhat satisfied with wait times",
      avg_consession_location == 6 ~ "Satisfied with wait times"),
    avg_beergarden_location = case_when(
      avg_beergarden_location == 0 ~ "Very dissatisfied with locations",
      avg_beergarden_location == 1 ~ "Very dissatisfied with locations",
      avg_beergarden_location == 2~ "Dissatisfied with locations",
      avg_beergarden_location == 3 ~ "Somewhat dissatisfied with locations",
      avg_beergarden_location == 4 ~ "Neutral",
      avg_beergarden_location == 5 ~ "Somewhat satisfied with locations",
      avg_beergarden_location == 6 ~ "Satisfied with locations"),
    avg_drink_price = case_when(
      avg_drink_wait_times == 0 ~ "Very dissatisfied with drink prices",
      avg_drink_wait_times == 1 ~ "Very dissatisfied with drink prices",
      avg_drink_wait_times == 2~ "Dissatisfied with drink prices",
      avg_drink_wait_times == 3 ~ "Somewhat dissatisfied with drink prices",
      avg_drink_wait_times == 4 ~ "Neutral",
      avg_drink_wait_times == 5 ~ "Somewhat satisfied with drink prices",
      avg_drink_wait_times == 6 ~ "Satisfied with drink prices"),
    avg_drink_variety = case_when(
      avg_drink_variety == 0 ~ "Very dissatisfied with drink variety",
      avg_drink_variety == 1 ~ "Very dissatisfied with drink variety",
      avg_drink_variety == 2~ "Dissatisfied with drink variety",
      avg_drink_variety == 3 ~ "Somewhat dissatisfied with drink variety",
      avg_drink_variety == 4 ~ "Neutral",
      avg_drink_variety == 5 ~ "Somewhat satisfied with drink variety",
      avg_drink_variety == 6 ~ "Satisfied with drink variety"),
    avg_beer_garden = case_when(
      avg_beer_garden == 0 ~ "Very dissatisfied",
      avg_beer_garden == 1 ~ "Very dissatisfied",
      avg_beer_garden == 2~ "Dissatisfied",
      avg_beer_garden == 3 ~ "Somewhat dissatisfied",
      avg_beer_garden == 4 ~ "Neutral",
      avg_beer_garden == 5 ~ "Somewhat satisfied",
      avg_beer_garden == 6 ~ "Satisfied"),
    avg_cleanliness = case_when(
      avg_cleanliness == 0 ~ "Very dissatisfied",
      avg_cleanliness == 1 ~ "Very dissatisfied",
      avg_cleanliness == 2~ "Dissatisfied",
      avg_cleanliness == 3 ~ "Somewhat dissatisfied",
      avg_cleanliness == 4 ~ "Neutral",
      avg_cleanliness == 5 ~ "Somewhat satisfied",
      avg_cleanliness == 6 ~ "Satisfied")) %>%
  mutate(across(where(is.character), as.factor))

improve_gameday_experience <- improve_gameday_experience %>%
  filter(is.na(overall_memorial_stadium_experience_cat) == FALSE)
```

`r  kbl(improve_gameday_experience) %>% kable_minimal(full_width = F, position = "left") `



```{r}

improve_gameday_experience$overall_memorial_stadium_experience <- factor(improve_gameday_experience$overall_memorial_stadium_experience, 
                                                                         labels = c("Very dissatisfied with my experience", "Dissatisfied with my experience", "Somewhat dissatisfied with my experience", "Neutral", "Somewhat satisfied with my experience", "Satisfied with my experience", "Very satisfied with my experience"))
# build bar graph with counts for multiple categorical variables
pres1 <- improve_gameday_experience %>%
  ggplot(mapping = aes(x =overall_memorial_stadium_experience, y = count, fill = avg_match_day_exp)) +
  geom_bar(stat = "identity",position = "dodge") +
  labs(title = "Memorial Stadium Experience",
       subtitle = "Despite ranging Memorial stadium experiences, all respondents \nreported their overall Match Day experience was some degree \nof satisfactory",
       y = "frequency of observations", x = "") +
  coord_flip() +
  clean_theme +
  theme(plot.subtitle = element_text(color = "#808080"),
        axis.text.x = element_blank(),
     #   axis.title.x =  element_blank(),
        axis.title.y =  element_blank(),
         axis.title.x = element_text(color = "#808080"),
        axis.line.y = element_blank())
pres1
```

```{r}
# build bar graph with counts for multiple categorical variables
pres2 <- improve_gameday_experience %>%
  ggplot(mapping = aes(x =overall_memorial_stadium_experience, y = count, fill = avg_prefer_lumen)) +
  geom_bar(stat = "identity",position = "dodge") +
  labs(title = "Some respondents would prefer if Reign FC \nplayed their home matches at Lumen Stadium",
       subtitle = "But given the range of responses across experience types \nit's unlikely this stadium preference is what's driving the reportedly low \nMemorial Stadium experience",
       y = "frequency of observations", x = "") +
  coord_flip() +
  clean_theme +
  theme(plot.subtitle = element_text(color = "#808080"),
        axis.text.x = element_blank(),
       # axis.title.x =  element_blank(), 
        axis.title.y =  element_blank(),
        axis.title.x = element_text(color = "#808080"),
        axis.line.y = element_blank())
pres2
```



```{r}
# build bar graph with counts for multiple categorical variables
pres3 <- improve_gameday_experience %>%
  ggplot(mapping = aes(x =overall_memorial_stadium_experience,  fill = avg_beer_garden)) +
  geom_bar(position = "dodge") +
  labs(title = "One source for poor experiences at Memorial \nStadium could be the Beer Garden",
       subtitle = "Across all satisfaction levels, most respondents \nreported they were 'Very dissapointed' with the Beer Garden",
       y = "frequency of observations", x = "") +
  coord_flip() +
  clean_theme +
  theme(plot.subtitle = element_text(color = "#808080"),
        axis.text.x = element_blank(),
      #  axis.title.x =  element_blank(),
        axis.title.y =  element_blank(),
        axis.title.x = element_text(color = "#808080"),
        axis.line.y = element_blank())

pres3
```

```{r}
# build bar graph with counts for multiple categorical variables
pres4 <- improve_gameday_experience %>%
  ggplot(mapping = aes(x =overall_memorial_stadium_experience,  fill = avg_beergarden_location)) +
  geom_bar(position = "dodge") +
  labs(title = "Beer Garden Locations",
       subtitle = "Most respondents were also reported to be \n'Very Dissatisfied' with Beer Garden \nlocations at Memorial Stadium",
       y = "frequency of observations", x = "") +
  coord_flip() +
  clean_theme +
  theme(plot.subtitle = element_text(color = "#808080"),
        axis.text.x = element_blank(),
       # axis.title.x =  element_blank(),
        axis.title.y =  element_blank(),
       axis.title.x = element_text(color = "#808080"),
        axis.line.y = element_blank())
pres4
```


```{r}
# build bar graph with counts for multiple categorical variables
pres5 <- improve_gameday_experience %>%
  ggplot(mapping = aes(x =overall_memorial_stadium_experience,  fill = avg_cleanliness)) +
  geom_bar(position = "dodge") +
  clean_theme +
  labs(title = "Cleanliness of restrooms should \nbe improved",
       subtitle = "Based on all levels of satisfaction with Memorial Stadium \nonly one group was satisfied with restroom cleanliness",
       y = "frequency of observations", x = "") +
  coord_flip() +
  theme(plot.subtitle = element_text(color = "#808080"),
        axis.text.x = element_blank(),
      #  axis.title.x =  element_blank(),
        axis.title.y =  element_blank(),
        axis.title.x = element_text(color = "#808080"),
        axis.line.y = element_blank())
pres5
```

```{r}

ggsave(filename = "pres1.png", plot = pres1)
ggsave(filename = "pres2.png", plot = pres2)
ggsave(filename = "pres3.png", plot = pres3)
ggsave(filename = "pres4.png", plot = pres4)
ggsave(filename = "pres5.png", plot = pres5)
```















